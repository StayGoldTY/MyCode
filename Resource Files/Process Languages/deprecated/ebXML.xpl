<?xml version="1.0" encoding="UTF-8"?>
<?PowerDesigner AppLocale="UTF16" Code="ebXML" ExcludedDiagrams="{E5ED6A53-8374-4D15-94BD-A83CD4CCF2D1},{E5ED6A54-8374-4D15-94BD-A83CD4CCF2D1}" Family="Collaborative" HasExtendedMetaClass="TRUE" ID="{1A12A516-136F-410C-A37E-BF6BE6EED36A}" LastModificationDate="1337775757" Name="ebXML BPSS v1.01 (Deprecated)" Objects="446" SubFamily="ebXML" Symbols="0" Type="{7141CE88-2107-423A-A5D4-23B73A90B769}" signature="XPL_XML" version="16.5.5.4689"?>
<!-- do not edit this file -->

<BPMS xmlns:a="attribute" xmlns:c="collection" xmlns:o="object">

<o:ProcessLanguage Id="o1">
<a:ObjectID>1A12A516-136F-410C-A37E-BF6BE6EED36A</a:ObjectID>
<a:Name>ebXML BPSS v1.01 (Deprecated)</a:Name>
<a:Code>ebXML</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator>kouadou</a:Creator>
<a:ModificationDate>1337775757</a:ModificationDate>
<a:Modifier>mledier</a:Modifier>
<a:Comment>ebXML is a set of specifications that together enable a modular electronic business framework. ebXML enables a global electronic marketplace where enterprises of any size and in any geographical location can meet and conduct business with each other through the exchange of XML-based messages. ebXML is jointly sponsored by the United Nations (UN/CEFACT) and OASIS (http://ebxml.org/).

The ebXML Specification Schema provides a standard framework by which business systems may be configured to support execution of business collaborations consisting of business transactions.  It is based upon prior UN/CEFACT work, specifically the metamodel behind the UN/CEFACT Unified Modeling Methodology (UMM) defined in the N90 specification.

The Specification Schema supports the specification of Business Transactions and the choreography of Business Transactions into Business Collaborations. Each Business Transaction can be implemented using available standard patterns. These patterns determine the actual exchange of messages and business signals between the partners to achieve the required electronic commerce transaction.
</a:Comment>
<a:Family>Collaborative</a:Family>
<a:SubFamily>ebXML</a:SubFamily>
<a:CheckGlobalScript>&#39;******************************************************************************
&#39;* Purpose:  This VB-Script holds global definitions shared by all the custom-
&#39;*            checks scripts of the model extension.
&#39;******************************************************************************

Option Explicit &#39; This is to ensure all used variables are defined
Dim IDMap
Set IDMap = CreateObject(&quot;Scripting.dictionary&quot;)  &#39; This map contains Ids and Name of browsed objects

const cNameID = &quot;nameID&quot;
Dim ebXMLCode
Dim sNameIDAttr

&#39;------------------------------------------------------------------------------
&#39; Function BrowseFolder(folder)
&#39; This function recursively browse packages to check NameID uniqueness
&#39;------------------------------------------------------------------------------
Function BrowseFolder(folder)
   Dim mdl
   If len(ebXMLCode)=0 Then
      BrowseFolder = False
      set mdl = folder.model
      if mdl is Nothing Then Exit Function
      if mdl.ProcessLanguage is Nothing Then Exit Function
      ebXMLCode = mdl.ProcessLanguage.Code
   End If
   BrowseFolder = TRUE   
   sNameIDAttr = ebXMLCode &amp; &quot;.&quot; &amp; cNameID
   If folder.Children.Count &gt; 0 Then
      Dim elt
      For Each elt In folder.Children
         Dim ID
         ID = elt.GetExtendedAttribute(sNameIDAttr)
         if (ID &lt;&gt;&quot;&quot;) Then
            if (IDMap.Exists(ID)) Then
                output &quot;Duplicated nameID &quot; + ID + &quot;: &quot;  + IDMap.Item(ID) + &quot;,&quot;+ elt.Name
                If (BrowseFolder = TRUE) Then
                  BrowseFolder = FALSE
                End If
            Else
               IDMap.Add ID, elt.Name
            End If
         End If
         If (elt.IsFolder()) Then
            BrowseFolder(elt)
         End If
      Next
   End If
End Function

&#39;------------------------------------------------------------------------------
&#39; Sub SameCode(obj)
&#39; Sets code = Name.
&#39;------------------------------------------------------------------------------
Sub SameCode(obj)
   obj.Code = obj.Name
   obj.RenameObject
End Sub

&#39;------------------------------------------------------------------------------
&#39; Sub PutCodeLikeName(pack)
&#39; For all child object of the package pack sets code = Name.
&#39;------------------------------------------------------------------------------
Sub PutCodeLikeName(pack)
   Dim Obj
   For Each obj In pack.Children
      If obj.IsKindOf(cls_NamedObject) Then
         Call SameCode(obj)
      End If
   Next
End Sub

&#39;------------------------------------------------------------------------------
&#39; Sub PutFlowCodeLikeName(pack)
&#39; For all child Flows sets Code = Name
&#39;------------------------------------------------------------------------------
Sub PutFlowCodeLikeName(pack)
   Dim Flow
   For Each Flow In pack.Flows
      If Flow.IsKindOf(cls_MessageFlow) or Flow.IsKindOf(cls_RoleAssociation) Then
         Flow.Code = Flow.Name
      End If
   Next
End Sub

&#39;------------------------------------------------------------------------------
&#39; Function ExistOrganizationUnit(ByVal orgn)
&#39; This function creates an Organization Unit orgn if it does not exist.
&#39;------------------------------------------------------------------------------
Function ExistOrganizationUnit(Mdl, ByVal orgn)
   Set ExistOrganizationUnit = Nothing
   Dim OrgUnit
   For Each OrgUnit In mdl.OrganizationUnits
      If OrgUnit.IsKindOf(PdBPM.cls_OrganizationUnit) Then
         If OrgUnit.Name = orgn Then
            Set ExistOrganizationUnit = mdl.OrganizationUnits.CreateNew
            ExistOrganizationUnit.Name = orgn + CStr(mdl.OrganizationUnits.Count)
            ExistOrganizationUnit.Code = ExistOrganizationUnit.Name
            Exit Function
         End If
      End If
   Next
   If ExistOrganizationUnit Is Nothing Then
      Set ExistOrganizationUnit = mdl.OrganizationUnits.CreateNew
      ExistOrganizationUnit.Name = orgn
      ExistOrganizationUnit.Code = orgn
   End If
End Function

&#39;------------------------------------------------------------------------------
&#39; Function ExistDocument(ByVal document)
&#39; This function creates a Message Format document if it does not exist.
&#39;------------------------------------------------------------------------------
Function ExistDocument(Mdl, ByVal document)
   Set ExistDocument = Nothing
   Dim Doc
   For Each Doc In Mdl.MessageFormats
      If Doc.IsKindOf(PdBPM.cls_MessageFormat) Then
         If Doc.Name = document Then
            Set ExistDocument = Doc
            Exit Function
         End If
      End If
   Next
   If ExistDocument Is Nothing Then
      Set ExistDocument = Mdl.MessageFormats.CreateNew
      ExistDocument.Name = document
      ExistDocument.Code = document
   End If
End Function   
   
&#39;------------------------------------------------------------------------------
&#39; Function InitializeBT(obj, num)
&#39; This function initializes a Business Transaction Process
&#39;------------------------------------------------------------------------------
Function InitializeBT(obj, num)

const ctimeToAcknowledgeReceipt = &quot;timeToAcknowledgeReceipt&quot;
const ctimeToAcknowledgeAcceptance = &quot;timeToAcknowledgeAcceptance&quot; 
   
   Dim sExtAttr

   &#39; Check the object kind
   If obj is Nothing then
      InitializeBT = False
      Exit Function
   End If

   If (obj.Parent.IsKindOf(PDBPM.Cls_Model)) Or (obj.Parent.IsKindOf(PDBPM.Cls_Package)) then
      InitializeBT = True
   else
      InitializeBT = False  
      Exit Function
   End If
   
   If not obj.IsKindOf(PDBPM.Cls_Process) then
      InitializeBT = False  
      Exit Function
   End If

   &#39; Retrieve the model
   Dim Mdl
   Set Mdl = obj.Model
   If Mdl is Nothing then
      InitializeBT = False 
      Exit Function
   End If

   If Mdl.ProcessLanguage Is Nothing Then
     InitializeBT = False 
      Exit Function
   End If

   InitializeBT = True 
   ebXMLCode = Mdl.ProcessLanguage.Code
   
   &#39; Update the model options temporary
   Dim MdlOpts, OldDefMsgFrmt
   Set MdlOpts = Mdl.GetModelOptions
   OldDefMsgFrmt = MdlOpts.DefaultMessageFormat
   MdlOpts.DefaultMessageFormat = 0
   
   &#39; Retrieve the current diagram
   Dim diag,Folder,osym
   Set Folder = obj.Parent
   Set diag = Nothing
   Set osym = nothing
   Set diag = ActiveDiagram
   
   if diag.ClassKind &lt;&gt; PDBPM.CLS_BusinessProcessDiagram Then
      Set diag = Nothing
   end if
   
   if (Not diag is nothing) then
      if diag.ClassKind = PDBPM.CLS_BusinessProcessDiagram Then
         Set osym = diag.FindSymbol(obj)
      end if
   End If
   if (osym is nothing) then
      for each osym in obj.Symbols
         Set diag = osym.Diagram
         if diag.ClassKind = PDBPM.CLS_BusinessProcessDiagram then
            Exit For
         else
            Set diag = Nothing
         end if
      next
   End If
   
   If not diag is Nothing Then
      if diag.Parent &lt;&gt; Folder then
         Set diag = Nothing
      end if
   End if

   &#39; Update the display preferences of current diagram
   Dim DispPrefs
   If not diag is Nothing Then
      DispPrefs = Diag.DisplayPreferences
      Diag.DisplayPreferences = Replace(DispPrefs, &quot;Show Swimlane=Yes&quot;, &quot;Show Swimlane=No&quot;)
   End If

   &#39; Release Validation Mode
   ValidationMode = False
   
   &#39; Initialize Business Transaction name
   Dim BizTrans
   Set BizTrans = obj
   BizTrans.Name = &quot;RequestBusinessTransaction&quot;
   BizTrans.Code = &quot;RequestBusinessTransaction&quot;
   BizTrans.RenameObject

   &#39; A business transaction is a composite process
   Dim oldComposite
   oldComposite = BizTrans.Composite
   BizTrans.Composite = True
   BizTrans.UseParentNameSpace = False

   &#39; Create a default symbol in current diagram
&#39;   Dim Sym
&#39;   If not diag is Nothing and BizTrans.Symbols.Count = 0 Then
&#39;      Set Sym = Diag.AttachObject(BizTrans)
&#39;   End If

   &#39; Retrieve the sub-diagram
   Set Diag = BizTrans.DefaultDiagram

   &#39; Search for an existing requesting activity
   Dim ReqBizAct, prcs
   Set ReqBizAct = Nothing
   For Each prcs in BizTrans.Processes
      If prcs.Stereotype = &quot;RequestingBusinessActivity&quot; Then
         Set ReqBizAct = prcs
      End If
   Next
   
   &#39; Search for an existing requesting activity symbol
   Dim ReqSym  
   Set ReqSym = Nothing  
   If Not ReqBizAct is Nothing Then
      If ReqBizAct.Symbols.Count &gt; 0 Then
         Set ReqSym = ReqBizAct.Symbols.Item(0)
      End If
   End If
   
   &#39; Create a requesting activity if not found
   If ReqBizAct is Nothing Then
      Set ReqBizAct = BizTrans.Processes.CreateNew 
      ReqBizAct.Stereotype = &quot;RequestingBusinessActivity&quot;
      ReqBizAct.Name = &quot;Request&quot;
   End If
      
   &#39; Create a requesting activity symbol in sub-diagram if not found
   If ReqSym is Nothing Then
      Set ReqSym = Diag.AttachObject(ReqBizAct)
      ReqSym.Position.x = -20000
      ReqSym.Position.y = 0
      ReqSym.autoAdjustToText = False
      ReqSym.rect.Top = ReqSym.rect.Top + 8000
      ReqSym.rect.bottom = ReqSym.rect.bottom - 8000
      ReqSym.rect.Left = ReqSym.rect.Left - 4000
      ReqSym.rect.Right = ReqSym.rect.Right + 4000
   End If
   
   &#39; Search for an existing responding activity
   Dim RespBizAct
   Set RespBizAct = Nothing    
   For Each prcs in BizTrans.Processes
      If prcs.Stereotype = &quot;RespondingBusinessActivity&quot; Then
         set RespBizAct = prcs
      End If
   next
   
   &#39; Search for an existing responding activity symbol
   Dim RepSym
   Set RepSym = Nothing       
   If not RespBizAct is Nothing Then
      If RespBizAct.Symbols.Count &gt; 0 Then
         Set RepSym = RespBizAct.Symbols.Item(0)
      End If
   End If
   
   &#39; Create a responding activity if not found
   If RespBizAct is Nothing Then
      Set RespBizAct = BizTrans.Processes.CreateNew &#39;Creates a business action:RespondingBusinessActivity.
      RespBizAct.Stereotype = &quot;RespondingBusinessActivity&quot;
      RespBizAct.Name = &quot;Respond&quot;
   End If
      
   &#39; Create a responding activity symbol in sub-diagram if not found
   If RepSym is Nothing Then
      Set RepSym = Diag.AttachObject(RespBizAct)
      RepSym.Position.x = 20000
      RepSym.Position.y = 0
      RepSym.autoAdjustToText = False     
      RepSym.rect.Top = RepSym.rect.Top + 8000
      RepSym.rect.bottom = RepSym.rect.bottom - 8000
      RepSym.rect.Left = RepSym.rect.Left - 4000
      RepSym.rect.Right = RepSym.rect.Right + 4000
   End If   

   &#39; Retrieve or Create a start object
   Dim Start
   Set Start = Nothing     
   If BizTrans.ProcessStarts.Count &gt; 0 Then
      Set Start = BizTrans.ProcessStarts.Item(0)
   Else
      Set Start = BizTrans.ProcessStarts.CreateNew &#39;Creates a Start state.
      Start.Name = &quot;start&quot;
   End If

   &#39; Retrieve or Create a Start Symbol
   Dim StrtSym
   Set StrtSym = Nothing       
   If Start.Symbols.Count &gt; 0 Then
      Set StrtSym = Start.Symbols.Item(0)
   Else
      Set StrtSym = Diag.AttachObject(Start)
      StrtSym.Position.x = ReqSym.Position.x
      StrtSym.Position.y = ReqSym.Position.y + 15000
   End If

   &#39; Retrieve a Flow  between Start and Requesting Activity
   Dim StartFlow, flow
   Set StartFlow = Nothing      
   For Each flow in Start.OutputFlows
      If flow.Destination = ReqBizAct Then
         Set StartFlow = flow
      End If
   Next
   
   &#39; Create a Flow between Start and Requesting Activity if not found
   If StartFlow is Nothing Then
      Set StartFlow = BizTrans.Flows.CreateNew
      StartFlow.Name = &quot;StartFlow&quot;
      StartFlow.Source = Start
      StartFlow.Destination = ReqBizAct
   End If

   &#39; Create a Start Flow symbol if Required
   If StartFlow.Symbols.Count = 0 Then
      Set Sym = Diag.AttachLinkObject(StartFlow)
   End If
   
   &#39; Retrieve existing End objects
   Dim Success, Failure, TechFailure, endobj
   Set Success = Nothing       
   Set Failure = Nothing       
   Set TechFailure = Nothing       
   For Each endObj in BizTrans.ProcessEnds
      If endObj.Name = &quot;Success&quot; Then
         Set Success = endObj
      Else
         If endObj.Name = &quot;BusinessFailure&quot; Then
            Set Failure = endObj
         Else 
            If endObj.Name = &quot;TechnicalFailure&quot; Then
               Set TechFailure = endObj
            End If
         End If
      End If
   Next
   
   &#39; Create missing end objects
   If Success is Nothing Then
      Set Success = BizTrans.ProcessEnds.CreateNew 
      Success.Name = &quot;Success&quot;
   End If
   If Failure is Nothing Then
      Set Failure = BizTrans.ProcessEnds.CreateNew &#39;Creates a Failure End state.
      Failure.Name = &quot;BusinessFailure&quot;
      Failure.EndType = &quot;Business Error&quot;
   End If
   If TechFailure is Nothing Then
      Set TechFailure = BizTrans.ProcessEnds.CreateNew &#39;Creates a Failure End state.
      TechFailure.Name = &quot;TechnicalFailure&quot;
      TechFailure.EndType = &quot;Technical Error&quot;
   End If
   
   &#39; Create missing End symbols
   Dim SuccSym, BFailSym, TFailSym
   Set SuccSym = Nothing       
   Set BFailSym = Nothing       
   Set TFailSym = Nothing       
   If Success.Symbols.Count = 0 Then
      Set SuccSym = Diag.AttachObject(Success)
      SuccSym.Position.x = ReqSym.rect.Left
      SuccSym.Position.y = ReqSym.rect.bottom - 10000
   Else
      Set SuccSym = Success.Symbols.Item(0)
   End If
   If Failure.Symbols.Count = 0 Then
      Set BFailSym = Diag.AttachObject(Failure)
      BFailSym.Position.x = ReqSym.Position.x
      BFailSym.Position.y = ReqSym.rect.bottom - 10000
   Else
      Set BFailSym = Failure.Symbols.Item(0)
   End If
   If TechFailure.Symbols.Count = 0 Then
      Set TFailSym = Diag.AttachObject(TechFailure)
      TFailSym.Position.x = ReqSym.rect.Right
      TFailSym.Position.y = ReqSym.rect.bottom - 10000
   Else
      Set TFailSym = TechFailure.Symbols.Item(0)
   End If

   &#39; Retrieve End Flows
   Dim SuccessFlow, FailureFlow, TechFailureFlow
   Set SuccessFlow = Nothing       
   Set FailureFlow = Nothing       
   Set TechFailureFlow = Nothing       
   For Each flow in ReqBizAct.OutputFlows
      If flow.Destination = Success Then
         Set SuccessFlow = flow
      Else
         If flow.Destination = Failure Then
            Set FailureFlow = flow
         Else 
            If flow.Destination = TechFailure Then
               Set TechFailureFlow = flow
            End If
         End If
      End If
   Next

   &#39; Create missing end flows
   If SuccessFlow is Nothing Then
      Set SuccessFlow = BizTrans.Flows.CreateNew
      SuccessFlow.Name = &quot;Success&quot;
      SuccessFlow.Source = ReqBizAct
      SuccessFlow.Destination = Success
      SuccessFlow.FlowType = &quot;Success&quot;
   End If
   If FailureFlow is Nothing Then
      Set FailureFlow = BizTrans.Flows.CreateNew
      FailureFlow.Name = &quot;BusinessFailure&quot;
      FailureFlow.Source = ReqBizAct
      FailureFlow.Destination = Failure
      FailureFlow.FlowType = &quot;Business Error&quot;
   End If
   If TechFailureFlow is Nothing Then
      Set TechFailureFlow = BizTrans.Flows.CreateNew
      TechFailureFlow.Name = &quot;TechnicalFailure&quot;
      TechFailureFlow.Source = ReqBizAct
      TechFailureFlow.Destination = TechFailure
      TechFailureFlow.FlowType = &quot;Technical Error&quot;
   End If

   &#39; Create missing End Flow symbols
   Dim Sym
   If SuccessFlow.Symbols.Count = 0 Then
      Set Sym = Diag.AttachLinkObject(SuccessFlow)
   End If
   If FailureFlow.Symbols.Count = 0 Then
      Set Sym = Diag.AttachLinkObject(FailureFlow)
      Sym.SourceTextOffSet.x = -1500
      Sym.SourceTextOffSet.y = -1000
   End If
   If TechFailureFlow.Symbols.Count = 0 Then
      Set Sym = Diag.AttachLinkObject(TechFailureFlow)
      Sym.SourceTextOffSet.x = -1500
   End If

   &#39; Retrieve the flows between requesting and responding activities
   Dim ReqFlow, ReqAckRecepFlow, RespFlow, RespAckRecepFlow, RespAckAcceptFlow
   Set ReqFlow = Nothing       
   Set ReqAckRecepFlow = Nothing       
   Set RespFlow = Nothing       
   Set RespAckRecepFlow = Nothing       
   Set RespAckAcceptFlow = Nothing       
   For Each flow in ReqBizAct.OutputFlows
      If flow.Destination = RespBizAct Then
         If flow.Name = &quot;RequestEnvelope&quot; or not flow.Format is Nothing Then
            Set ReqFlow = flow
         Else
            If flow.Stereotype = &quot;ReceiptAck&quot; Then
               Set ReqAckRecepFlow = flow
            End If 
         End If
      End If 
   Next
   For Each flow in ReqBizAct.InputFlows
      If flow.Source = RespBizAct Then
         If flow.Name = &quot;ResponseEnvelope&quot; or not flow.Format is Nothing Then
            Set RespFlow = flow
         Else
            If flow.Stereotype = &quot;ReceiptAck&quot; Then
               Set RespAckRecepFlow = flow
            Else 
               If flow.Stereotype = &quot;AcceptanceAck&quot; Then
                  Set RespAckAcceptFlow = flow
               End If
            End If 
         End If
      End If 
   Next
   
   &#39; Create missing requesting flow
   If ReqFlow is Nothing Then
      Set ReqFlow = BizTrans.Flows.CreateNew
      ReqFlow.Name = &quot;RequestEnvelope&quot;
      ReqFlow.Source = ReqBizAct
      ReqFlow.Destination = RespBizAct
   End If
   
   &#39;Creates missing requesting message format
   Dim Doc
   If ReqFlow.Format is Nothing Then
      Dim ReqDoc
      Doc = &quot;RequestDocument&quot;
      Set ReqDoc = ExistDocument(Mdl, Doc)
      Set ReqFlow.Format = ReqDoc
   End If
   
   &#39;Creates missing requesting flow symbol
   Dim ListOfPoints
   Dim X1, Y1, X2, Y2  
   If ReqFlow.Symbols.Count = 0 Then
      Set Sym = Diag.AttachLinkObject(ReqFlow)
   End If
   
   If num &gt; 1 Then
   
      &#39; Create missing responding flow
      If RespFlow is Nothing Then
         Set RespFlow = BizTrans.Flows.CreateNew
         RespFlow.Name = &quot;ResponseEnvelope&quot;
         RespFlow.Source = RespBizAct
         RespFlow.Destination = ReqBizAct
      End If
   
      &#39;Create missing responding message format
      If RespFlow.Format is Nothing Then
         Dim RepDoc
         Doc = &quot;ResponseDocument&quot;
         Set RepDoc = ExistDocument(Mdl, Doc)
         Set RespFlow.Format = RepDoc
      End If
   
      &#39; Create missing responding flow symbol
      If RespFlow.Symbols.Count = 0 Then
         Set sym = Diag.AttachLinkObject(RespFlow)
         X1 = reqsym.rect.Right
         Y1 = (reqsym.rect.bottom + reqsym.position.y) / 2
         X2 = RepSym.rect.Left
         Y2 = Y1
         Set ListOfPoints = NewPtList
         ListOfPoints.AddPoint X2, Y2
         ListOfPoints.AddPoint X1, Y1
         sym.ListOfPoints = ListOfPoints
      End If
   Else
      If not RespFlow is Nothing Then
         RespFlow.Delete
      End If
   End If   
   
   If num &gt; 2 Then
   
      &#39; Initialize extended attributes
      sExtAttr = ebXMLCode &amp; &quot;.&quot; &amp; ctimeToAcknowledgeReceipt
      If  ReqBizAct.GetExtendedAttribute(sExtAttr) = &quot;&quot; Then
         ReqBizAct.SetExtendedAttribute sExtAttr, &quot;P2D&quot;
      End If
   
      &#39; Create missing responding receipt aknowledgment flow
      If RespAckRecepFlow is Nothing Then
         Set RespAckRecepFlow = BizTrans.Flows.CreateNew
         RespAckRecepFlow.Name = &quot;ResponseReceiptAcknowledgment&quot;
         RespAckRecepFlow.Source = RespBizAct
         RespAckRecepFlow.Destination = ReqBizAct
         RespAckRecepFlow.Stereotype = &quot;ReceiptAck&quot;
      End If
     
      &#39; Create missing responding receipt aknowledgment flow symbol
      If RespAckRecepFlow.Symbols.Count = 0 Then
         Set sym = diag.AttachLinkObject(RespAckRecepFlow)
         X1 = reqsym.rect.Right
         Y1 = (reqsym.rect.Top + reqsym.position.y) / 2
         X2 = RepSym.rect.Left
         Y2 = Y1
         Set ListOfPoints = NewPtList
         ListOfPoints.AddPoint X2, Y2
         ListOfPoints.AddPoint X1, Y1
         sym.ListOfPoints = ListOfPoints
      End If
   Else
      If not RespAckRecepFlow is Nothing Then
         RespAckRecepFlow.Delete
      End If
   End If      
   
   If num &gt; 3 Then
   
      &#39; Initialize extended attributes
      sExtAttr = ebXMLCode &amp; &quot;.&quot; &amp; ctimeToAcknowledgeAcceptance     
      If  ReqBizAct.GetExtendedAttribute(ctimeToAcknowledgeAcceptance) = &quot;&quot; Then
         ReqBizAct.SetExtendedAttribute ctimeToAcknowledgeAcceptance, &quot;P2D&quot;
      End If
   
      &#39; Create missing responding receipt aknowledgment acceptance flow
      If RespAckAcceptFlow is Nothing Then
         Set RespAckAcceptFlow = BizTrans.Flows.CreateNew   &#39;Creates a flow between RespondingActivity and RequestingActivity:AcceptanceAcknowledgment.
         RespAckAcceptFlow.Name = &quot;ResponseAcceptanceAcknowledgment&quot;
         RespAckAcceptFlow.Source = RespBizAct
         RespAckAcceptFlow.Destination = ReqBizAct
         RespAckAcceptFlow.Stereotype = &quot;AcceptanceAck&quot;
      End If
     
      &#39; Create missing responding receipt aknowledgment acceptance flow symbol
      If RespAckAcceptFlow.Symbols.Count = 0 Then
         Set sym = diag.AttachLinkObject(RespAckAcceptFlow)
         X1 = reqsym.rect.Right
         Y1 = ((reqsym.rect.Top + reqsym.position.y) / 2 + reqsym.position.y) / 2
         X2 = RepSym.rect.Left
         Y2 = Y1
         Set ListOfPoints = NewPtList
         ListOfPoints.AddPoint X2, Y2
         ListOfPoints.AddPoint X1, Y1
         sym.ListOfPoints = ListOfPoints
      End If
   Else
      If not RespAckAcceptFlow is Nothing Then
         RespAckAcceptFlow.Delete
      End If
   End If      

   If num &gt; 4 Then
   
      &#39; Initialize extended attributes
      sExtAttr = ebXMLCode &amp; &quot;.&quot; &amp; ctimeToAcknowledgeReceipt      
      If  RespBizAct.GetExtendedAttribute(sExtAttr) = &quot;&quot; Then
         RespBizAct.SetExtendedAttribute sExtAttr, &quot;P2D&quot;
      End If
   
      &#39; Create missing requesting receipt aknowledgment flow
      If ReqAckRecepFlow is Nothing Then
         Set ReqAckRecepFlow = BizTrans.Flows.CreateNew   &#39;Creates a flow between RequestingActivity and RespondingActivity ReceiptAcknowledgment.
         ReqAckRecepFlow.Name = &quot;RequestReceiptAcknowledgment&quot;
         ReqAckRecepFlow.Source = ReqBizAct
         ReqAckRecepFlow.Destination = RespBizAct
         ReqAckRecepFlow.Stereotype = &quot;ReceiptAck&quot;
      End If
     
      &#39; Create missing requesting receipt aknowledgment flow symbol
      If ReqAckRecepFlow.Symbols.Count = 0 Then
         Set sym = diag.AttachLinkObject(ReqAckRecepFlow)
         X1 = reqsym.rect.Right
         Y1 = ((reqsym.rect.bottom + reqsym.position.y) / 2 + reqsym.rect.bottom) / 2
         X2 = RepSym.rect.Left
         Y2 = Y1
         Set ListOfPoints = NewPtList
         ListOfPoints.AddPoint X1, Y1
         ListOfPoints.AddPoint X2, Y2
         sym.ListOfPoints = ListOfPoints
      End If
   Else
      If not ReqAckRecepFlow is Nothing Then
         ReqAckRecepFlow.Delete
      End If
   End If      

   &#39; Initialize code of all objects under the Business Transaction
   Call PutCodeLikeName(BizTrans)
   Call PutFlowCodeLikeName(BizTrans)

   &#39; Open view if new created
   &#39;If not oldComposite Then
   &#39;      BizTrans.DefaultDiagram.OpenView
   &#39;End If
   
   Dim symBT
   Set symBT = BizTrans.Symbols.Item(0)
   If (not symBT is Nothing) Then
      symBT.autoAdjustToText = False
      symBT.rect.Top = symBT.rect.Top + 8000
      symBT.rect.bottom = symBT.rect.bottom - 8000
      symBT.rect.Left = symBT.rect.Left - 8000
      symBT.rect.Right = symBT.rect.Right + 8000
      symBT.CompositeView = TRUE
   End If 
      
   &#39; Restore old model options
   MdlOpts.DefaultMessageFormat = OldDefMsgFrmt

   &#39; Restore Validation Mode   
   ValidationMode = True
   
End Function</a:CheckGlobalScript>
<c:Categories>
<o:TargetCategory Id="o2">
<a:ObjectID>86681078-521E-491D-B1FF-CCEEE712CE25</a:ObjectID>
<a:Name>Generation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<c:Categories>
<o:TypedCategoryTargetItem Id="o3">
<a:TypePublicName>GenerationOptionTargetItem</a:TypePublicName>
<a:ObjectID>21A2AFE1-C85A-4BEC-91E6-D195C9590F75</a:ObjectID>
<a:Name>Options</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:GenerationOptionTargetItem Id="o4">
<a:ObjectID>447E6B48-8648-4027-A3CD-AB8354C37B05</a:ObjectID>
<a:Name>generateDescription</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Generate description: allows the generation of Process Description attribute as an ebXML documentation tag.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:GenerationOptionTargetItem>
<o:GenerationOptionTargetItem Id="o5">
<a:ObjectID>9E4FC842-72A9-4556-B7FC-4559D3943909</a:ObjectID>
<a:Name>defaultFileName</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Default file name: defines the default name of the file to generate.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:StringValue>%Code%</a:StringValue>
<a:OptionType>S</a:OptionType>
</o:GenerationOptionTargetItem>
<o:GenerationOptionTargetItem Id="o6">
<a:ObjectID>018D4E97-491C-41B7-BEB9-C0251C2C9D43</a:ObjectID>
<a:Name>useXPaths</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Use XPaths: allows the generation of XPaths when a BPSS document references BT(s) or BC(s).</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:BoolValue>1</a:BoolValue>
</o:GenerationOptionTargetItem>
<o:GenerationOptionTargetItem Id="o7">
<a:ObjectID>1EDAF374-BEBB-4750-A6A8-FD62D94B67E8</a:ObjectID>
<a:Name>useRelativePaths</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Use relative paths: allows the generation of file name without the full path.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:GenerationOptionTargetItem>
<o:GenerationOptionTargetItem Id="o8">
<a:ObjectID>4470D179-F5C8-4E92-9886-F3A0C39353D5</a:ObjectID>
<a:Name>generateDTDLine</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Generate DTDLine: enables the generation of the DTD tag in BPSS document.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:BoolValue>1</a:BoolValue>
</o:GenerationOptionTargetItem>
<o:GenerationOptionTargetItem Id="o9">
<a:ObjectID>1296DA4C-59A7-42FA-9DBE-99C973AA6B8F</a:ObjectID>
<a:Name>generateNameIDs</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>generateNameIDs: enables the generation of the nameID for each element of the BPSS document.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:GenerationOptionTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TargetCategory>
<o:ProfileTargetItem Id="o10">
<a:ObjectID>78E4858C-3156-426F-AC93-BEB872189BEA</a:ObjectID>
<a:Name>Profile</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>1284958098</a:ModificationDate>
<a:Modifier>qxzhang</a:Modifier>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TargetCategory Id="o11">
<a:ObjectID>842A5BB7-C14F-4585-9015-FA1405315E87</a:ObjectID>
<a:Name>Shared</a:Name>
<a:Code>Shared</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o12">
<a:TypePublicName>ExtendedAttributeTypeTargetItem</a:TypePublicName>
<a:ObjectID>4178A944-1DA2-449E-84E0-6A93496C1CBE</a:ObjectID>
<a:Name>Extended Attribute Types</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTypeTargetItem Id="o13">
<a:ObjectID>CBBCB954-07B0-4659-AB09-DE6C5E3C75B9</a:ObjectID>
<a:Name>SecureTransport</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Type for the isSecureTransportRequired extended attribute.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTypeTargetItem.Value>no</a:ExtendedAttributeTypeTargetItem.Value>
<a:ExtendedAttributeTypeTargetItem.ListOfValues>no
persist
transcient</a:ExtendedAttributeTypeTargetItem.ListOfValues>
</o:ExtendedAttributeTypeTargetItem>
<o:ExtendedAttributeTypeTargetItem Id="o14">
<a:ObjectID>139D98AE-EDC4-4563-A7B7-F8EA77D197E2</a:ObjectID>
<a:Name>UUID</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Universal Unique IDentifier.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:ExtendedAttributeTypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TargetCategory>
<o:MetaClassTargetItem Id="o15">
<a:ObjectID>93C8B352-0745-400B-B4BB-98963F69A910</a:ObjectID>
<a:Name>Model</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:EnableSelectionGeneration>1</a:EnableSelectionGeneration>
<c:Categories>
<o:TypedCategoryTargetItem Id="o16">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>1D70F5EC-EB45-4DF4-9B79-948E15694EF3</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o17">
<a:ObjectID>02D119A6-8602-43F6-BD75-1C1087975BE9</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)
   If obj is Nothing then
      %Initialize% = False  
      Exit Function
   End If

   If not obj.IsKindOf(PDBPM.Cls_Model) then
      %Initialize% = False  
      Exit Function
   End If

   %Initialize% = True 
   
   &#39; Initialize the version string
   if obj.Version = &quot;&quot; then
      obj.Version = &quot;0.1&quot;
   end if
   
   &#39; Change the display preferences
   Dim Diag
   Set Diag = obj.DefaultDiagram
   if not Diag is Nothing then
      Dim DispPrefs
      DispPrefs = Diag.DisplayPreferences
      Diag.DisplayPreferences = Replace(DispPrefs, &quot;Show Swimlane=Yes&quot;, &quot;Show Swimlane=No&quot;)   
   end if
   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o18">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>26EE4375-19AC-4170-92F3-244943D556EA</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o19">
<a:ObjectID>2059F824-47C3-4D64-928A-21F4AE226493</a:ObjectID>
<a:Name>uriDocumentation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Defines user documentation for any element. Must be the first element of its container.  Documentation can be either inline PCDATA and/or a URI to where more complete documentation is to be found.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o20">
<a:ObjectID>0207C6E8-78BE-408D-B1D2-D48D63FADE3E</a:ObjectID>
<a:Name>uuidProcess</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The Universal Unique Identifier of the process.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>-1</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
<c:ExtendedAttributeType>
<o:ExtendedAttributeTypeTargetItem Ref="o14"/>
</c:ExtendedAttributeType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o21">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>6EEC4F40-8E53-4B77-BDD5-5E4BAE1BA11D</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o22">
<a:ObjectID>20840130-3C30-41FE-95B4-BF19CA2A2031</a:ObjectID>
<a:Name>ExaHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o23">
<a:ObjectID>219D7D5F-D058-4EEC-9689-511A0722851A</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>.//This template gets uuidProcess extended attributes of the Model.
.//This uuid must be defined before launching the generation (it is required)
.ifnot (%uuidProcess%==&quot;&quot;)
uuid=&quot;%uuidProcess%&quot;
.else
uuid=&quot;%ObjectID%&quot;
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o24">
<a:ObjectID>22828DEC-4C3B-4F2A-9B5A-8225A2C2281F</a:ObjectID>
<a:Name>Helpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o25">
<a:ObjectID>AE5143A4-FDD2-4C76-A5C0-C38127908AB3</a:ObjectID>
<a:Name>xmlVersion</a:Name>
<a:TemplateTargetItem.Value>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!-- ebXML Business Process Specification Schema --&gt;
&lt;!-- Author: %Modifier% --&gt;
&lt;!-- Modified: %ModificationDate% --&gt;
.if (%GenOptions.generateDTDLine%)
[\n&lt;!DOCTYPE ProcessSpecification SYSTEM &quot;http://www.ebxml.org/specs/ebBPSS.dtd&quot;&gt;]
.endif
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o26">
<a:ObjectID>D933FCD2-C88F-4F37-A694-349F5CA07BE7</a:ObjectID>
<a:Name>modelHeader</a:Name>
<a:TemplateTargetItem.Value>&lt;ProcessSpecification name=&quot;%.X:Code%&quot;
[   version=&quot;%.X:Version%&quot;\n]\
[   %extendedAttributes%]&gt;
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o27">
<a:ObjectID>76563782-D34D-4B21-9112-DB5D47FF1935</a:ObjectID>
<a:Name>modelFooter</a:Name>
<a:TemplateTargetItem.Value>&lt;/ProcessSpecification&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o28">
<a:ObjectID>4BB7D982-A917-471D-9B90-2011B8858A2D</a:ObjectID>
<a:Name>pathName</a:Name>
<a:TemplateTargetItem.Value>.if (%Parent%)
%Parent.pathName%/%Code%
.else
%Code%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o29">
<a:ObjectID>9DA6A80B-B10A-4FE2-96BD-477E05A2333F</a:ObjectID>
<a:Name>documentationLists</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o30">
<a:ObjectID>18196866-8F62-4710-B834-08F6BD6A9B80</a:ObjectID>
<a:Name>bpssFileName</a:Name>
<a:TemplateTargetItem.Value>%GenOptions.defaultFileName%.xml</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o31">
<a:ObjectID>4F57CDA9-AD77-4525-853F-8D78B7CA3700</a:ObjectID>
<a:Name>generateId</a:Name>
<a:TemplateTargetItem.Value>.vbscript ()
&#39;******************************************************************************
&#39;* File:     ebXMLgeneratIDS.vbs
&#39;* Purpose:  This VB Script generate name ID for each object and store it as nameID
&#39;*           extended attribute.
&#39;* Title:    
&#39;* Category: ebXML
&#39;* Version:  1.0
&#39;* Copyright (C) 2001 Sybase Inc. and its subsidiaries.
&#39;******************************************************************************

Option Explicit

&#39;-----------------------------------------------------------------------------
&#39; Global variables
&#39;-----------------------------------------------------------------------------

Dim mdl &#39; the current model.
Dim mssgCounter,prcsCounter,orgnCounter, forkCounter, joinCounter
Dim bcCounter, btCounter, btaCounter,caCounter, mpcCounter, rqbaCounter, rpbacounter
Dim ebXMLCode, sNameIDExtAttr

Const ebXMLFamily = &quot;ebXML BPSS&quot;  &#39; ebXML Extended Model Definition family
Const NameID = &quot;nameID&quot;           &#39; nameID extended attribute

&#39;-----------------------------------------------------------------------------
&#39; Initializations
&#39;-----------------------------------------------------------------------------
mssgCounter=0
PrcsCounter=0
bcCounter=0
btCounter=0
btaCounter=0
mpcCounter=0
rqbaCounter=0
rpbacounter=0
caCounter = 0
orgnCounter = 0
forkCounter = 0
joinCounter = 0

&#39; Getting the Current Model and checking ebXML Rules
Set mdl = ActiveModel
If (mdl Is Nothing) Then
   MsgBox &quot;There is no current Business Process Model.&quot;
ElseIf Not mdl.IsKindOf(PdBPM.cls_Model) Then
   MsgBox &quot;The current model is not a Business Process Model.&quot;
Else
   If Not mdl.ProcessLanguage is Nothing Then
      ebXMLCode = mdl.ProcessLanguage.Code
      If Len(ebXMLCode)&gt; 0 Then
         sNameIDExtAttr = ebXMLCode &amp; &quot;.&quot; &amp; NameID
         Call GenerateMessageFormats(mdl)
         Call GenerateRoles(mdl)   
         Call GenerateProcesses(mdl)
         Call GenerateForks(mdl)   
         Call GenerateJoins(mdl)   
         Call GeneratePackages(mdl)
      End If
  End IF
End If


&#39;-----------------------------------------------------------------------------
&#39; Sub GenerateJoins(Folder)
&#39;-----------------------------------------------------------------------------
Sub GenerateJoins(Folder)
   If Folder.BpmSynchronizations.Count &gt; 0 Then
      Dim obj
      For Each obj In Folder.BpmSynchronizations
         joinCounter = joinCounter+1      
         obj.SetExtendedAttribute sNameIDExtAttr, obj.Code + &quot;_BD_&quot;+CStr(joinCounter) 
      Next
   End If
End Sub
&#39;-----------------------------------------------------------------------------
&#39; Sub GenerateForks(Folder)
&#39;-----------------------------------------------------------------------------
Sub GenerateForks(Folder)
   If Folder.BpmSynchronizations.Count &gt; 0 Then
      Dim obj
      For Each obj In Folder.BpmSynchronizations
         If obj.Stereotype = &quot;Fork&quot; Then
            forkCounter = forkCounter+1      
            obj.SetExtendedAttribute sNameIDExtAttr, obj.Code + &quot;_BD_&quot;+CStr(forkCounter) 
         End If
      Next
   End If
End Sub


&#39;-----------------------------------------------------------------------------
&#39; Sub GenerateMessageFormats(Folder)
&#39;-----------------------------------------------------------------------------
Sub GenerateMessageFormats(Folder)
   If Folder.MessageFormats.Count &gt; 0 Then
      Dim obj, counter
      For Each obj In Folder.MessageFormats
         mssgCounter = mssgCounter+1      
         obj.SetExtendedAttribute sNameIDExtAttr, obj.Code + &quot;_BD_&quot;+CStr(mssgCounter) 
      Next
   End If
End Sub

&#39;-----------------------------------------------------------------------------
&#39; Sub GenerateRoles(Folder)
&#39;-----------------------------------------------------------------------------
Sub GenerateRoles(Folder)
   If Folder.OrganizationUnits.Count &gt; 0 Then
      Dim obj, counter
      For Each obj In Folder.OrganizationUnits
      orgnCounter = orgnCounter+1      
      obj.SetExtendedAttribute sNameIDExtAttr, obj.Code + &quot;_OU_&quot;+CStr(orgnCounter) 
      Next
   End If
End Sub

&#39;-----------------------------------------------------------------------------
&#39; Sub GeneratePackages(Folder)
&#39;-----------------------------------------------------------------------------
Sub GeneratePackages(Folder)
   If Folder.Packages.Count &gt; 0 Then
      Dim obj
      For Each obj In Folder.Packages
         Call GenerateProcesses(obj)
         Call GenerateForks(obj)   
         Call GenerateJoins(obj)   
      Next
   End If
End Sub

&#39;-----------------------------------------------------------------------------
&#39; Sub GenerateProcesses(Folder)
&#39;-----------------------------------------------------------------------------
Sub GenerateProcesses(Folder)
   If Folder.processes.Count &gt; 0 Then
      Dim obj,counter,Id
      For Each obj In Folder.processes
      If (Not obj.IsShortcut()) Then       
         Select Case obj.Stereotype
         Case &quot;MultiPartyCollaboration&quot;
            mpcCounter=mpcCounter+1
            counter=mpcCounter
            Id = &quot;_MPC_&quot;+CStr(Counter)
         Case &quot;BinaryCollaboration&quot;
            bcCounter=bcCounter+1
            counter=bcCounter
            Id = &quot;_BC_&quot;+CStr(Counter)            
         Case &quot;BusinessTransaction&quot;
            btCounter=btCounter+1
            counter=btCounter
            Id = &quot;_BT_&quot;+CStr(Counter)            
         Case &quot;CollaborationActivity&quot;
            caCounter=caCounter+1
            counter=caCounter
            Id = &quot;_CA_&quot;+CStr(Counter)            
         case &quot;BusinessTransactionActivity&quot;
            btaCounter=btaCounter+1
            counter=btaCounter
            Id = &quot;_BTA_&quot;+CStr(Counter)            
         Case &quot;RequestingBusinessActivity&quot;
            rqbaCounter=rqbaCounter+1
            counter=rqbaCounter
            Id = &quot;_RQBA_&quot;+CStr(Counter)            
         Case &quot;RespondingBusinessActivity&quot;
            rpbaCounter=rpbaCounter+1
            counter=rpbaCounter
            Id = &quot;_RPBA_&quot;+CStr(Counter)            
          Case Else
            prcsCounter=prcsCounter+1
            counter=prcsCounter
            Id = &quot;_PRCS_&quot;+CStr(Counter)            
         End Select
         obj.SetExtendedAttribute sNameIDExtAttr, obj.Code + Id
         If (obj.Composite) Then
            CALL GenerateProcesses(obj)
            Call GenerateForks(obj)   
            Call GenerateJoins(obj)   
         End If
      End If
      Next
   End If
End Sub
.endvbscript</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TemplateTargetItem Id="o32">
<a:ObjectID>C93A5CD3-ED44-4D11-A944-1A14D62EDAEA</a:ObjectID>
<a:Name>ebXML</a:Name>
<a:TemplateTargetItem.Value>.//Generates ebXML process specification file. It uses others templates to generate Header, Body and Footer of the document
[%xmlVersion%\n]
%modelHeader%
[   %documentation%\n]\
[   %browseMessageFormats%\n]\
[   %browsePackages%\n]\
[   %browseProcesses%\n]\
%modelFooter%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o33">
<a:ObjectID>BF0330AF-2CE6-4ED1-9757-4B896687D2F7</a:ObjectID>
<a:Name>BPSS</a:Name>
<a:TemplateTargetItem.Value>.//This template generates ebXML XML file. It is the entry point of the generation.
.if (%GenOptions.generateNameIDs%)
%generateId%
.endif
.if (%PreviewMode% == &quot;false&quot;)
[%ebXML%\n]
.else
%ebXML%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o34">
<a:TypePublicName>GeneratedFileTargetItem</a:TypePublicName>
<a:ObjectID>F936B371-D417-4A0A-9BB7-221B7B2DAD2A</a:ObjectID>
<a:Name>Generated Files</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:GeneratedFileTargetItem Id="o35">
<a:ObjectID>17C8C005-D69E-420F-8354-E60CA0E9A65D</a:ObjectID>
<a:Name>BPSS</a:Name>
<a:TemplateTargetItem.Value>%BPSS%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:Filename>%bpssFileName%</a:Filename>
</o:GeneratedFileTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o36">
<a:ObjectID>F01D1F49-2EA8-4802-B415-C78E9B60F835</a:ObjectID>
<a:Name>Package</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o37">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>6B8C8ACD-EC40-43F0-B984-8DD44DCD888D</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o38">
<a:ObjectID>6762E296-8496-4055-911B-144950272016</a:ObjectID>
<a:Name>uriDocumentation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Defines user documentation for any element. Must be the first element of its container.  Documentation can be either inline PCDATA and/or a URI to where more complete documentation is to be found.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o39">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>5B8946B9-805B-4065-8DB1-884E0159984D</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o40">
<a:ObjectID>C8B6C5AC-BFA4-41D7-9593-F0B99963866F</a:ObjectID>
<a:Name>Helpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o41">
<a:ObjectID>C9B7F959-24D1-414C-AAFC-99B22CE675E9</a:ObjectID>
<a:Name>packageHeader</a:Name>
<a:TemplateTargetItem.Value>&lt;Package name=&quot;%.X:Code%&quot;[ nameID=&quot;%nameID%&quot;]&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o42">
<a:ObjectID>E3C03C93-9BDC-414E-BB90-76AAC4A9C613</a:ObjectID>
<a:Name>packageFooter</a:Name>
<a:TemplateTargetItem.Value>&lt;/Package&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o43">
<a:ObjectID>8B3524E1-3210-48E1-864C-426A9D46F461</a:ObjectID>
<a:Name>package</a:Name>
<a:TemplateTargetItem.Value>%packageHeader%
[   %documentation%\n]\
[   %subPackages%\n]\
[   %browseProcesses%\n]\
%packageFooter%

</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o44">
<a:ObjectID>9BE85D11-78E0-487E-920D-4ED07E04DA15</a:ObjectID>
<a:Name>subPackages</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Packages)
%package%
.next(\n)
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o45">
<a:TypePublicName>GeneratedFileTargetItem</a:TypePublicName>
<a:ObjectID>CD10C141-F2A2-4230-85D0-97F2D523D63F</a:ObjectID>
<a:Name>Generated Files</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:GeneratedFileTargetItem Id="o46">
<a:ObjectID>59ED431D-8F80-4FB1-B04E-69148B5C175C</a:ObjectID>
<a:Name>package</a:Name>
<a:TemplateTargetItem.Value>%package%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:GeneratedFileTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o47">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>0B92CC9B-910F-473E-A4DE-9172784DE536</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o48">
<a:ObjectID>7CE8F9EB-2E07-4DD9-8089-83D6A4D86DE5</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)
   If obj is Nothing then
      %Initialize% = False  
      Exit Function
   End If

   If not obj.IsKindOf(PDBPM.Cls_Package) then
      %Initialize% = False  
      Exit Function
   End If

   %Initialize% = True 
   
   &#39; Change the display preferences
   Dim Diag
   Set Diag = obj.DefaultDiagram
   if not Diag is Nothing then
      Dim DispPrefs
      DispPrefs = Diag.DisplayPreferences
      Diag.DisplayPreferences = Replace(DispPrefs, &quot;Show Swimlane=Yes&quot;, &quot;Show Swimlane=No&quot;)   
   end if
   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o49">
<a:ObjectID>FB8D5F51-6012-4AB5-84AC-95AFFCF2423F</a:ObjectID>
<a:Name>OrganizationUnit</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o50">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>D1EAD779-DAE5-4515-8256-F01BA85BBB2F</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o51">
<a:ObjectID>1AB17897-DF99-4680-9292-805EB5F0CAB7</a:ObjectID>
<a:Name>uriDocumentation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Defines user documentation for any element. Must be the first element of its container.  Documentation can be either inline PCDATA and/or a URI to where more complete documentation is to be found.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o52">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>4826D638-CC96-4549-B0C8-9F8A8B1517DC</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o53">
<a:ObjectID>29DAD9A9-1931-45C8-8BD6-ADCB421E9636</a:ObjectID>
<a:Name>documentationList</a:Name>
<a:TemplateTargetItem.Value>.//The template generates documentation files. 
.// Each dependent file of the organization unit is generated as an ebXML Documentation element if the extended dependency has &lt;&lt;Documentation&gt;&gt; stereotype.
.foreach_item(ExtendedDependencies,,)
   .if (%dependency%)
[\t%InfluentObject.documentationFile%\n]
   .endif
.next()
.foreach_item(ExtendedInfluences)
   .if (%invDependency%)
[%DependentObject.documentationFile%\n]
   .endif
.next()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o54">
<a:TypePublicName>StereotypeTargetItem</a:TypePublicName>
<a:ObjectID>CE2D8A65-C7D8-4E45-90FE-847CEB9DC483</a:ObjectID>
<a:Name>Stereotypes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:StereotypeTargetItem Id="o55">
<a:ObjectID>4F22DD00-A00F-4217-A513-6BEB97943CB4</a:ObjectID>
<a:Name>AuthorizedRole</a:Name>
<a:Code>AuthorizedRole</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>an Authorized role on Binary Collaboration.</a:Comment>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o56">
<a:ObjectID>1FEEDDC2-A989-4E48-BDC4-9B74F35F0ADD</a:ObjectID>
<a:Name>BusinessPartnerRole</a:Name>
<a:Code>BusinessPartnerRole</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>a role that participates in MultiPartyCollaboration.</a:Comment>
</o:StereotypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o57">
<a:ObjectID>36725A76-CFF3-402D-8C36-5B211977900B</a:ObjectID>
<a:Name>Synchronization</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o58">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>369F542B-D928-4D8E-BE52-B9AD4A63BE11</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o59">
<a:ObjectID>176D4697-9D1B-11D5-A3EC-0002A523AAEC</a:ObjectID>
<a:Name>waitForAll</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>indicates that synchronization wait for all synchronized activities before launching the next activity.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>true</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o60">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>CE5A63F6-E5D6-4EC1-BEC8-DA54630BA52E</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o61">
<a:ObjectID>6DD11EAC-DA57-4E75-BFEB-B90231067461</a:ObjectID>
<a:Name>join</a:Name>
<a:TemplateTargetItem.Value>.//produces a join element
&lt;Join name=&quot;%.X:Code%&quot;[ nameID=&quot;%nameID%&quot;][   %extendedAttributes%]&gt;[  \n%documentation%\n]
&lt;/Join&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o62">
<a:ObjectID>58819C7E-A134-4CCA-AE01-F15790F8BF4E</a:ObjectID>
<a:Name>documentationList</a:Name>
<a:TemplateTargetItem.Value>.//Generates documentation files. Each dependent file of the synchronization is generated as an ebXML Documentation element if the extended dependency has &lt;&lt;Documentation&gt;&gt; stereotype.
.foreach_item(ExtendedDependencies,,)
.if (%dependency%)
[%InfluentObject.documentationFile%\n]
.endif
.next()
.foreach_item(ExtendedInfluences)
.if (%invDependency%)
[%DependentObject.documentationFile%\n]
.endif
.next()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o63">
<a:ObjectID>E93FFD6C-D1BF-432A-A92F-73FA6D7710C4</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>.if (%.U:waitForAll%==FALSE)
waitForAll=&quot;%waitForAll%&quot;
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o64">
<a:TypePublicName>GeneratedFileTargetItem</a:TypePublicName>
<a:ObjectID>215BE94A-82C2-418E-9F74-C9BD77A6BA53</a:ObjectID>
<a:Name>Generated Files</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:GeneratedFileTargetItem Id="o65">
<a:ObjectID>16525B13-A082-40DB-AA01-28B41AE01492</a:ObjectID>
<a:Name>join</a:Name>
<a:TemplateTargetItem.Value>%join%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:GeneratedFileTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o66">
<a:ObjectID>D913D46E-8AC2-4F06-A6AD-A0B1440DC277</a:ObjectID>
<a:Name>Flow</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o67">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>4751EF98-369B-40C0-8219-AA4ED05D2941</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o68">
<a:ObjectID>1ED36A5E-37A0-4AC3-97C7-035BF8A56814</a:ObjectID>
<a:Name>uriDocumentation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Defines user documentation for any element. Must be the first element of its container.  Documentation can be either inline PCDATA and/or a URI to where more complete documentation is to be found.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o69">
<a:ObjectID>3AE03CB6-55D4-4478-98AC-15B7CBF8C29B</a:ObjectID>
<a:Name>onInitiation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Is used to specify this is a nested  BusinessTransactionActivity and a second transaction is performed before returning to the this transaction to send the response back to the original requestor.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o70">
<a:ObjectID>67DA2001-5E14-4FD0-8304-0AEBFFB5AB0A</a:ObjectID>
<a:Name>expressionLanguage</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Expression language of the condition on Document Envelope.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>java</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o71">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>2F9ADBEF-C48D-41C9-A7A4-1858B395A785</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o72">
<a:ObjectID>C1E481C2-026C-42AB-8DEA-A93CE46ADE48</a:ObjectID>
<a:Name>bizFlows</a:Name>
<a:TemplateTargetItem.Value>.//generates the three types of transitions in ebXML:
.//1- Transition between business activities
.//2- Transition to the success end of the binary collaboration
.//3- Transition to the failure end of the binary collaboration
.ifnot (%isToSplit%)
   .if ((%isBetweenProcess%)or(%isFromProcessToJoin%)or(%isFromJoinToProcess%))
&lt;Transition %fromBusinessState%[ %fromBusinessStateIDRef%]
[            %toBusinessState%[ %toBusinessStateIDRef%]\n]\
[            %extendedAttributes%\n]\
[            conditionGuard=&quot;%.X:FlowType%&quot;]&gt;
[   %documentation%\n]\
[   %conditionExpr%\n]\
&lt;/Transition&gt;
   .else
       .if (%isFinalSuccess%)
&lt;Success [%fromBusinessState%[ %fromBusinessStateIDRef%]]
         conditionGuard=&quot;Success&quot;&gt;
[   %documentation%\n]\
[   %conditionExpr%\n]\
&lt;/Success&gt;
       .endif
      .if (%isFinalFailure%)
&lt;Failure [%fromBusinessState%[ %fromBusinessStateIDRef%]]
         conditionGuard=&quot;BusinessFailure&quot;&gt;
[   %documentation%\n]\
[   %conditionExpr%\n]\
&lt;/Failure&gt;
      .endif
   .endif
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TypedCategoryTargetItem Id="o73">
<a:ObjectID>893DE3E6-FAB7-4056-9596-238B86C59A74</a:ObjectID>
<a:Name>ExaHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o74">
<a:ObjectID>EFCA6B29-2C0C-49FC-A0F1-F42A03162DD8</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>.if (%onInitiation%==true)
onInitiation=&quot;true&quot;
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o75">
<a:ObjectID>7EBB2034-9214-4708-9018-7B527485FFB9</a:ObjectID>
<a:Name>Helpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o76">
<a:ObjectID>AEDB1FAE-418A-43FC-91C5-5E7C744D61C3</a:ObjectID>
<a:Name>fromBusinessState</a:Name>
<a:TemplateTargetItem.Value>fromBusinessState=&quot;%Source.removeSuffixFromCode%&quot;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o77">
<a:ObjectID>7B2E9004-1B3D-4B14-A63C-451CA9B56545</a:ObjectID>
<a:Name>toBusinessState</a:Name>
<a:TemplateTargetItem.Value>toBusinessState=&quot;%Destination.removeSuffixFromCode%&quot;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o78">
<a:ObjectID>4E26D316-9015-4413-A785-6485F6E3A411</a:ObjectID>
<a:Name>isBetweenProcess</a:Name>
<a:TemplateTargetItem.Value>.if(%isProcessSource%) and (%isProcessTarget%)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o79">
<a:ObjectID>5875628E-50D4-49FC-9470-E30538837C60</a:ObjectID>
<a:Name>sourceType</a:Name>
<a:TemplateTargetItem.Value>%Source.ObjectType%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o80">
<a:ObjectID>A65D3926-871B-4F33-ACD0-BDD501E687C6</a:ObjectID>
<a:Name>targetType</a:Name>
<a:TemplateTargetItem.Value>%Destination.ObjectType%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o81">
<a:ObjectID>DF1C2FAC-0423-4B6E-9173-959E1B78D8A2</a:ObjectID>
<a:Name>isProcessTarget</a:Name>
<a:TemplateTargetItem.Value>.if(%targetType%==&quot;Process&quot;)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o82">
<a:ObjectID>A0713D57-35CE-4157-B07E-BA6D88579F4E</a:ObjectID>
<a:Name>isProcessSource</a:Name>
<a:TemplateTargetItem.Value>.if(%sourceType%==&quot;Process&quot;)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o83">
<a:ObjectID>F1008CB2-BB11-4320-B1A7-E55959A765AD</a:ObjectID>
<a:Name>isEndTarget</a:Name>
<a:TemplateTargetItem.Value>.if(%targetType%==&quot;ProcessEnd&quot;)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o84">
<a:ObjectID>1B137AC7-4C5E-4E0E-A978-6144FF4B3FEB</a:ObjectID>
<a:Name>isFinalSuccess</a:Name>
<a:TemplateTargetItem.Value>.//Tests if the flow is from a process (or a synchronization)  to an End object and
.// whether the type of the flow is a Success.
.if ((%isProcessSource%)or(%isJoinSource%)) and (%isEndTarget%) and (%isSuccessType%)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o85">
<a:ObjectID>19C74703-1B8B-4D02-8250-D436E40D89D8</a:ObjectID>
<a:Name>isFinalFailure</a:Name>
<a:TemplateTargetItem.Value>.//Tests if the flow is from a process (or a synchronization) to an End object 
.//and whether the type of the flow is a Business Error.
.if ((%isProcessSource%)or(%isJoinSource%)) and (%isEndTarget%) and (%isFailureType%)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o86">
<a:ObjectID>DC38594A-068E-4EBC-882F-DEE13CF4BF3A</a:ObjectID>
<a:Name>isFailureType</a:Name>
<a:TemplateTargetItem.Value>.if (%.L:FlowType%==&quot;business error&quot;) or (%.L:FlowType%==&quot;failure&quot;)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o87">
<a:ObjectID>48CADED7-C4FF-4A01-8F6D-E1A41D6C1839</a:ObjectID>
<a:Name>isSuccessType</a:Name>
<a:TemplateTargetItem.Value>.if (%FlowType%==&quot;Success&quot;) or (%FlowType%==&quot;Normal&quot;)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o88">
<a:ObjectID>36FAFB4C-41CE-41D2-AFD9-3BA923F19296</a:ObjectID>
<a:Name>isToSplit</a:Name>
<a:TemplateTargetItem.Value>.//Test whether the flow is outgoing from an  implicit fork process (a process with parallel outgoing flows to different processes).
.if(%isProcessSource%) and (%isProcessTarget%) and (%isSplitSource%)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o89">
<a:ObjectID>D82B9DE2-185D-4F8B-BE27-85B6C726D0D9</a:ObjectID>
<a:Name>isSplitSource</a:Name>
<a:TemplateTargetItem.Value>.if (%Source.hasManyOutFlows%)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o90">
<a:ObjectID>A76B2EAD-9642-4362-B562-091697B3D323</a:ObjectID>
<a:Name>toSplitState</a:Name>
<a:TemplateTargetItem.Value>toBusinessState=&quot;%Source.removeSuffixFromCode%fork&quot;[ toBusinessStateIDRef = &quot;Fork_%Source.nameID%&quot;]</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o91">
<a:ObjectID>483E7204-F406-46DA-B02F-5114B0A4C8A3</a:ObjectID>
<a:Name>fromSplitState</a:Name>
<a:TemplateTargetItem.Value>fromBusinessState=&quot;%Source.removeSuffixFromCode%Fork&quot;[ fromBusinessStateIDRef=&quot;Fork_%Source.nameID%&quot;]</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o92">
<a:ObjectID>6DA2F1DF-205A-4F81-B60D-2A052F2112C8</a:ObjectID>
<a:Name>isFromProcessToJoin</a:Name>
<a:TemplateTargetItem.Value>.if(%isProcessSource%) and (%isJoinTarget%)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o93">
<a:ObjectID>B423B530-6FB8-483E-8DB3-0C1599F03E56</a:ObjectID>
<a:Name>isFromJoinToProcess</a:Name>
<a:TemplateTargetItem.Value>.if(%isJoinSource%) and (%isProcessTarget%)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o94">
<a:ObjectID>4751933D-7BA7-4329-A35D-FA22FE1F95FF</a:ObjectID>
<a:Name>isJoinSource</a:Name>
<a:TemplateTargetItem.Value>.if(%sourceType%==&quot;Synchronization&quot;)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o95">
<a:ObjectID>03852EAB-C00E-4A0D-B721-7564D9273ECD</a:ObjectID>
<a:Name>isJoinTarget</a:Name>
<a:TemplateTargetItem.Value>.if(%targetType%==&quot;Synchronization&quot;)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o96">
<a:ObjectID>4F1BBB01-2961-40D7-810C-B8C2B6B14875</a:ObjectID>
<a:Name>extractSplitter</a:Name>
<a:TemplateTargetItem.Value>.//if the source of the flow is a fork process, get the code of this process
.if (%isToSplit%)
%Source.removeSuffixFromCode%:%Source.nameID%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o97">
<a:ObjectID>30757026-C75C-4BEE-9CFE-494F46DDD4E8</a:ObjectID>
<a:Name>targetForkFlows</a:Name>
<a:TemplateTargetItem.Value>.//generates a transition from a fork process to another process
.if (%isToSplit%)
&lt;Transition  %fromSplitState%
[            %toBusinessState% %toBusinessStateIDRef%\n]\
[            %extendedAttributes%\n]\
[            conditionGuard=&quot;%.X:FlowType%&quot;]&gt;
[   %conditionExpr%\n]\
[   %documentation%\n]\
&lt;/Transition&gt;
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o98">
<a:ObjectID>EA7E3D00-46F8-404F-9D54-CED28BCEA043</a:ObjectID>
<a:Name>conditionExpr</a:Name>
<a:TemplateTargetItem.Value>.//generate a flow condition expression as a transition condition expression.
.//The expression language is an extended attribute of the flow.
.if (%ConditionExpression%)
&lt;ConditionExpression
    expressionLanguage=&quot;%.X:expressionLanguage%&quot;
    expression=&quot;%.X:ConditionExpression%&quot;&gt;
&lt;/ConditionExpression&gt;
.endif
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o99">
<a:ObjectID>BEC20A5F-D37A-462E-BF28-8CB3684FF8DA</a:ObjectID>
<a:Name>documentationList</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o100">
<a:ObjectID>A10C7402-03B7-49B9-A19C-8F0B4414279F</a:ObjectID>
<a:Name>docDescription</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o101">
<a:ObjectID>E4270234-8080-4F7A-91FB-71A4501B4A07</a:ObjectID>
<a:Name>fromBusinessStateIDRef</a:Name>
<a:TemplateTargetItem.Value>[fromBusinessStateIDRef=&quot;%Source.nameID%&quot;]</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o102">
<a:ObjectID>B9437690-5F13-45E9-B70D-8531FC94C407</a:ObjectID>
<a:Name>toBusinessStateIDRef</a:Name>
<a:TemplateTargetItem.Value>[toBusinessStateIDRef=&quot;%Destination.nameID%&quot;]</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TemplateTargetItem Id="o103">
<a:ObjectID>1338EB33-9818-4FC8-9648-8803A4CF9F5C</a:ObjectID>
<a:Name>messageFormat</a:Name>
<a:TemplateTargetItem.Value>.// Generates the business document sent with a document envelope. 
.// The message format on the flow within a business transaction constitutes a business document.
.if (%Format%)
%Format.bizDocument%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o104">
<a:TypePublicName>StereotypeTargetItem</a:TypePublicName>
<a:ObjectID>1589319A-3A8B-40ED-AF08-BDAD642DD16C</a:ObjectID>
<a:Name>Stereotypes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:StereotypeTargetItem Id="o105">
<a:ObjectID>E5AB0C45-BAD1-4BF1-8DDA-1DADE8D33121</a:ObjectID>
<a:Name>AcceptanceAck</a:Name>
<a:Code>AcceptanceAck</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Acceptance acknowledgement</a:Comment>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o106">
<a:ObjectID>4303B5C2-A8EB-45CE-87D0-CA797700CD04</a:ObjectID>
<a:Name>ReceiptAck</a:Name>
<a:Code>ReceiptAck</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Reception acknowledgement</a:Comment>
<c:Categories>
<o:TypedCategoryTargetItem Id="o107">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>E2BEBF63-FD18-4110-B414-D7C1780AFFE2</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o108">
<a:ObjectID>316A558D-3D05-4268-9CFE-A620CFEB47AC</a:ObjectID>
<a:Name>Is Document Envelope</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Flow is used as a Document Envelope between a Requesting Activity and Responding Activity of the Business Transaction.</a:HelpMessage>
<a:OutputMessage>The following Flows do not define a Document Envelope:</a:OutputMessage>
<a:DefaultSeverity>W</a:DefaultSeverity>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Process)) Then
      If (obj.Parent.Stereotype = &quot;BusinessTransaction&quot;) Then
         If (obj.Source.Stereotype = &quot;RequestingBusinessActivity&quot; And obj.Destination.Stereotype = &quot;RespondingBusinessActivity&quot;) Then
            If (obj.Format Is Nothing) Then
               %Check% = False
            End If
          End If
      End If
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o109">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>0C529DE7-7784-40C7-8E5D-1B732DFE5F76</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o110">
<a:ObjectID>3B95BF8C-EA55-4388-8A90-ABD1D4C75160</a:ObjectID>
<a:Name>Collaboration flow should not define a message format</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Collaboration flow does not define any message format.</a:HelpMessage>
<a:OutputMessage>The following Collaboration flows contain unexpected Message Format:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Process)) Then
      Select Case obj.Parent.Stereotype
         Case &quot;MultiPartyCollaboration&quot;, &quot;BinaryCollaboration&quot;
            If (Not obj.Format Is Nothing) Or (obj.UndefinedFormat) Then
                %Check% = False
            End If
      End Select
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o111">
<a:ObjectID>77B08811-6E21-4246-BBB0-40653391BA08</a:ObjectID>
<a:Name>Parent should be a composite ebXML process</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that a flow is defined in a choreography under a Binary Collaboration or under a Business Transaction.</a:HelpMessage>
<a:OutputMessage>The following flows have unexpected parent:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Model) Or obj.Parent.IsKindOf(PdBPM.cls_Package)) Then
      %Check% = False
      Exit Function
   End If
   If (obj.Parent.IsKindOf(PdBPM.cls_Process)) Then
      Select Case obj.Parent.Stereotype
         Case &quot;MultiPartyCollaboration&quot;,&quot;BusinessTransaction&quot;, &quot;BinaryCollaboration&quot;
            %Check% = True
         Case Else
            %Check% = False
      End Select
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o112">
<a:ObjectID>EE5B8B7F-7955-419C-A850-FEB60661D84D</a:ObjectID>
<a:Name>Flow type validity</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Flow type is recognized by ebXML specification (Success, Business Error, Technical Error or AnyError).</a:HelpMessage>
<a:OutputMessage>The following flows do not have a recognized ebXML flow type:</a:OutputMessage>
<a:DefaultSeverity>W</a:DefaultSeverity>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim i
   Dim FlowTypes
   FlowTypes = Array(&quot;Business Error&quot;, &quot;Technical Error&quot;, &quot;Success&quot;, &quot;AnyFailure&quot;)
   For i = 0 To 3
      If (StrComp(FlowTypes(i),obj.FlowType,1)=0) Then
         Exit For
      End If
   Next
   If i &gt; 3 Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o113">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>6FFD6E71-1440-443A-BDED-8CCA19ABF81E</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o114">
<a:ObjectID>83E88F52-0485-4C7C-BFC9-B47412CD0052</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = False
      else
         if parent.EvaluateTemplate(&quot;canCreateFlow&quot;) = &quot;true&quot; then
            %CanCreate% = True
         else
            %CanCreate% = False
         end if
      end if
   end if      
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o115">
<a:ObjectID>FED50041-9563-4911-8AEE-225ADD3D159D</a:ObjectID>
<a:Name>MessageFormat</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o116">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>59746DE7-2EF3-4162-B39B-5FF70D0F5F38</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o117">
<a:ObjectID>63EA3A97-E916-4AAE-ACC2-17A1DA62E3B4</a:ObjectID>
<a:Name>docTypeDocumentation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Documentation of DocumentType.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>14</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o118">
<a:ObjectID>278A6AA4-1894-4358-BCFA-8D21D6D480A7</a:ObjectID>
<a:Name>isPositiveResponse</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>An expression whose evaluation results in TRUE or FALSE as the determination of whether this DocumentFlow should be considered the successful initiation or conclusion of a BusinessTransaction.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o119">
<a:ObjectID>3A6667EB-95E8-49C9-A9F1-87C764309EC6</a:ObjectID>
<a:Name>isAuthenticated</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>There is a digital certificate associated with the document entity. This provides proof of the signer&#39;s identity.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o120">
<a:ObjectID>1466F8C2-9601-4124-A962-5CE1208B62E1</a:ObjectID>
<a:Name>isConfidential</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The information entity is encrypted so that unauthorized parties cannot view the information.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o121">
<a:ObjectID>8432E963-CB1F-4F04-B661-EC3AA9F23DC5</a:ObjectID>
<a:Name>isTamperProof</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The information entity has an encrypted message digest that can be used to check if the message has been tampered with. This requires a digital signature (sender&#39;s digital certificate and encrypted message digest) associated with the document entity.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o122">
<a:ObjectID>0AE97FAF-FD4D-4C41-9B85-0869D65BC3D8</a:ObjectID>
<a:Name>uriDocumentation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Defines user documentation for any element. Must be the first element of its container.  Documentation can be either inline PCDATA and/or a URI to where more complete documentation is to be found.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o123">
<a:ObjectID>AC0DAAF7-A112-11D5-A3ED-0002A523AAEC</a:ObjectID>
<a:Name>specificationElement</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>represents an element in a DTD associated with Document Flow.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o124">
<a:ObjectID>AC0DAAFA-A112-11D5-A3ED-0002A523AAEC</a:ObjectID>
<a:Name>conditionExpression</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The expression of the condition described with expression language.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o125">
<a:ObjectID>AC0DAAFB-A112-11D5-A3ED-0002A523AAEC</a:ObjectID>
<a:Name>expressionLanguage</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Expression language of the condition on Document Envelope. By default Java.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>java</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o126">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>887A9246-840A-4BE8-B116-7356CAA33F25</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o127">
<a:ObjectID>A1B53025-BAC5-4784-BC59-5D8428663CEC</a:ObjectID>
<a:Name>bizDocument</a:Name>
<a:TemplateTargetItem.Value>.//This template generates DocumentEnvelope and its attachments within a Business Transaction process.
.// A Document Envelope is generated when a MessageFormat is used by a flow between RequestingBusinessActivity and RespondingBusinessActivity inside a BT process.
.if (%GenOptions.useXPaths%)
&lt;DocumentEnvelope businessDocument=&quot;//%Parent.pathName%/%Code%&quot;[ businessDocumentIDRef=&quot;%nameID%&quot; ] \
.else
&lt;DocumentEnvelope businessDocument=&quot;%Code%&quot;[ businessDocumentIDRef=&quot;%nameID%&quot;] \
.endif
[%extendedAttributes%]&gt;
[%documentation%\n][%attachment%\n]&lt;/DocumentEnvelope&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TypedCategoryTargetItem Id="o128">
<a:ObjectID>3C9F65FA-832D-4668-A447-337627C40284</a:ObjectID>
<a:Name>ExaHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o129">
<a:ObjectID>F5BAFEF5-8850-497B-A564-1AD441B4AD55</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>.ifnot  (%isPositiveResponse%==&quot;&quot;)
[isPositiveResponse=&quot;%isPositiveResponse%&quot;\n]
.endif()
.if (%isAuthenticated%==TRUE)
[isAuthenticated=&quot;%isAuthenticated%&quot;\n]
.endif()
.if (%isConfidential%==TRUE)
[isConfidential=&quot;%isConfidential%&quot;\n]
.endif()
.if (%isTamperProof%==TRUE)
[isTamperProof=&quot;%isTamperProof%&quot;\n]
.endif()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o130">
<a:ObjectID>6DEF4AC0-134C-4BD5-A82F-03DDDE5A2030</a:ObjectID>
<a:Name>extendedAttributesBD</a:Name>
<a:TemplateTargetItem.Value>&lt;ConditionExpression
    expressionLanguage=&quot;%expressionLanguage%&quot;
    expression=&quot;%conditionExpression%&quot;/&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o131">
<a:ObjectID>4B1D7EF1-1FD2-4C04-8E25-D315B8E6F098</a:ObjectID>
<a:Name>specElement</a:Name>
<a:TemplateTargetItem.Value>.if (%specificationElement% !=&quot;&quot;)
[specificationElement=&quot;%specificationElement%&quot;\n]
.endif()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o132">
<a:ObjectID>E902FB4B-CEF8-4783-807A-0AC7EF078CF7</a:ObjectID>
<a:Name>Helpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o133">
<a:ObjectID>E7448365-69C1-4AE8-AAF3-251A78AD7400</a:ObjectID>
<a:Name>attachment</a:Name>
<a:TemplateTargetItem.Value>%attachmentsList%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o134">
<a:ObjectID>FC5FA6EE-9B89-4246-8347-48AB359BD339</a:ObjectID>
<a:Name>attachmentsList</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(ExtendedDependencies,,)
   .if (%dependency%)
[%InfluentObject.attachedFile%\n]
   .endif
.next()
.foreach_item(ExtendedInfluences)
   .if (%invDependency%)
[%DependentObject.attachedFile%\n]
   .endif
.next()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o135">
<a:ObjectID>AA7F9AA6-0638-4D1E-B1CF-91D2B3F68A45</a:ObjectID>
<a:Name>documentationList</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(ExtendedDependencies,,)
.if (%dependency%)
[%InfluentObject.documentationFile%\n]
.endif
.next()
.foreach_item(ExtendedInfluences)
.if (%invDependency%)
[%DependentObject.documentationFile%\n]
.endif
.next()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o136">
<a:ObjectID>0C3ACD0B-3859-4279-87B4-0D68A11FD7DD</a:ObjectID>
<a:Name>endTag</a:Name>
<a:TemplateTargetItem.Value>.if(%conditionExpression%==&quot;&quot;)
/&gt;
.else
\n&lt;/BusinessDocument&gt;
.endif()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o137">
<a:ObjectID>EB99583F-CD4E-4EA3-A231-CE8818CFE970</a:ObjectID>
<a:Name>location</a:Name>
<a:TemplateTargetItem.Value>.if (%GenOptions.useRelativePaths%) and (%DefinitionType% == &quot;1&quot;)
.vbscript()
   Option Explicit
   Dim Location,pos
   Location=ActiveSelection.Item(0).Location
   pos =  InStrRev(Location,&quot;/&quot;)
   if (pos&gt;0) Then
   ScriptResult = Right(Location,Len(Location)-pos)
   else
   ScriptResult = Location
   end if
.endvbscript
.else
%Location%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TemplateTargetItem Id="o138">
<a:ObjectID>997462EF-2098-4BAD-A599-CDDF27A9560B</a:ObjectID>
<a:Name>documentType</a:Name>
<a:TemplateTargetItem.Value>.//This template produces from a MessageFormat a business document used by ebXML process specification.
&lt;BusinessDocument name=&quot;%.X:Code%&quot;[ nameID=&quot;%nameID%&quot;][\n   specificationLocation=&quot;%.X:location%&quot;][ %specElement%]\
.if (%conditionExpression% !=&quot;&quot;)
&gt;
   %extendedAttributesBD%
&lt;/BusinessDocument&gt;    
.else
/&gt;
.endif()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o139">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>BD9E5520-8C46-459D-8A10-96CC196A3CCD</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o140">
<a:ObjectID>EC131369-D484-432C-817F-D23D0665567D</a:ObjectID>
<a:Name>File attachment validity</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the message format is linked to file objects in the extended dependencies page using only the &quot;Documentation&quot; or &quot;Attachment&quot; stereotypes</a:HelpMessage>
<a:OutputMessage>The following objects do not have valid file attachments:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   Dim Infl
   %Check% = True
   For Each Infl In obj.ExtendedDependencies
      If not Infl.IsShortcut() Then 
         If (Infl.InfluentObject.ObjectType = &quot;FileObject&quot;) Then
            If (Infl.Stereotype &lt;&gt; &quot;Attachement&quot;) And (Infl.Stereotype &lt;&gt; &quot;Documentation&quot;) Then
               %Check% = false
            End If
         End If
      End If
   Next
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o141">
<a:ObjectID>A17E9DD7-ED2F-4ECE-BC31-B96C9751F2D3</a:ObjectID>
<a:Name>Message format as document envelope</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the message format is used as a document envelope within a Business Transaction.</a:HelpMessage>
<a:OutputMessage>The following objects are not used as document envelope:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim Flow
   For Each Flow In obj.UsedBy
      If Flow.Parent.Stereotype &lt;&gt; &quot;BusinessTransaction&quot; Then
         %Check%=false
      End If
   Next
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o142">
<a:ObjectID>EB07B146-42C4-437A-96EA-C44EBD1A7E7D</a:ObjectID>
<a:Name>FileObject</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o143">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>0425B3F0-7CEF-4BCB-9072-530660BD765E</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o144">
<a:ObjectID>377061A9-3BE2-43EF-AA6C-271A65DCF479</a:ObjectID>
<a:Name>mimeType</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Defines the valid MIME (Multipurpose Internet Mail Extensions) type of this Attachment.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o145">
<a:ObjectID>B0F9956E-89C5-443C-9EA9-FDF608605F24</a:ObjectID>
<a:Name>specification</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A reference to an external source of description of this attachment.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o146">
<a:ObjectID>9F136316-D661-4B23-AE81-BB1C9CA7AA05</a:ObjectID>
<a:Name>isConfidential</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The information entity is encrypted so that unauthorized parties cannot view the information.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o147">
<a:ObjectID>21EE9FC7-82F6-4811-9F72-5F37F278EB53</a:ObjectID>
<a:Name>isTamperProof</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The information entity has an encrypted message digest that can be used to check if the message has been tampered with. This requires a digital signature (sender&#39;s digital certificate and encrypted message digest) associated with the document entity.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o148">
<a:ObjectID>37CD2813-BE87-4DD0-B4D6-E4DF6135E294</a:ObjectID>
<a:Name>isAuthenticated</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The information entity is encrypted so that unauthorized parties cannot view the information.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o149">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>33B25CD4-9C7B-414D-87AE-EE7D70CB7250</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o150">
<a:ObjectID>03869E2C-377F-45D7-A01E-EC231724AE3E</a:ObjectID>
<a:Name>attachedFile</a:Name>
<a:TemplateTargetItem.Value>[&lt;Attachment name=&quot;%.X:Name%&quot;[ nameID=&quot;%nameID%&quot;]
[%extendedAttributes%&gt;\n]\
&lt;/Attachment&gt;]</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TypedCategoryTargetItem Id="o151">
<a:ObjectID>E8A71F39-F9B6-40DA-BF48-58E17096764F</a:ObjectID>
<a:Name>ExaHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o152">
<a:ObjectID>42EB1D29-487A-4714-8ECA-084FF73BA56D</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>.ifnot (%mimeType%)
.log The extendedAttribute mimeType is required on the file object &quot;%Name%&quot;
.endif
[            mimeType=&quot;%.X:mimeType%&quot;]
[\n          specification=&quot;%.X:specification%&quot;]
.if (%isAuthenticated%==TRUE)
[\n          isAuthenticated=&quot;%isAuthenticated%&quot;]
.endif(\n)
.if (%isConfidential%==TRUE)
[\n          isConfidential=&quot;%isConfidential%&quot;]
.endif(\n)
.if (%isTamperProof%==TRUE)
[\n          isTamperProof=&quot;%isTamperProof%&quot;]
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TemplateTargetItem Id="o153">
<a:ObjectID>A072FEF4-A282-417F-892A-2FDE7F8A4B30</a:ObjectID>
<a:Name>documentationFile</a:Name>
<a:TemplateTargetItem.Value>.ifnot (%Comment% == &quot;&quot;) 
   .if %LocationType% == 0
[\t&lt;Documentation&gt;[\n%.X:Comment%\n][&lt;/Documentation&gt;]]
   .endif
 .endif 
.ifnot  %LocationType% == 0
\t&lt;Documentation&gt; [uri=&quot;%.X:Location%&quot;]&lt;/Documentation&gt;
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o154">
<a:ObjectID>6E9FC7DA-43AF-408C-9A0C-DB7E084375BE</a:ObjectID>
<a:Name>Process</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o155">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>0B311F70-EC12-4F02-A221-0FBE043F0DDB</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o156">
<a:ObjectID>4FBA146C-3C08-4B9F-9844-8E67AE196E87</a:ObjectID>
<a:Name>bizProcess</a:Name>
<a:TemplateTargetItem.Value>.log  The process &quot;%Name%&quot; is not well defined. 
.// The process stereotype must be one of the authorized ebXML stereotypes:
.// BinaryCollaboration, MultipartyCollaboration, BusinessTransaction, BusinessTransactionActivity, RequestingBusinessActivity, RespondingBusinessActivity
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TypedCategoryTargetItem Id="o157">
<a:ObjectID>72724F71-3322-4F2A-A112-50AAADBC784A</a:ObjectID>
<a:Name>ProcessHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o158">
<a:ObjectID>0373EFE1-9A26-4E43-9E03-9336D7C7624A</a:ObjectID>
<a:Name>processHeader</a:Name>
<a:TemplateTargetItem.Value>[&lt;%.X:Stereotype% name=&quot;%removeSuffixFromCode%&quot;[ nameID=&quot;%nameID%&quot;][
      %extendedAttributes%][
      %putDuration%]&gt;\n]</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o159">
<a:ObjectID>7B8716CB-9952-4F6D-B929-88C5DA74E8E6</a:ObjectID>
<a:Name>processFooter</a:Name>
<a:TemplateTargetItem.Value>&lt;/%.X:Stereotype%&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o160">
<a:ObjectID>EBAB4B7A-94BA-4BCF-9E86-D7418CCB2A7E</a:ObjectID>
<a:Name>putDuration</a:Name>
<a:TemplateTargetItem.Value>.if (%Duration%)
timeToPerform=&quot;%.X:Duration%&quot;
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o161">
<a:ObjectID>F08AE141-918A-4DA0-B27B-6AE23D32B0C6</a:ObjectID>
<a:Name>browseActivities</a:Name>
<a:TemplateTargetItem.Value>.//browses only BusinessTransactionActivities and CollaborationActivities within the choreography of composite process BinaryCollaboration
.foreach_item(Processes,,\n)
%bizActivity%
.next(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o162">
<a:ObjectID>417B9993-3BB9-49AE-BBB9-3D0850D95150</a:ObjectID>
<a:Name>browseReqRepActivities</a:Name>
<a:TemplateTargetItem.Value>.//browses only business action processes (Requesting and Responding Business activities) in the composite process Business transaction.
.foreach_item(Processes,,\n)
%businessAction%
.next(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o163">
<a:ObjectID>71DC01E3-B8A2-42FF-8DA7-231C50ADDEA4</a:ObjectID>
<a:Name>browseBinaryCollaborations</a:Name>
<a:TemplateTargetItem.Value>.//Generates business partner roles of the MultiPartyCollaboration. 
.//Browses only Extended dependencies between organization units and binary collaborations in the composite process MultiPartyCollaboration. 
.foreach_line(%extractPartnerRole%)
[&lt;BusinessPartnerRole name=&quot;%.X:CurrentLine%&quot;&gt;\n]
   .foreach_item(ActiveModel.OrganizationUnits)
      .if (%Code% == %CurrentLine%)
[%documentation%\n]
      .endif
   .next()
   .foreach_item(ChildExtendedDependencies,,)
      .if (%CurrentLine% == %InfluentObject.Code%) and (%DependentObject.ObjectType% == Process)
[\t&lt;Performs respondingRole=&quot;//%DependentObject.pathName%/%DependentObject.secondAuthorizedRole%&quot;/&gt;\n]
      .endif
      .if (%CurrentLine% == %DependentObject.Code%) and (%InfluentObject.ObjectType% == Process)
[\t&lt;Performs initiatingRole=&quot;//%InfluentObject.pathName%/%InfluentObject.firstAuthorizedRole%&quot;/&gt;\n]
      .endif
   .next()
&lt;/BusinessPartnerRole&gt;\n
.next()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o164">
<a:ObjectID>172F2F6D-F2F8-480C-978E-78F4A5813FF6</a:ObjectID>
<a:Name>ExaHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o165">
<a:ObjectID>2F40792C-21E5-4517-954E-AFCE0A1CAC28</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>.// do nothing.</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o166">
<a:ObjectID>990638C0-3C0D-4FAA-8324-7BE12BC518F6</a:ObjectID>
<a:Name>StartHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o167">
<a:ObjectID>05F58DA1-4241-4B34-ABA1-7D0AF3E946DA</a:ObjectID>
<a:Name>bizStarts</a:Name>
<a:TemplateTargetItem.Value>.warning This process cannot contain Start objects.
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o168">
<a:ObjectID>A2D33728-331C-4A40-A0CC-27221FE58EA6</a:ObjectID>
<a:Name>TransitionHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o169">
<a:ObjectID>293CC15B-59F2-4B9B-881D-D0EE29C00522</a:ObjectID>
<a:Name>bizTransition</a:Name>
<a:TemplateTargetItem.Value>.warning This process cannot contain Transition objects.</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o170">
<a:ObjectID>CAF05F0B-B949-4B02-9AE2-6A5CA3005BD9</a:ObjectID>
<a:Name>hasManyOutFlows</a:Name>
<a:TemplateTargetItem.Value>.if (%OutputFlows.IsEmpty%)
false
.else
   .ifnot(%onlyProcesses%==%allTargetProcesses%)
false
   .else
      .if (%onlyProcesses%==p) and (%allTargetProcesses%==p)
false
      .else
true
      .endif
   .endif
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o171">
<a:ObjectID>4CF36609-B65E-4B0B-A92A-3BFD2DA3DCB5</a:ObjectID>
<a:Name>splits</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Processes,,\n)
   .if (%hasManyOutFlows%==true)
&lt;Fork name=&quot;%removeSuffixFromCode%Fork&quot;[ nameID=&quot;Fork_%nameID%&quot;]&gt;
&lt;/Fork&gt;
   .endif
.next(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o172">
<a:ObjectID>04D2AA7A-92B7-44F9-B5EF-5CE31FD81847</a:ObjectID>
<a:Name>isSplitter</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o173">
<a:ObjectID>04F6830C-F22B-4A88-BED5-F5859E6DCFA1</a:ObjectID>
<a:Name>onlyProcesses</a:Name>
<a:TemplateTargetItem.Value>.unique
   .foreach_item(OutputFlows,,)
      .if (%isProcessTarget%) and (%ConditionExpression%==&quot;&quot;)
p
      .endif
   .next()
.endunique</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o174">
<a:ObjectID>1AC120D9-B83A-45AE-A9A6-223D2FC61DA3</a:ObjectID>
<a:Name>allTargetProcesses</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(OutputFlows,,)
   .if (%isProcessTarget%)and(%ConditionExpression%==&quot;&quot;)
p
   .else
n
   .endif
.next()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o175">
<a:ObjectID>812D6308-0D8A-436B-A0B6-99421EB1E9B5</a:ObjectID>
<a:Name>getAllSplitter</a:Name>
<a:TemplateTargetItem.Value>.unique
   .foreach_item(Flows,,)
%extractSplitter%
   .next(\n)
.endunique</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o176">
<a:ObjectID>B7F100EB-647D-4E44-B112-F31E2BCA1F65</a:ObjectID>
<a:Name>forkFlows</a:Name>
<a:TemplateTargetItem.Value>.foreach_line(%getAllSplitter%,,)
.vbscript (%CurrentLine%)
   Option Explicit
   Dim Location,pos, Transition, Rvalue,Lvalue
   Location=ScriptInputParameters
   pos =  InStrRev(Location,&quot;:&quot;)
   if (pos&gt;0) Then
      Rvalue = Right(Location,Len(Location)-pos)
      Lvalue = Left(Location,pos-1)
      Transition = &quot;&lt;Transition  fromBusinessState=&quot; + &quot;&quot;&quot;&quot;+ Lvalue+ &quot;&quot;&quot;&quot;+ &quot; fromBusinessStateIDRef = &quot;+ &quot;&quot;&quot;&quot;+ Rvalue+ &quot;&quot;&quot;&quot;+ vbNewLine +vbTab+ vbTab+vbTab+ vbTab+&quot;toBusinessState=&quot;+ &quot;&quot;&quot;&quot;+ Lvalue+ &quot;Fork&quot;+ &quot;&quot;&quot;&quot;+ &quot; toBusinessStateIDRef=&quot;+ &quot;&quot;&quot;&quot;+ &quot;Fork_&quot;+ Rvalue+ &quot;&quot;&quot;&quot;+ &quot;&gt;&quot;+ vbNewLine+ &quot;&lt;/Transition&gt;&quot;
   else
      Transition = &quot;&lt;Transition  fromBusinessState=&quot;+ &quot;&quot;&quot;&quot;+ Lvalue+ &quot;&quot;&quot;&quot;+ vbNewLine +vbTab+ vbTab+vbTab+ vbTab+&quot;toBusinessState=&quot;+ &quot;&quot;&quot;&quot;+ Lvalue + &quot;Fork&quot;+ &quot;&quot;&quot;&quot;+ &quot;&gt;&quot; +vbNewLine +&quot;&lt;/Transition&gt;&quot;
   end if
   ScriptResult = Transition   
.endvbscript
.//&lt;Transition  fromBusinessState=&quot;%CurrentLine%&quot;
.//             toBusinessState=&quot;%CurrentLine%Fork&quot;&gt;
.//&lt;/Transition&gt;
.next(\n)

</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o177">
<a:ObjectID>439D20BC-655C-42BB-BD6D-51D9916F959C</a:ObjectID>
<a:Name>outForkFlows</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Flows,,\n)
%targetForkFlows%
.next(\n)
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o178">
<a:ObjectID>CDD41036-BC98-4834-A99B-2CA641E58F28</a:ObjectID>
<a:Name>AuthorizedRolesHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o179">
<a:ObjectID>42EA51C5-599F-485D-BB34-E49AF72318AC</a:ObjectID>
<a:Name>authorizedRoles</a:Name>
<a:TemplateTargetItem.Value>.warning This process does not support authorized roles. </a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o180">
<a:ObjectID>EF024C6C-B4D0-4F02-8C72-074545E121B7</a:ObjectID>
<a:Name>firstAuthorizedRole</a:Name>
<a:TemplateTargetItem.Value>.//returns the first role association on the Process&lt;&lt;BinaryCollaboration&gt;&gt;. The source object must be an OrganizationUnit
.set_value(bAuthRole,true, new)
.foreach_item(InitiatingRoleAssociations,,,%bAuthRole%)
.if (%Source.ObjectType%==OrganizationUnit) And (%Parent.ObjectType% != Process)
%Source.removeSuffixFromCode%
.set_value(bAuthRole,false)
.endif
.next()
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o181">
<a:ObjectID>7F1B78E1-655B-4226-8F4F-5D4398A039F6</a:ObjectID>
<a:Name>secondAuthorizedRole</a:Name>
<a:TemplateTargetItem.Value>.//returns the first role association on the Process&lt;&lt;BinaryCollaboration&gt;&gt;. The destination object must be an OrganizationUnit.
.set_value(bAuthRole,true, new)
.foreach_item(RespondingRoleAssociations,,,%bAuthRole%)
   .if (%Destination.ObjectType%==OrganizationUnit) And (%Parent.ObjectType% != Process)
%Destination.removeSuffixFromCode%
.set_value(bAuthRole,false)
   .endif
.next()
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o182">
<a:ObjectID>86F3C778-6C08-4A26-8F0C-F8DF0789625A</a:ObjectID>
<a:Name>toAuthorizedRole</a:Name>
<a:TemplateTargetItem.Value>.warning This process does not support authorized roles.</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o183">
<a:ObjectID>738DC81C-02AF-48C3-91E2-28A41CC368DB</a:ObjectID>
<a:Name>toRole</a:Name>
<a:TemplateTargetItem.Value>.//Generates the CollaborationActivity toAuthorizedRole. This role corresponds to the RespondingRole of the BinaryCollaboration used by the Activity.
.if (%Implementer%)
toAuthorizedRole=&quot;%Implementer.searchToRoles%&quot;
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o184">
<a:ObjectID>C6AAD189-4E19-4CD4-9A34-FF60564557FF</a:ObjectID>
<a:Name>fromAuthorizedRole</a:Name>
<a:TemplateTargetItem.Value>.warning This process does not support authorized roles.</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o185">
<a:ObjectID>63BEF2FF-15AE-4691-A21A-01FC9309FC21</a:ObjectID>
<a:Name>searchFromRoles</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Processes,,\n)
%fromAuthorizedRole%
.next
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o186">
<a:ObjectID>A3EA701B-0CA2-4AC1-ACDB-F946A2B652C6</a:ObjectID>
<a:Name>searchToRoles</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Processes,,\n)
%toAuthorizedRole%
.next
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o187">
<a:ObjectID>4C3C6EB9-B64D-4B3A-8C8A-3460F6262CF5</a:ObjectID>
<a:Name>fromRole</a:Name>
<a:TemplateTargetItem.Value>.//Generates the CollaborationActivity fromAuthorizedRole. This role corresponds to the InitiatingRole of the BinaryCollaboration used by the Activity.
.if (%Implementer%)
fromAuthorizedRole=&quot;%Implementer.searchFromRoles%&quot;
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o188">
<a:ObjectID>396B408B-F15F-442C-8452-AF7B08BD0998</a:ObjectID>
<a:Name>extractPartnerRole</a:Name>
<a:TemplateTargetItem.Value>.//Constructs a list of organization units used as business partner roles in MultiPartyCollaboration
.unique
   .foreach_item(ChildExtendedDependencies,,)
      .if (%InfluentObject.ObjectType%==OrganizationUnit) and  (%DependentObject.ObjectType%==Process)
         .if (%DependentObject.Stereotype%== BinaryCollaboration) and (%InfluentObject.Stereotype% != AuthorizedRole)
[%InfluentObject.Code%\n]
         .endif
      .endif
      .if (%InfluentObject.ObjectType%==Process) and  (%DependentObject.ObjectType%==OrganizationUnit)
         .if (%InfluentObject.Stereotype%== BinaryCollaboration) and (%DependentObject.Stereotype% != AuthorizedRole)
[%DependentObject.Code%\n]
         .endif
      .endif
   .next()
.endunique
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o189">
<a:ObjectID>8A9CD224-A2F7-4AAF-8A29-1EF382B71005</a:ObjectID>
<a:Name>initiatingRoleBC</a:Name>
<a:TemplateTargetItem.Value>.//Generates the InitiatingRole on the Binary collaboration.
.// It corresponds to the Dependent object (OrganizationUnit) of the First role association created from an Organization unit to the BinaryCollaboration.
.if (%InitiatingRoleAssociations.First.Source.ObjectType%==OrganizationUnit) 
.if (%InitiatingRoleAssociations.First.Parent.ObjectType% != Process)
&lt;InitiatingRole name=&quot;%InitiatingRoleAssociations.First.Source.removeSuffixFromCode%&quot;[ nameID=&quot;%InitiatingRoleAssociations.First.Source.nameID%&quot;]&gt;[%InitiatingRoleAssociations.First.Source.documentation%]
&lt;/InitiatingRole&gt;
.endif
.endif
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o190">
<a:ObjectID>6017F286-EF1A-41CA-99CD-01192AF356A7</a:ObjectID>
<a:Name>respondingRoleBC</a:Name>
<a:TemplateTargetItem.Value>.//Generates the RespondingRole on the Binary collaboration.
.//It corresponds to the Influent object (OrganizationUnit) of the First role association created from the BinaryCollaboration to an Organization unit.
.if (%RespondingRoleAssociations.First.Destination.ObjectType%== OrganizationUnit)
.if (%RespondingRoleAssociations.First.Parent.ObjectType% != Process)
&lt;RespondingRole name=&quot;%RespondingRoleAssociations.First.Destination.removeSuffixFromCode%&quot;[ nameID=&quot;%RespondingRoleAssociations.First.Destination.nameID%&quot;]&gt;[%RespondingRoleAssociations.First.Destination.documentation%]
&lt;/RespondingRole&gt;
.endif
.endif
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o191">
<a:ObjectID>32B5DA8C-C9AE-4347-9E54-DAA14DEDDD8E</a:ObjectID>
<a:Name>DocumentFlowHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o192">
<a:ObjectID>30121C8F-F1F1-4BD7-9144-3F5A396E9D37</a:ObjectID>
<a:Name>messageFormat</a:Name>
<a:TemplateTargetItem.Value>.//Generates an ebXML DocumentEnvelope from each flow going out of the RequestingBusinessActivity or RespondingBusinessActivity process.
.foreach_item(OutputFlows)
[%messageFormat%\n]
.next</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o193">
<a:ObjectID>270B79D4-7166-4BB6-B940-63FF266D0DB8</a:ObjectID>
<a:Name>documentFlow</a:Name>
<a:TemplateTargetItem.Value>.warning This process cannot have an outgoing flow with message format. </a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o194">
<a:ObjectID>2E74FB4F-FFCA-405C-BE9C-7DA6073F14E2</a:ObjectID>
<a:Name>BusinessActivities</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o195">
<a:ObjectID>8F7C4A0D-F350-4708-9AD4-1E4D3CFCAB51</a:ObjectID>
<a:Name>bizActivity</a:Name>
<a:TemplateTargetItem.Value>.if %Parent.ObjectID% == %Outer.Outer.ObjectID%
.warning The Binary collaboration should contain only business activity processes.
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o196">
<a:ObjectID>E16D085C-3582-4B6C-9650-C53AA8A663B1</a:ObjectID>
<a:Name>genericActivity</a:Name>
<a:TemplateTargetItem.Value>&lt;%Stereotype% name=&quot;%removeSuffixFromCode%&quot;\
[\n   %implementerProcess%]\
[\n   %fromRole%]\
[\n   %toRole%]\
[\n   %extendedAttributes%]&gt;
[   %documentation%\n]\
&lt;/%Stereotype%&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o197">
<a:ObjectID>46377B36-DB03-4963-B497-F233D24DC42A</a:ObjectID>
<a:Name>BusinessActions</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o198">
<a:ObjectID>E0C09964-21E0-4DA5-8D02-0D8200E36DD6</a:ObjectID>
<a:Name>businessAction</a:Name>
<a:TemplateTargetItem.Value>.warning This process cannot contain requesting or respondig business activities.</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o199">
<a:ObjectID>D1F72EEF-F301-48D8-85AC-5D5F5C6ACEFC</a:ObjectID>
<a:Name>reqRepActivity</a:Name>
<a:TemplateTargetItem.Value>%processHeader%
[   %documentation%\n]\
[   %documentFlow%\n]\
%processFooter%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o200">
<a:ObjectID>AA544A09-F7F9-45AA-B7CF-F3704BD662DE</a:ObjectID>
<a:Name>ProcessSuffixes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o201">
<a:ObjectID>10EFED6F-50E0-4A6F-AE60-5179DE928F4E</a:ObjectID>
<a:Name>removeSuffix</a:Name>
<a:TemplateTargetItem.Value>.//Remove suffix from the process code attribute.
.vbscript (%suffix%)
   dim Code,pos
   Code=ActiveSelection.Item(0).Code
   pos =  InStr(Code,ScriptInputParameters)
   if pos&gt;0 Then
       ScriptResult=Left(Code,pos-1)
   else
       ScriptResult=Code
   End If 
.endvbscript</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o202">
<a:ObjectID>5BB006D7-4671-4B45-A38C-DA125449C8A5</a:ObjectID>
<a:Name>removeSuffixFromCode</a:Name>
<a:TemplateTargetItem.Value>%.X:removeSuffix%
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o203">
<a:ObjectID>CA551D8B-FE99-4BB5-A94A-29EFA46AC65A</a:ObjectID>
<a:Name>SynchronizationHelpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o204">
<a:ObjectID>F6ABCF80-0AC6-4DF6-B14E-68C0AA255EF4</a:ObjectID>
<a:Name>joins</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(BpmSynchronizations,,)
%join%
.next(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TemplateTargetItem Id="o205">
<a:ObjectID>6492F2B3-812E-4CD8-A557-9A136C577A72</a:ObjectID>
<a:Name>canCreateFlow</a:Name>
<a:TemplateTargetItem.Value>false</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o206">
<a:TypePublicName>GeneratedFileTargetItem</a:TypePublicName>
<a:ObjectID>E5AE834A-990C-48CF-A136-AB851DE8C02C</a:ObjectID>
<a:Name>Generated Files</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:GeneratedFileTargetItem Id="o207">
<a:ObjectID>741C2EEE-19CB-4020-AD3A-8B84AA742B26</a:ObjectID>
<a:Name>bizProcess</a:Name>
<a:TemplateTargetItem.Value>%bizProcess%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:GeneratedFileTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o208">
<a:TypePublicName>StereotypeTargetItem</a:TypePublicName>
<a:ObjectID>9A2FCAC2-6E2E-48B6-84B9-47E11CF6B374</a:ObjectID>
<a:Name>Stereotypes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:StereotypeTargetItem Id="o209">
<a:ObjectID>4533C489-8B28-4BE1-8083-672AF722AC73</a:ObjectID>
<a:Name>BusinessTransactionActivity</a:Name>
<a:Code>BusinessTransactionActivity</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>conducts Business Transaction.</a:Comment>
<a:EnableTool>1</a:EnableTool>
<a:ToolIcon>0D0000000800000008000000424D7E000000000000003E000000280000001000
0000100000000100010000000000400000000000000000000000000000000000
000000000000FFFFFF00FFFF0000FFFF0000FFFF0000C0030000800100000000
000000000000000000000000000000000000000000000000000080010000C003
0000FFFF0000FFFF0000424DF600000000000000760000002800000010000000
100000000100040000000000800000000000000000000000000000000A000000
00000000000080003F3F9F00400000007F3F3F007F7FBF009F3F3F00BF7F7F00
BFBFDF00FFFFFF00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000037777777777300
0699999999999940399999999999999379555899598898877919919919825287
7919919919919197791552991995559779199199199818973955588555895993
0699999999999940003777777777730000000000000000000000000000000000
0E000000100000000F000000424DBE000000000000003E000000280000002000
0000200000000100010000000000800000000000000000000000000000000000
000000000000FFFFFF00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
FFFFFC00003FF000000FE0000007C00000038000000180000001000000000000
0000000000000000000000000000000000000000000000000000000000000000
00008000000180000001C0000003E0000007F000000FFC00003FFFFFFFFFFFFF
FFFFFFFFFFFFFFFFFFFF424D7602000000000000760000002800000020000000
2000000001000400000000000002000000000000000000000000000004000000
000000000000800080000000FFFFFF0000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000002222222222222222222200000000002233333333333333333333220000
0022333333333333333333333333200000233333333333333333333333333200
0233333333333333333333333333332002333333333333333333333333333320
2333333333333333333333333333333223331111111333331133311333311332
2333113333113333113331133331133223331133331133331133331111113332
2333113333113333113333113311333223331133331133331133331133113332
2333111111133333113333313313333223331133331133331133333111133332
2333113333113333113333311113333223331133331133331133333311333332
0233111111133111111113331133332002333333333333333333333333333320
0023333333333333333333333333320000223333333333333333333333332000
0000223333333333333333333322000000000022222222222222222222000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
</a:ToolIcon>
<c:Categories>
<o:TypedCategoryTargetItem Id="o210">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>12662EA0-BE44-4217-B485-422B56BE4FD4</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o211">
<a:ObjectID>AA8D0411-55B8-43B9-A260-D51214B048D1</a:ObjectID>
<a:Name>isConcurrent</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>If the business transaction activity is concurrent then more than one business transaction can be open at one time. If the business transaction activity is not concurrent then only one business transaction activity can be open at one time.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o212">
<a:ObjectID>8AC1AFE2-2F60-460D-873F-730DD7F5590F</a:ObjectID>
<a:Name>isLegallyBinding</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The Business Transaction performed by this activity is intended by the trading parties to be binding. Default value is True.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>true</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o213">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>C6FF4BC4-CC39-4597-857E-F3FC76378FF1</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o214">
<a:ObjectID>C073E6F1-0AD9-4A55-9B2C-3ABFDB2FEA1E</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Business Transaction Activity must be created under a Binary Collaboration</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = False
      else
         if parent.Stereotype = &quot;BinaryCollaboration&quot; then
            %CanCreate% = True
         else
            %CanCreate% = False
         end if
      end if
   end if
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
<o:EventHandlerTargetItem Id="o215">
<a:ObjectID>A4C130E8-6716-4B6A-A3C3-419B91897330</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)
   &#39; Check the object kind
   If obj is Nothing then
      %Initialize% = False
      Exit Function
   End If
   If not obj.IsKindOf(PDBPM.Cls_Process) then
      %Initialize% = False  
      Exit Function
   End If
   
   Dim Impl, Mdl, Fldr,Sel,Shct
   &#39; Retrieve the process implementer and check if it is already correct
   Set Impl = obj.Implementer
   If not Impl is Nothing Then
      If Impl.IsKindOf(PDBPM.Cls_Process) and Impl.Stereotype = &quot;BusinessTransaction&quot; then
         %Initialize% = True  
         Set Impl = Nothing
         Exit Function
      End If
   End If 
   &#39; Change implementation mode
   obj.ImplementationMode = 2 &#39; this is the &quot;reuse process&quot; value
   %Initialize% = True
   &#39; Exit if non interactive (the case when we change stereotype by property sheet)
   If not InteractiveMode = Im_Dialog Then
     %Initialize% = True  
     Exit Function
   End If
   &#39; Retrieve the model
   Set Mdl = obj.Model
   %Initialize% = False 
   If Not Mdl is Nothing then
      &#39; Retrieve the folder
      Set Fldr = obj.Folder
      If Not Fldr is Nothing then
         &#39; Create a selection object
         Set Sel = Mdl.CreateSelection
         If Not Sel is Nothing then
           %Initialize% = True 
           &#39;Show the object picker dialog for selecting a BT
            Set Impl = Sel.ShowObjectPicker (&quot;Process&quot;, &quot;BusinessTransaction&quot;, &quot;Select a Business Transaction Process&quot;,False)
           &#39;Retrieve the selection
            If not Impl is Nothing Then
               If Impl.IsKindOf(PDBPM.Cls_Process) and Impl.Stereotype = &quot;BusinessTransaction&quot; then
                   Set Shct = Impl.CreateShortcut (Fldr)
                  If not Shct is Nothing Then
                     obj.Implementer = Shct
                  End If
               End If
             End If
         End If
      End If
      &#39;Clean
      &#39; Free the temporary selection
      Sel.Delete
      Set Mdl = Nothing
      Set Fldr = Nothing
      Set Impl = Nothing
      Set Sel = Nothing
      Set Shct = Nothing
   End If
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o216">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>3F244415-318A-42D5-A5BD-8975C43E5A8E</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o217">
<a:ObjectID>B708C812-D6AD-4C64-91FC-62DEC719871F</a:ObjectID>
<a:Name>Parent should be a Binary Collaboration</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Business Transaction Activity has a Binary Collaboration parent.</a:HelpMessage>
<a:OutputMessage>The following activities do not have a Binary Collaboration parent:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Process) And obj.Parent.Stereotype &lt;&gt; &quot;BinaryCollaboration&quot;) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o218">
<a:ObjectID>C8DA5180-A96F-4CB7-9A66-E52B8E1F74C5</a:ObjectID>
<a:Name>Mandatory Organization Unit</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that Business Transaction Activity has an Organization Unit that define a FromAuthorizedRole of the activity.</a:HelpMessage>
<a:OutputMessage>The following Business Transaction Activities do not define an Organization Unit property:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If obj.OrganizationUnit Is Nothing Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o219">
<a:ObjectID>B10308FD-2906-4801-9EB1-08F1A9C4FF61</a:ObjectID>
<a:Name>Organization Unit should be an authorized role</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures whether the Organization Unit of the Business Transaction Activity is one of the binary collaboration authorized roles.</a:HelpMessage>
<a:OutputMessage>The following Business Transaction Activities do not define a valid Organization Unit:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim BinCol
   Set BinCol = obj.Parent
   if (BinCol Is Nothing) Then
      Exit Function
   End If 
   Dim InitRole
   InitRole = &quot;&quot;
   Dim RespRole
   RespRole = &quot;&quot;
   Dim Assc
   For Each Assc In BinCol.InitiatingRoleAssociations
      If not Assc.IsShortcut() Then 
         If (Assc.Source.ObjectType = &quot;OrganizationUnit&quot;) And (Assc.Parent Is BinCol.Parent) Then
            if (Assc.Source.Stereotype &lt;&gt; &quot;BusinessPartnerRole&quot;) Then
               If InitRole = &quot;&quot; Then
                  InitRole = Assc.Source.Name
               End If
               Exit For
            End If            
         End If
      End If
   Next

   For Each Assc In BinCol.RespondingRoleAssociations
      If not Assc.IsShortcut() Then    
         If (Assc.Destination.ObjectType = &quot;OrganizationUnit&quot;) And (Assc.Parent Is BinCol.Parent) Then
            If (Assc.Destination.Stereotype &lt;&gt; &quot;BusinessPartnerRole&quot;) Then
               If RespRole = &quot;&quot; Then
                  RespRole = Assc.Destination.Name
               End If
               Exit For
            End If
         End If
      End If
   Next   
   If Not obj.OrganizationUnit Is Nothing Then
      If (obj.OrganizationUnit.Name &lt;&gt; InitRole) And (obj.OrganizationUnit.Name &lt;&gt; RespRole) Then
         If (InitRole &lt;&gt; &quot;&quot; And RespRole &lt;&gt; &quot;&quot;) Then
            %Check% = False
         End If
      End If
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o220">
<a:ObjectID>51060EEF-5931-4CB2-BFF5-97AF392B2EA4</a:ObjectID>
<a:Name>Mandatory Implementation by a Business Transaction</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Business Transaction Activity is implemented by a Business Transaction.</a:HelpMessage>
<a:OutputMessage>The following Business Transaction Activities are not implemented by a Business Transaction:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim ImplementerType
   Select Case obj.Stereotype
      Case &quot;BusinessTransactionActivity&quot;
         ImplementerType = &quot;BusinessTransaction&quot;
      Case &quot;CollaborationActivity&quot;
         ImplementerType = &quot;BinaryCollaboration&quot;
      Case Else
         %Check% = False
         Exit Function
   End Select
   If (obj.Implementer Is Nothing) Then
      %Check% = False
   Else
      Dim Impl
      If (obj.Implementer.IsShortcut()) Then
         Set Impl = obj.Implementer.TargetObject
      Else
         Set Impl = obj.Implementer
      End If
      If (Impl Is nothing) Then
         %Check% = False
      Else
         If (Impl.Stereotype &lt;&gt; ImplementerType) Then
            %Check% = False
         ElseIf Impl.Name = obj.Parent.Name Then
            %Check% = False
         End If
      End If
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.
   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;
   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o221">
<a:ObjectID>1AD46DBF-22DB-4E8E-B51E-E90ACAE37B7B</a:ObjectID>
<a:Name>Invalid reflexive transitions</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Business Transaction Activity cannot be the source and the destination of the same transition.</a:HelpMessage>
<a:OutputMessage>The following Business Transaction Activities have reflexive transitions:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim Flow
   For Each Flow In obj.OutputFlows   &#39; For Each outgoing flow
      If Flow.IsKindOf(PdBPM.cls_Flow) Then
         If Flow.Source.Name = Flow.Destination.Name Then
            %Check% = False
            Exit For
         End If
      End If
   Next
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o222">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>8BE66489-2F1D-439A-809D-1316C9EA94FA</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o223">
<a:ObjectID>A112EF7E-B7B4-4810-AA8C-E1775E46CBD0</a:ObjectID>
<a:Name>fromRole</a:Name>
<a:TemplateTargetItem.Value>.//Generates the BusinessTransactionActivity fromAuthorizedRole.
.// This role corresponds to the organization unit attribute of the process. It should be one of the two authorized roles on the parent binary collaboration.
.if (%OrganizationUnit%)
fromAuthorizedRole=&quot;%.X:OrganizationUnit.Code%&quot;[ fromAuthorizedRoleIDRef=&quot;%OrganizationUnit.nameID%&quot;]
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o224">
<a:ObjectID>1751196E-F7D8-41FB-9622-8D90F182FAEC</a:ObjectID>
<a:Name>toRole</a:Name>
<a:TemplateTargetItem.Value>.//Generates the BusinessTransactionActivity toAuthorizedRole ;
.// while the fromAuthorizedRole is defined by an organization unit attribute of the process, this role corresponds to the other authorized role on the parent BinaryCollaboration.
.if (%OrganizationUnit%)
   .if (%OrganizationUnit.Name%==%Parent.secondAuthorizedRole%)
toAuthorizedRole=&quot;%Parent.firstAuthorizedRole%&quot;[ toAuthorizedRoleIDRef=&quot;%Parent.firstAuthorizedRoleIDRef%&quot;]
   .else
toAuthorizedRole=&quot;%Parent.secondAuthorizedRole%&quot;[ toAuthorizedRoleIDRef=&quot;%Parent.secondAuthorizedRoleIDRef%&quot;]
   .endif
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o225">
<a:ObjectID>27E59B32-C9D0-4409-B868-2639F8F49836</a:ObjectID>
<a:Name>bizActivity</a:Name>
<a:TemplateTargetItem.Value>.//Generates an ebXML BusinessTransactionActivity.
%genericActivity%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o226">
<a:ObjectID>A09341DF-0D83-4EAB-906D-CB587F11E113</a:ObjectID>
<a:Name>implementerProcess</a:Name>
<a:TemplateTargetItem.Value>.if (%Implementer%) and (%Implementer.Stereotype%==BusinessTransaction)
.if (%GenOptions.useXPaths%)
businessTransaction=&quot;//%Implementer.pathName%&quot;[ businessTransactionIDRef=&quot;%Implementer.nameID%&quot;]
.else
businessTransaction=&quot;%Implementer.removeSuffixFromCode%&quot;[ businessTransactionIDRef=&quot;%Implementer.nameID%&quot;]
.endif
.else
.log A Business transaction activity &quot;%Name%&quot; should be implemented by (or use) a business transaction
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o227">
<a:ObjectID>2C604C13-0626-4D65-BAE6-5A2ABAB4D4B9</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>.if (%isConcurrent%==TRUE)
isConcurrent=&quot;%isConcurrent%&quot;
.endif(\n)
.if (%isLegallyBinding%==TRUE)
isLegallyBinding=&quot;%isLegallyBinding%&quot;
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o228">
<a:ObjectID>5770589A-949A-43E6-8A04-48CEED46931F</a:ObjectID>
<a:Name>suffix</a:Name>
<a:TemplateTargetItem.Value>_BTA_</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o229">
<a:ObjectID>86E0FF4A-52C8-4E55-98EB-2A208D33D898</a:ObjectID>
<a:Name>bizProcess</a:Name>
<a:TemplateTargetItem.Value>%bizActivity%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o230">
<a:ObjectID>79426744-A58D-44A8-8568-D44508059DC4</a:ObjectID>
<a:Name>CollaborationActivity</a:Name>
<a:Code>CollaborationActivity</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>conducts nested Binary Collaboration.</a:Comment>
<a:EnableTool>1</a:EnableTool>
<a:ToolIcon>0D0000000800000008000000424D7E000000000000003E000000280000001000
0000100000000100010000000000400000000000000000000000000000000000
000000000000FFFFFF00FFFF0000FFFF0000FFFF0000C0030000800100000000
000000000000000000000000000000000000000000000000000080010000C003
0000FFFF0000FFFF0000424DF600000000000000760000002800000010000000
100000000100040000000000800000000000000000000000000000000C000000
0000000000008000202080003F3F9F00400000007F3F3F007F7FBF009F3F3F00
9F9FBF00BF7F7F00BFBFDF00FFFFFF0000000000000000000000000000000000
0000000000000000000000000000000000000000000000000049999999999400
07BBBBBBBBBBBB504BA212B66BB66BB49B66B8BA3663ABB99B66BBBB1661BBB9
9B66BBBB6666BBB99B66BBBBA33ABBB99B66B8BBB11BBBB94BA212BBB66BBBB4
07BBBBBBBBBBBB50004999999999940000000000000000000000000000000000
0E000000100000000F000000424DBE000000000000003E000000280000002000
0000200000000100010000000000800000000000000000000000000000000000
000000000000FFFFFF00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
FFFFFC00003FF000000FE0000007C00000038000000180000001000000000000
0000000000000000000000000000000000000000000000000000000000000000
00008000000180000001C0000003E0000007F000000FFC00003FFFFFFFFFFFFF
FFFFFFFFFFFFFFFFFFFF424D7602000000000000760000002800000020000000
2000000001000400000000000002000000000000000000000000000005000000
00000000000080008000000080808000FFFFFF00000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000002222222222222222222200000000002244444444444444444444220000
0022444444444444444444444444200000244444444444444444444444444200
0244441111134441144444411444442002444131111144411444444114444420
2444411444314441144444411444444224444114444444441111111144444442
2444411444444444111111114444444224444114444444441144441144444442
2444411444444444411441144444444224444114444444444114411444444442
2444411444444444411441144444444224444114444444444411114444444442
2444411444444444441111444444444224444114443144444411114444444442
0244413111114444444114444444442002444411111344444441144444444420
0024444444444444444444444444420000224444444444444444444444442000
0000224444444444444444444422000000000022222222222222222222000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
</a:ToolIcon>
<c:Categories>
<o:TypedCategoryTargetItem Id="o231">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>B8FEC60E-B0DC-4E61-A507-2F8AC30AD402</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o232">
<a:ObjectID>1757E1CF-ACA0-48A4-9C13-F07C4F86953C</a:ObjectID>
<a:Name>Parent should be a Binary Collaboration</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Collaboration Activity has a Binary Collaboration parent.</a:HelpMessage>
<a:OutputMessage>The following activities do not have a Binary Collaboration parent:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Process) And obj.Parent.Stereotype &lt;&gt; &quot;BinaryCollaboration&quot;) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o233">
<a:ObjectID>7DE1A484-8C06-4194-99F0-1C9BBD6179B1</a:ObjectID>
<a:Name>Mandatory Implementation by a Binary Collaboration</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Collaboration Activity is implemented by a Binary Collaboration.</a:HelpMessage>
<a:OutputMessage>The following Collaboration Activities are not implemented by a Binary Collaboration:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim ImplementerType
   Select Case obj.Stereotype
      Case &quot;BusinessTransactionActivity&quot;
         ImplementerType = &quot;BusinessTransaction&quot;
      Case &quot;CollaborationActivity&quot;
         ImplementerType = &quot;BinaryCollaboration&quot;
      Case Else
         %Check% = False
         Exit Function
   End Select
   If (obj.Implementer Is Nothing) Then
      %Check% = False
   Else
      Dim Impl
      If (obj.Implementer.IsShortcut()) Then
         Set Impl = obj.Implementer.TargetObject
      Else
         Set Impl = obj.Implementer
      End If
      If (Impl Is nothing) Then
         %Check% = False
      Else
         If (Impl.Stereotype &lt;&gt; ImplementerType) Then
            %Check% = False
         ElseIf Impl.Name = obj.Parent.Name Then
            %Check% = False
         End If
      End If
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.
   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;
   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o234">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>79F59845-4FD7-42BE-9CE2-8644D88879CE</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o235">
<a:ObjectID>FCA5B5A4-95D4-487A-B8CF-85B8D4CC6210</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Collaboration Activity must be created under a Binary Collaboration</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = False
      else
         if parent.Stereotype = &quot;BinaryCollaboration&quot; then
            %CanCreate% = True
         else
            %CanCreate% = False
         end if
      end if
   end if
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
<o:EventHandlerTargetItem Id="o236">
<a:ObjectID>F6399237-FAA3-491A-922E-0F51BA4A1A0A</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)
   &#39; Check the object kind
   If obj is Nothing then
      %Initialize% = False
      Exit Function
   End If
   If not obj.IsKindOf(PDBPM.Cls_Process) then
      %Initialize% = False  
      Exit Function
   End If
   
   Dim Impl, Mdl, Fldr,Sel,Shct
   &#39; Retrieve the process implementer and check if it is already correct
   Set Impl = obj.Implementer
   If not Impl is Nothing Then
      If Impl.IsKindOf(PDBPM.Cls_Process) and Impl.Stereotype = &quot;BinaryCollaboration&quot; then
         %Initialize% = True  
         Set Impl = Nothing
         Exit Function
      End If
   End If 
   &#39; Change implementation mode
   obj.ImplementationMode = 2 &#39; this is the &quot;reuse process&quot; value
   %Initialize% = True
   &#39; Exit if non interactive (the case when we change stereotype by property sheet)
   If not InteractiveMode = Im_Dialog Then
     %Initialize% = True  
     Exit Function
   End If
   &#39; Retrieve the model
   Set Mdl = obj.Model
   %Initialize% = False 
   If Not Mdl is Nothing then
      &#39; Retrieve the folder
      Set Fldr = obj.Folder
      If Not Fldr is Nothing then
         &#39; Create a selection object
         Set Sel = Mdl.CreateSelection
         If Not Sel is Nothing then
           %Initialize% = True 
           &#39;Show the object picker dialog for selecting a BT
            Set Impl = Sel.ShowObjectPicker (&quot;Process&quot;, &quot;BinaryCollaboration&quot;, &quot;Select a Binary Collaboration Process&quot;,False)
            &#39; Retrieve the selection
            If not Impl is Nothing Then
               If Impl.IsKindOf(PDBPM.Cls_Process) and Impl.Stereotype = &quot;BinaryCollaboration&quot; then
                  Set Shct = Impl.CreateShortcut (Fldr)
                  If not Shct is Nothing Then
                     obj.Implementer = Shct
                  End If
               End If
             End If
         End If
      End If
      &#39;Clean
      &#39; Free the temporary selection
      Sel.Delete
      Set Mdl = Nothing
      Set Fldr = Nothing
      Set Impl = Nothing
      Set Sel = Nothing
      Set Shct = Nothing
   End If
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o237">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>41421192-9D5E-4B66-BF73-17963508270A</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o238">
<a:ObjectID>15A7DF8C-3352-4F72-A60D-759612E83CE3</a:ObjectID>
<a:Name>bizActivity</a:Name>
<a:TemplateTargetItem.Value>%genericActivity%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o239">
<a:ObjectID>24021FE4-832E-4B58-894C-1A62D14D81AD</a:ObjectID>
<a:Name>implementerProcess</a:Name>
<a:TemplateTargetItem.Value>.if (%Implementer%) and (%Implementer.Stereotype%==BinaryCollaboration)
.if (%GenOptions.useXPaths%)
binaryCollaboration=&quot;//%Implementer.pathName%&quot;[ binaryCollaborationIDRef=&quot;%Implementer.nameID%&quot;]
.else
binaryCollaboration=&quot;%Implementer.removeSuffixFromCode%&quot;[ binaryCollaborationIDRef=&quot;%Implementer.nameID%&quot;]
.endif
.else
.log A Collaboration activity &quot;%Name%&quot; should be implemented by (or use) a binary collaboration
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o240">
<a:ObjectID>411EA951-1E72-448B-A15A-8050F61F584D</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o241">
<a:ObjectID>40ADC451-E625-4DC8-ADBB-9E2D39CF0574</a:ObjectID>
<a:Name>suffix</a:Name>
<a:TemplateTargetItem.Value>_CA_</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o242">
<a:ObjectID>E3229527-E8BF-4B9A-B48F-900948387401</a:ObjectID>
<a:Name>bizProcess</a:Name>
<a:TemplateTargetItem.Value>.//Generates an ebXML CollaborationActivity.
%bizActivity%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o243">
<a:ObjectID>B264038B-2666-4A55-8533-6B503B012749</a:ObjectID>
<a:Name>fromRole</a:Name>
<a:TemplateTargetItem.Value>.//Generates the CollaborationActivity fromAuthorizedRole.
.//This role corresponds to the InitiatingRole of the BinaryCollaboration used by the Activity.
.if (%Implementer%)
fromAuthorizedRole=&quot;%Implementer.searchFromRoles%&quot;[ fromAuthorizedRoleIDRef=&quot;%Implementer.firstAuthorizedRoleIDRef%&quot;]
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o244">
<a:ObjectID>3AC446BE-B2A0-42C1-8097-E70FB3883CEB</a:ObjectID>
<a:Name>toRole</a:Name>
<a:TemplateTargetItem.Value>.//Generates the CollaborationActivity toAuthorizedRole.
.//This role corresponds to the RespondingRole of the BinaryCollaboration used by the Activity.
.if (%Implementer%)
toAuthorizedRole=&quot;%Implementer.searchToRoles%&quot;[ toAuthorizedRoleIDRef=&quot;%Implementer.secondAuthorizedRoleIDRef%&quot;]
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o245">
<a:ObjectID>C5F7AA2B-6E65-4D0F-8B1D-5D3C6C674236</a:ObjectID>
<a:Name>CompositeProcess</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:Abstract>1</a:Abstract>
<c:Categories>
<o:TypedCategoryTargetItem Id="o246">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>CA42B4EC-E55C-484B-9B46-408AD302E31F</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o247">
<a:ObjectID>2C4962C2-3268-4DB4-8B56-74C0B678C64E</a:ObjectID>
<a:Name>Composite process</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the process is composite.</a:HelpMessage>
<a:OutputMessage>The following processes are not composite:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = False
   If (not Obj.IsShortcut()) Then
      If (obj.composite) Then
         %Check% = True
      End If
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o248">
<a:TypePublicName>StereotypeTargetItem</a:TypePublicName>
<a:ObjectID>6B2CB5F9-EC50-4F5B-BF2B-E936F6832200</a:ObjectID>
<a:Name>Stereotypes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:StereotypeTargetItem Id="o249">
<a:ObjectID>523C5848-017D-485F-BA95-E21296927676</a:ObjectID>
<a:Name>MultiPartyCollaboration</a:Name>
<a:Code>MultiPartyCollaboration</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Collaboration process between several business partner roles.</a:Comment>
<a:EnableTool>1</a:EnableTool>
<a:ToolIcon>0D0000000800000008000000424D7E000000000000003E000000280000001000
0000100000000100010000000000400000000000000000000000000000000000
000000000000FFFFFF00FFFF0000FFFF0000FFFF000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
000001FF000083FF0000424DF600000000000000760000002800000010000000
100000000100040000000000800000000000000000000000000000000E000000
0000000000008000200000003F3F9F00400000005F5F9F007F7FBF009F3F3F00
9F9FBF00BF7F7F00BFBFDF00DFBFBF00DFDFDF00FFFFFF000000000000000000
0000000000000000000000000000000000000000000000007999999999999994
9DDDDDDDDDDDDDD49D66DD66D5118DD49D66DD66D1DCADD49D66DD66D1DDDDD4
9D66DD66D1DDDDD49D668866D1DDDDD49D633336D1DCADD49D65DD56D5118DD4
9DDDDDDDDDDDDDD479999999999999942BDDDB20000000000244420000000000
0E0000000F0000000E000000424DBE000000000000003E000000280000002000
0000200000000100010000000000800000000000000000000000000000000000
000000000000FFFFFF00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
FFFF000000010000000100000001000000010000000100000001000000010000
0001000000010000000100000001000000010000000100000001000000010000
00010000000100000001000000010000000100000001000000018007FFFFC00F
FFFFE01FFFFFFFFFFFFF424D7602000000000000760000002800000020000000
2000000001000400000000000002000000000000000000000000000005000000
00000000000080008000000080808000FFFFFF00000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
2222222222222222222222222222222024444444444444444444444444444420
2444444444444444444444444444442024444444444444444444444444444420
2444411444444114444111113444442024444114444441144413111114444420
2444411444444114441144431444442024444114444441144411444444444420
2444411444444114441144444444442024444114444441144411444444444420
2444411444444114441144444444442024444114444441144411444444444420
2444411443344114441144444444442024444114411441144411444444444420
2444411411114114441144444444442024444111144111144411444314444420
2444411144441114441311111444442024444134444443144441111134444420
2444444444444444444444444444442024444444444444444444444444444420
2444444444444444444444444444442022222222222222222222222222222220
0244444444442000000000000000000000244444444200000000000000000000
0002222222200000000000000000000000000000000000000000000000000000
</a:ToolIcon>
<a:UseAsMetaClass>1</a:UseAsMetaClass>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o245"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o250">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>FE94D7A2-3D5C-44DC-9AF4-2F9BA50F9562</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o251">
<a:ObjectID>3A420B11-6FC9-4724-A9CB-3E6B0E50EFBE</a:ObjectID>
<a:Name>Existence of Business Partner Roles</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the MultiParty  Collaboration includes Business Partner Roles.</a:HelpMessage>
<a:OutputMessage>The following MultiParty Collaborations do not include Business Partner Roles:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If obj.ChildExtendedDependencies.Count = 0 Then
      %Check% = False 
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Define roles as organization units and create a flow between them and binary collaborations&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o252">
<a:ObjectID>81269F31-9B53-43BB-A975-C3B508C362BE</a:ObjectID>
<a:Name>Contains only Binary Collaboration sub-processes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the MultiParty Collaboration performs only Binary Collaboration processes.</a:HelpMessage>
<a:OutputMessage>The following MultiParty Collaboration contains invalid processes:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim Assc, InflObj,DepdObj,Depd,BCProcess
   For Each Depd In obj.ChildExtendedDependencies
      If Depd.IsShortcut() Then 
       %Check% = FALSE
      Else
         If Depd.InfluentObject.IsShortcut() Then
            Set InflObj = Depd.InfluentObject.TargetObject
         Else
            Set InflObj = Depd.InfluentObject
         End If

         If Depd.DependentObject.IsShortcut() Then
            Set DepdObj = Depd.DependentObject.TargetObject
         Else
            Set DepdObj = Depd.DependentObject
         End If
      
         If (not InflObj is nothing) Then
            If (InflObj.ObjectType = &quot;OrganizationUnit&quot;) Then
               Set BCProcess = DepdObj
            Else
               Set BCProcess = InflObj
            End If
         End If

         If (not BCProcess is nothing) Then
            If BCprocess.ObjectType = &quot;Process&quot; Then
               If BCprocess.Stereotype &lt;&gt; &quot;BinaryCollaboration&quot; Then
                  %Check% =False 
               End If
            End If
         End If
      End If
   Next
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;The Business partner role Should perform only Binary Collaboration.&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o253">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>6EDC84AC-A35D-4F34-80AC-E8A991F6231B</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o254">
<a:ObjectID>55B8F49F-EB78-4606-AD93-CA53F7FE14FD</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Multi Party Collaboration must be created under the model or a package</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = True
      else
         %CanCreate% = False
      end if
   end if
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
<o:EventHandlerTargetItem Id="o255">
<a:ObjectID>3826A7D7-180F-44D1-A522-F8F0D93F200F</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Multi Party Collaboration is a composite process that owns a graph of Binary Collaborations</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)

   If obj is Nothing then
      %Initialize% = False  
      Exit Function
   End If

   If (obj.Parent.IsKindOf(PDBPM.Cls_Model)) Or (obj.Parent.IsKindOf(PDBPM.Cls_Package)) then
      %Initialize% = True
   else
      %Initialize% = False  
      Exit Function
   End If
   
   %Initialize% = True 

   &#39; Change to composite process
   Dim MultiParty
   Set MultiParty = obj
   Dim oldMultiPartyComposite
   oldMultiPartyComposite = MultiParty.Composite   
   MultiParty.UseParentNameSpace = False
   MultiParty.Composite = True

   &#39; Change display preferences of sub-diagram
   Dim Diag, DispPrefs
   Set Diag = MultiParty.DefaultDiagram
   DispPrefs = Diag.DisplayPreferences
   Diag.DisplayPreferences = Replace(DispPrefs, &quot;Show Swimlane=Yes&quot;, &quot;Show Swimlane=No&quot;)
   
   &#39; Open view if new created
   &#39;If not oldMultiPartyComposite Then
   &#39;   obj.DefaultDiagram.OpenView
   &#39;End If
   
  &#39; Create Free Text
   Dim FreeText
   Set FreeText = Diag.CreateObject(PdCommon.Cls_TextSymbol,&quot;Symbols&quot;)
   FreeText.Text = &quot;&lt;&lt;you can only use shortcut of binary collaboration here&gt;&gt;&quot;
   FreeText.rect.top = FreeText.rect.top + 1000
   FreeText.rect.bottom = FreeText.rect.bottom - 1000
   FreeText.rect.left = FreeText.rect.left - 12000
   FreeText.rect.right = FreeText.rect.right + 12000   
   
   Dim symMPC
   Set symMPC = MultiParty.Symbols.Item(0)
   If (not symMPC is Nothing) Then
      symMPC.autoAdjustToText = False
      symMPC.rect.Top = symMPC.rect.Top + 5000
      symMPC.rect.bottom = symMPC.rect.bottom - 5000
      symMPC.rect.Left = symMPC.rect.Left - 6000
      symMPC.rect.Right = symMPC.rect.Right + 6000
      symMPC.CompositeView = TRUE
   End If      
   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o256">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>47FFE4CE-ED39-42C5-85F1-319569083A2A</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o257">
<a:ObjectID>FBBD822F-38BB-47FF-820B-5B27C1F26966</a:ObjectID>
<a:Name>suffix</a:Name>
<a:TemplateTargetItem.Value>_MPC_</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o258">
<a:ObjectID>2E3558EB-1A1D-4CA1-9BC9-379E27C1AE38</a:ObjectID>
<a:Name>bizProcess</a:Name>
<a:TemplateTargetItem.Value>.//Generates a MultiPartyCollaboration.
%processHeader%
[   %documentation%\n]\
[   %browseBinaryCollaborations%\n]\
%processFooter%
.foreach_item(Processes,,\n)
   .ifnot (%model% == %ActiveModel.Code%)
      .if (%Stereotype%==&quot;BinaryCollaboration&quot;)
%bizProcess%
      .endif
   .endif
.next(\n)
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o259">
<a:ObjectID>30296444-FCD2-4943-A515-A96D2922E2BB</a:ObjectID>
<a:Name>AbstractProcess</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:Abstract>1</a:Abstract>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o245"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o260">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>A9260D71-61A0-4A22-972C-788E962C8B44</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o261">
<a:ObjectID>8FB05A0C-697D-41B0-903D-EC19483869DA</a:ObjectID>
<a:Name>beginsWhen</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A description of an event external to the collaboration/transaction that normally causes this collaboration/transaction to begin.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o262">
<a:ObjectID>49B63473-F245-4C1C-94A1-E91845FFEB08</a:ObjectID>
<a:Name>endsWhen</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A description of an event external to this collaboration/transaction that normally causes this collaboration/transaction to conclude.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o263">
<a:ObjectID>54B986C2-6188-492A-BC6D-E4C995E42E18</a:ObjectID>
<a:Name>pattern</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The optional name of the pattern that this binary collaboration is based on.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o264">
<a:ObjectID>A431D8AD-8BFB-49DE-AE9B-AB61DE74C0D2</a:ObjectID>
<a:Name>postConditions</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A description of a state that does not exist before the execution of this collaboration/transaction but will exist as a result of the execution of this collaboration/transaction.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o265">
<a:ObjectID>F75AEA0E-18CE-4955-8FEB-638D8A6B5F9E</a:ObjectID>
<a:Name>preConditions</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A description of a state external to this collaboration/transaction that is required before this collaboration/transaction to conclude.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o266">
<a:TypePublicName>StereotypeTargetItem</a:TypePublicName>
<a:ObjectID>341196B6-B050-4262-9980-A010D0ED9EBF</a:ObjectID>
<a:Name>Stereotypes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:StereotypeTargetItem Id="o267">
<a:ObjectID>C48E5A59-5AC5-4720-8F27-8E2904977D51</a:ObjectID>
<a:Name>BinaryCollaboration</a:Name>
<a:Code>BinaryCollaboration</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Collaboration process between two roles.</a:Comment>
<a:EnableTool>1</a:EnableTool>
<a:ToolIcon>0D0000000800000008000000424D7E000000000000003E000000280000001000
0000100000000100010000000000400000000000000000000000000000000000
000000000000FFFFFF00FFFF0000FFFF0000FFFF0000C0030000800100000000
000000000000000000000000000000000000000000000000000080010000C003
0000FFFF0000FFFF0000424DF600000000000000760000002800000010000000
100000000100040000000000800000000000000000000000000000000D000000
000000000000800020208000400000005F5F9F007F3F3F007F7FBF009F3F3F00
9F9FBF00BF7F7F00BFBFDF00DFDFDF00FFFFFF00000000000000000000000000
0000000000000000000000000000000000000000000000000039999999999300
07CCCCCCCCCCCC503CCC112AC4118CC39CCC1C66C1CBACC99CCC1C66C1CCCCC9
9CCC111AC1CCCCC99CCC1C66C1CCCCC99CCC1C66C1CBACC93CCC112AC4118CC3
07CCCCCCCCCCCC50003999999999930000000000000000000000000000000000
0E000000100000000F000000424DBE000000000000003E000000280000002000
0000200000000100010000000000800000000000000000000000000000000000
000000000000FFFFFF00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
FFFFFC00003FF000000FE0000007C00000038000000180000001000000000000
0000000000000000000000000000000000000000000000000000000000000000
00008000000180000001C0000003E0000007F000000FFC00003FFFFFFFFFFFFF
FFFFFFFFFFFFFFFFFFFF424D7602000000000000760000002800000020000000
2000000001000400000000000002000000000000000000000000000005000000
00000000000080008000000080808000FFFFFF00000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000002222222222222222222200000000002244444444444444444444220000
0022444444444444444444444444200000244444444444444444444444444200
0244444411111144444111113444442002444444111113144413111114444420
2444444411444114441144431444444224444444114441144411444444444442
2444444411444114441144444444444224444444114441144411444444444442
2444444411111114441144444444444224444444111111444411444444444442
2444444411444114441144444444444224444444114441144411444444444442
2444444411444114441144444444444224444444114441144411444314444442
0244444411111314441311111444442002444444111111444441111134444420
0024444444444444444444444444420000224444444444444444444444442000
0000224444444444444444444422000000000022222222222222222222000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
</a:ToolIcon>
<a:UseAsMetaClass>1</a:UseAsMetaClass>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o259"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o268">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>386C4319-4E43-48FF-BADD-83E55E8867B4</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o269">
<a:ObjectID>D3CAA1A3-3EF7-459E-94AC-838335124E44</a:ObjectID>
<a:Name>Invalid Authorized Roles stereotypes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the role associations defining the Initiating and Responding Roles do not use the BusinessPartnerRole stereotype that is reserved for Multi Party Collaborations.</a:HelpMessage>
<a:OutputMessage>The following Binary Collaborations do not have valid Authorized Roles:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim Assc
   For Each Assc In obj.InitiatingRoleAssociations
      If not Assc.IsShortcut() Then 
         If (Assc.Source.ObjectType = &quot;OrganizationUnit&quot;) And (Assc.Parent Is obj.Parent) Then
            Select Case Assc.Source.Stereotype
               Case &quot;BusinessPartnerRole&quot;
                  %Check% = False
                  Exit For
            End Select
         End If
      End If
   Next

   For Each Assc In obj.RespondingRoleAssociations
      If not Assc.IsShortcut() Then 
         If (Assc.Destination.ObjectType = &quot;OrganizationUnit&quot;) And (Assc.Parent Is obj.Parent) Then
            Select Case Assc.Destination.Stereotype
               Case &quot;BusinessPartnerRole&quot;
                  %Check% = False
                  Exit For
            End Select
         End If
      End If
   Next
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o270">
<a:ObjectID>2EDB3494-6B7E-44FB-BDE7-453765894E8D</a:ObjectID>
<a:Name>Existence of the Initiating Role</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Binary Collaboration has an Initiating Role.
The Initiating Role is defined using a Role Association from an Organization Unit to this Binary Collaboration.</a:HelpMessage>
<a:OutputMessage>The following Binary Collaborations do not have an Initiating Role:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If obj.InitiatingRoleAssociations.Count = 0 Then
      %Check% = False
   else
     Dim Assc
     %Check% = False    
     For each Assc in obj.InitiatingRoleAssociations
      if Assc.Destination Is obj Then
        %Check% = True
      End If
     Next 
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o271">
<a:ObjectID>D84D7964-1FD1-4DC1-9627-1C408F454935</a:ObjectID>
<a:Name>Existence of the Responding Role</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Binary Collaboration has a Responding Role.
The Responding Role is defined using a Role Association from this Binary Collaboration to an Organization Unit.</a:HelpMessage>
<a:OutputMessage>The following Binary Collaborations do not have a Responding Role:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If obj.RespondingRoleAssociations.Count = 0 Then
      %Check% = False
   else
     Dim Assc
     %Check% = False    
     For each Assc in obj.RespondingRoleAssociations
      if Assc.Source Is obj Then
        %Check% = True
      End If
     Next 
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o272">
<a:ObjectID>E55C3076-886D-421D-BD4B-E008F1115552</a:ObjectID>
<a:Name>Uniqueness of the Initiating Role</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Binary Collaboration do not have several Initiating Roles.
The existing Initiating Roles can be checked using the Dependencies property page on the Process.
All Organization Units appearing in the &#39;Initiating role associations&#39; sub-list are considered as Initiating Roles.</a:HelpMessage>
<a:OutputMessage>The following Binary Collaborations have more than one Initiating Roles:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim nInitRoles
   nInitRoles = 0
   Dim Assc
   For Each Assc In obj.InitiatingRoleAssociations
      If not Assc.IsShortcut() Then 
         If (Assc.Source.ObjectType = &quot;OrganizationUnit&quot;) And (Assc.Parent Is obj.Parent) Then
            nInitRoles = nInitRoles + 1
         End If
      End If
   Next
   If nInitRoles &gt; 1 Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o273">
<a:ObjectID>8EFF4051-F606-4CD9-9A3B-C810E37C425A</a:ObjectID>
<a:Name>Uniqueness of the Responding Role</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Binary Collaboration do not have several Responding Roles.
The existing Responding Roles can be checked using the the Dependencies property page on the Process.
All Organization Units appearing in the &#39;Responding role associations&#39; sub-list are considered as Initiating Roles.</a:HelpMessage>
<a:OutputMessage>The following Binary Collaborations have more than one Responding Roles:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim nRespRoles
   nRespRoles = 0
   Dim Assc
   For Each Assc In obj.RespondingRoleAssociations
      If not Assc.IsShortcut() Then 
         If (Assc.Destination.ObjectType = &quot;OrganizationUnit&quot;) And (Assc.Parent Is obj.Parent) Then
            nRespRoles = nRespRoles + 1
         End If
      End If
   Next
   If nRespRoles &gt; 1 Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o274">
<a:ObjectID>3AFFBA31-7123-47B2-B464-9137B1D36CE6</a:ObjectID>
<a:Name>Coherence between Initiating and Responding Roles</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Initiating Role of the Binary Collaboration is different from the Responding Role.</a:HelpMessage>
<a:OutputMessage>The following Binary Collaborations do not have different Initiating and Responding Roles:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim InitRole
   InitRole = &quot;&quot;
   Dim RespRole
   RespRole = &quot;&quot;
   Dim Assc
   For Each Assc In obj.InitiatingRoleAssociations
      If not Assc.IsShortcut() Then 
         If (Assc.Source.ObjectType = &quot;OrganizationUnit&quot;) And (Assc.Parent Is obj.Parent) Then
            if (Assc.Source.Stereotype &lt;&gt; &quot;BusinessPartnerRole&quot;) Then
               If InitRole = &quot;&quot; Then
                  InitRole = Assc.Source.Name
               End If
               Exit For
            End If            
         End If
      End If
   Next
   
   For Each Assc In obj.RespondingRoleAssociations
      If not Assc.IsShortcut() Then 
         If (Assc.Destination.ObjectType = &quot;OrganizationUnit&quot;) And (Assc.Parent Is obj.Parent) Then
            If (Assc.Destination.Stereotype &lt;&gt; &quot;BusinessPartnerRole&quot;) Then
               If RespRole = &quot;&quot; Then
                  RespRole = Assc.Destination.Name
               End If
               Exit For
            End If
         End If
      End If
   Next
   if (InitRole = RespRole) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o275">
<a:ObjectID>EB756EAA-F684-4FD4-9B0E-1E6A7913A69E</a:ObjectID>
<a:Name>Should contains only activity processes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the processes within the Binary Collaboration are Business Transaction Activities or Collaboration Activities.</a:HelpMessage>
<a:OutputMessage>The following Binary Collaborations contains non-activity processes:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If obj.Children.Count &gt; 0 Then
      Dim elt
      For Each elt In obj.Children
         If elt.IsKindOf(PdBPM.cls_Process) Then
            If (elt.Stereotype &lt;&gt; &quot;BusinessTransactionActivity&quot;) And (elt.Stereotype &lt;&gt; &quot;CollaborationActivity&quot;) Then
               If elt.OutputFlows.Count &gt; 0 Or elt.InputFlows.Count &gt; 0 Then
                  %Check% = False
                  Exit For
               End If
            End If
         End If
      Next
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o276">
<a:ObjectID>16284793-35B8-4AA9-8BB3-2689333F6F8A</a:ObjectID>
<a:Name>Unsupported Decision objects</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Binary Collaboration does not contain Decisions.</a:HelpMessage>
<a:OutputMessage>The following Binary Collaborations contain Decisions:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If obj.Children.Count &gt; 0 Then
      Dim elt
      For Each elt In obj.Children
         If (elt.IsKindOf(PdBPM.cls_Decision)) Then
            If elt.OutputFlows.Count &gt; 0 Or elt.InputFlows.Count &gt; 0 Then
               %Check% = False
               Exit For
            End If
         End If
      Next
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o277">
<a:ObjectID>EB362C1D-4482-493D-84BF-C56DB76C8F6F</a:ObjectID>
<a:Name>Existence of the end objects</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the choreography has at least one End.</a:HelpMessage>
<a:OutputMessage>The following Binary Collaborations do not contain End:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.ProcessEnds.Count = 0) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o278">
<a:ObjectID>2BFCE1AD-D1D3-462D-9B47-E8928D386DB5</a:ObjectID>
<a:Name>Existence and uniqueness of the Start object</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the choreography contains one and only one Start object.</a:HelpMessage>
<a:OutputMessage>The following Binary Collaborations do not contain one and only one Start object:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.ProcessStarts.Count = 0 Or obj.ProcessStarts.Count &gt; 1) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o279">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>EB3A1F62-6DE5-4B8D-89B0-2B1C7DB01B49</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o280">
<a:ObjectID>3DFD917F-5D96-451E-B01F-CC749ECA89C0</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Binary Collaboration is a composite process that owns a graph of activities</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)
   If obj is Nothing then
      %Initialize% = False  
      Exit Function
   End If

   If (obj.Parent.IsKindOf(PDBPM.Cls_Model)) Or (obj.Parent.IsKindOf(PDBPM.Cls_Package)) then
      %Initialize% = True
   else
      %Initialize% = False  
      Exit Function
   End If

   Dim BinCol
   Set BinCol = obj
   %Initialize% = True 
   
   &#39; Retrieve the current diagram
   Dim Mdl, diag,Folder,osym
   Set Mdl = obj.Model
   Set Folder = obj.Parent

   Set diag = Nothing
   Set osym = nothing
   Set diag = ActiveDiagram
   
   if diag.ClassKind &lt;&gt; PDBPM.CLS_BusinessProcessDiagram Then
      Set diag = Nothing
   end if
   
   if (Not diag is nothing) then
      if diag.ClassKind = PDBPM.CLS_BusinessProcessDiagram Then
         Set osym = diag.FindSymbol(obj)
      end if
   End If
   if (osym is nothing) then
      for each osym in obj.Symbols
         Set diag = osym.Diagram
         if diag.ClassKind = PDBPM.CLS_BusinessProcessDiagram then
            Exit For
         else
            Set diag = Nothing
         end if
      next
   End If
   
   If not diag is Nothing Then
      if diag.Parent &lt;&gt; Folder then
         Set diag = Nothing
      end if
   End if

   &#39; Change display preferences
   Dim DispPrefs
   If not diag is Nothing then
      DispPrefs = Diag.DisplayPreferences
      Diag.DisplayPreferences = Replace(DispPrefs, &quot;Show Swimlane=Yes&quot;, &quot;Show Swimlane=No&quot;)
      If (Not Folder.IsKindOf(PdBPM.cls_Model)) Then
         If Folder.Stereotype = &quot;BusinessTransaction&quot; Or Folder.Stereotype = &quot;BinaryCollaboration&quot; Or Folder.Stereotype = &quot;MultiPartyCollaboration&quot; Then
            Exit Function
         End If
      End If
   End if

   &#39; Create two roles
   Dim orgn, ReqRole, RepRole
   orgn = &quot;InitiatingRole&quot;
   Set ReqRole = ExistOrganizationUnit(Mdl, orgn)
   orgn = &quot;RespondingRole&quot;
   Set RepRole = ExistOrganizationUnit(Mdl, orgn)

   &#39; Change to composite process
   BinCol.UseParentNameSpace = False
   BinCol.Composite = True

   &#39; Create initiating role association
   Dim InitRole
   Set InitRole = Folder.RoleAssociations.CreateNew
   InitRole.Source = ReqRole
   InitRole.Destination = BinCol

   &#39; Create responding role association
   Dim RespRole
   Set RespRole = Folder.RoleAssociations.CreateNew
   RespRole.Source = BinCol
   RespRole.Destination = RepRole

   &#39; Display symbols in current diagram
   
   If not diag is Nothing then
      Dim symBC,symReq,symRep,symRoas
      Set symBC = BinCol.Symbols.Item(0)
      If not symBC is Nothing Then
         Set symReq = diag.AttachObject(ReqRole)
         symReq.Position.x = symBC.rect.Left - 10000
         symReq.Position.y = symBC.Position.y
         Set symRep = diag.AttachObject(RepRole)
         symRep.Position.x = symBC.rect.Right + 10000
         symRep.Position.y = symBC.Position.y

         Set symRoas = diag.AttachLinkObject(InitRole)
         Set symRoas = diag.AttachLinkObject(RespRole)
      End If
   End if


   &#39; Change display preferences of sub-diagram
   Set Diag = BinCol.DefaultDiagram
   DispPrefs = Diag.DisplayPreferences
   Diag.DisplayPreferences = Replace(DispPrefs, &quot;Show Swimlane=Yes&quot;, &quot;Show Swimlane=No&quot;)
   
   if BinCol.Children.Count = 0 then
      &#39; Create a default activity.
      Dim BizTrnsActv, reqsym
      Set BizTrnsActv = BinCol.Processes.CreateNew &#39;Create a BusinessTransaction Activity.
      BizTrnsActv.Stereotype = &quot;BusinessTransactionActivity&quot;
      BizTrnsActv.Name = &quot;BusinessTransactionActivity1&quot;
      BizTrnsActv.OrganizationUnit = ReqRole
      Set reqsym = diag.AttachObject(BizTrnsActv)
      reqsym.Position.x = 0
      reqsym.Position.y = 0

      &#39; Create a start object.
      Dim Start, StrtSym
      Set Start = BinCol.ProcessStarts.CreateNew 
      Start.Name = &quot;start&quot;
      Set StrtSym = diag.AttachObject(Start)
      StrtSym.Position.x = reqsym.Position.x
      StrtSym.Position.y = reqsym.Position.y + 5000

      &#39;Create a flow between Start and RequestingActivity.
      Dim StartFlow, sym
      Set StartFlow = BinCol.Flows.CreateNew   
      StartFlow.Name = &quot;StartFlow&quot;
      StartFlow.Source = Start
      StartFlow.Destination = BizTrnsActv
      Set sym = diag.AttachLinkObject(StartFlow)

      &#39;Create a success End state.
      Dim Success, SuccSym
      Set Success = BinCol.ProcessEnds.CreateNew 
      Success.Name = &quot;Success&quot;
      Set SuccSym = diag.AttachObject(Success)
      SuccSym.Position.x = reqsym.rect.Left
      SuccSym.Position.y = reqsym.rect.bottom - 5000

      &#39;Create a Failure End state.
      Dim Failure, BFailSym
      Set Failure = BinCol.ProcessEnds.CreateNew 
      Failure.Name = &quot;Failure&quot;
      Failure.EndType = &quot;Business Error&quot;
      Set BFailSym = diag.AttachObject(Failure)
      BFailSym.Position.x = reqsym.rect.Right
      BFailSym.Position.y = reqsym.rect.bottom - 5000

      &#39;Create a flow between RequestingActivity and End.
      Dim SuccessFlow
      Set SuccessFlow = BinCol.Flows.CreateNew   
      SuccessFlow.Name = &quot;Success&quot;
      SuccessFlow.Source = BizTrnsActv
      SuccessFlow.Destination = Success
      SuccessFlow.FlowType = &quot;Success&quot;
      Set sym = diag.AttachLinkObject(SuccessFlow)

      &#39;Create a flow between RequestingActivity and End.
      Dim FailureFlow
      Set FailureFlow = BinCol.Flows.CreateNew   
      FailureFlow.Name = &quot;BusinessFailure&quot;
      FailureFlow.Source = BizTrnsActv
      FailureFlow.Destination = Failure
      FailureFlow.FlowType = &quot;Business Error&quot;
      Set sym = diag.AttachLinkObject(FailureFlow)
      sym.SourceTextOffSet.x = -1500
      sym.SourceTextOffSet.y = -1000

      &#39; Initialize code of sub-objects        
      Call PutCodeLikeName(BinCol)
      Call PutFlowCodeLikeName(BinCol)
 
      Diag.Flags = 1   
   
   end if

   Dim symBinCol
   Set symBinCol = BinCol.Symbols.Item(0)
   If (not symBinCol is Nothing) Then
      symBinCol.autoAdjustToText = False
      symBinCol.rect.Top = symBinCol.rect.Top + 8000
      symBinCol.rect.bottom = symBinCol.rect.bottom - 8000
      symBinCol.rect.Left = symBinCol.rect.Left - 8000
      symBinCol.rect.Right = symBinCol.rect.Right + 8000
      symBinCol.CompositeView = TRUE      
   End If
   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
<o:EventHandlerTargetItem Id="o281">
<a:ObjectID>A96796C0-0E07-4F5E-8E2B-4B4A926B1A24</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Binary Collaboration must be created under the model or a package</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = True
      else
         %CanCreate% = False
      end if
   end if   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o282">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>83734B08-19FA-4316-B316-6BC532E6E028</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o283">
<a:ObjectID>EEBD3BDD-F13D-4C19-98C5-8C6E0792E7B9</a:ObjectID>
<a:Name>authorizedRoles</a:Name>
<a:TemplateTargetItem.Value>.//Generates InitiatingRole and RespondingRole on BinaryCollaboration
[%initiatingRoleBC%\n]\
[%respondingRoleBC%\n]</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o284">
<a:ObjectID>51B73659-D7BC-45A5-802C-6F0E7FFE09D7</a:ObjectID>
<a:Name>fromAuthorizedRole</a:Name>
<a:TemplateTargetItem.Value>%firstAuthorizedRole%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o285">
<a:ObjectID>2F08B6D3-B45D-4D7A-A132-AB221FC04F21</a:ObjectID>
<a:Name>searchFromRoles</a:Name>
<a:TemplateTargetItem.Value>%fromAuthorizedRole%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o286">
<a:ObjectID>5A27DECF-95C1-484A-AF9E-742DEE46D4F8</a:ObjectID>
<a:Name>searchToRoles</a:Name>
<a:TemplateTargetItem.Value>%toAuthorizedRole%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o287">
<a:ObjectID>5B1758F2-56B9-4C4A-BB87-6290172777B0</a:ObjectID>
<a:Name>toAuthorizedRole</a:Name>
<a:TemplateTargetItem.Value>%secondAuthorizedRole%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o288">
<a:ObjectID>93B08F8D-EC74-42F2-8090-F74D035A9D35</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>[beginsWhen=&quot;%.X:beginsWhen%&quot;\n]
[endsWhen=&quot;%.X:endsWhen%&quot;\n]
[preConditions=&quot;%.X:preConditions%&quot;\n]
[postConditions=&quot;%.X:postConditions%&quot;\n]
[pattern=&quot;%.X:pattern%&quot;\n]
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o289">
<a:ObjectID>8228FE44-523A-4225-82FD-DBB0DA5775E6</a:ObjectID>
<a:Name>suffix</a:Name>
<a:TemplateTargetItem.Value>_BC_</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o290">
<a:ObjectID>3B0A7F68-63EB-4897-AC3F-341600D54237</a:ObjectID>
<a:Name>bizStarts</a:Name>
<a:TemplateTargetItem.Value>.//Generates the Start of the binary collaboration.
.foreach_item(ProcessStarts)
%start%
.next(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o291">
<a:ObjectID>17483A87-6151-411B-AE7A-C96A469F6E63</a:ObjectID>
<a:Name>bizProcess</a:Name>
<a:TemplateTargetItem.Value>.// produces the code of the Binary Collaboration: attributes and choreography
%processHeader%
[   %documentation%\n]\
[   %authorizedRoles%\n]\
[   %browseActivities%\n]\
[   %splits%\n]\
[   %joins%\n]\
[   %bizStarts%\n]\
[   %bizTransition%\n]\
%processFooter%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o292">
<a:ObjectID>B8EA00B7-A344-4432-8070-4BB5EEB2439F</a:ObjectID>
<a:Name>bizTransition</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Flows,,\n)
%bizFlows%
.next(\n)
%forkFlows%
%outForkFlows%
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o293">
<a:ObjectID>E4598835-B256-41C6-9037-FD6D88D1D2E5</a:ObjectID>
<a:Name>firstAuthorizedRoleIDRef</a:Name>
<a:TemplateTargetItem.Value>.//returns the first extended influence on the Process&lt;&lt;BinaryCollaboration&gt;&gt;. The InfluentObject must be an OrganizationUnit
.set_value(bAuthRole,true, new)
.foreach_item(InitiatingRoleAssociations,,,%bAuthRole%)
.if (%Source.ObjectType%==OrganizationUnit) And (%Parent.ObjectType% != Process)
%Source.nameID%
.set_value(bAuthRole,false)
.endif
.next()
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o294">
<a:ObjectID>B7DDCDBE-5408-4004-9EDF-27A7E3ED6F97</a:ObjectID>
<a:Name>secondAuthorizedRoleIDRef</a:Name>
<a:TemplateTargetItem.Value>.//returns the first extended dependency on the Process&lt;&lt;BinaryCollaboration&gt;&gt;. The InfluentObject must be an OrganizationUnit.
.set_value(bAuthRole,true, new)
.foreach_item(RespondingRoleAssociations,,,%bAuthRole%)
   .if (%Destination.ObjectType%==OrganizationUnit) And (%Parent.ObjectType% != Process)
%Destination.nameID%
.set_value(bAuthRole,false)
   .endif
.next()

</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o295">
<a:ObjectID>F045A48F-7B39-4834-BBE2-1E8C0B637615</a:ObjectID>
<a:Name>canCreateFlow</a:Name>
<a:TemplateTargetItem.Value>true</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o296">
<a:ObjectID>8C1B6AD4-47D9-443B-B8B6-5287FA1F3E9A</a:ObjectID>
<a:Name>BusinessTransaction</a:Name>
<a:Code>BusinessTransaction</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>atomic business process transaction between two roles.</a:Comment>
<a:ToolIcon>0D0000000800000008000000424D7E000000000000003E000000280000001000
0000100000000100010000000000400000000000000000000000000000000000
000000000000FFFFFF00FFFF0000FFFF0000E007000080010000000000000000
000000000000000000000000000000000000000000000000000080010000E007
0000FFFF0000FFFF0000424DF600000000000000760000002800000010000000
100000000100040000000000800000000000000000000000000000000F000000
000000000000800020000000202080003F3F9F00400000005F5F9F007F3F3F00
7F7FBF009F9FBF00BF7F7F00BFBFDF00DFBFBF00DFDFDF00FFFFFF0000000000
00000000000000000000000000000000000555555555500005AEEEEEEEEEEA20
2CEB88BEEE8EEEC27EE8483EEE1EEEE7AEE88E1EEE1EEEEAAEE8481EEE1EEEEA
AEE8484EEE1EEEEAAEE88E1EEE1EEEEA7EE8483E96169EE72CEB88BED888DEC2
02AEEEEEEEEEEA20000555555555500000000000000000000000000000000000
0E0000001000000010000000424DBE000000000000003E000000280000002000
0000200000000100010000000000800000000000000000000000000000000000
000000000000FFFFFF00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC00
003FF000000FE0000007C0000003800000018000000100000000000000000000
0000000000000000000000000000000000000000000000000000000000008000
000180000001C0000003E0000007F000000FFC00003FFFFFFFFFFFFFFFFFFFFF
FFFFFFFFFFFFFFFFFFFF424D7602000000000000760000002800000020000000
2000000001000400000000000002000000000000000000000000000005000000
00000000000080008000000080808000FFFFFF00000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000022222222222222222222000000
0000224444444444444444444422000000224444444444444444444444442000
0024444444444444444444444444420002444441111114444444114444444420
0244444111113144444411444444442024444441144411444444114444444442
2444444114441144444411444444444224444441144411444444114444444442
2444444114441144444411444444444224444441111111444444114444444442
2444444111111444444411444444444224444441144411444444114444444442
2444444114441144444411444444444224444441144411444444114444444442
2444444114441144433411433444444202444441111131444111111114444420
0244444111111444431111113444442000244444444444444444444444444200
0002444444444444444444444444200000002244444444444444444444220000
0000002222222222222222222200000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
</a:ToolIcon>
<a:UseAsMetaClass>1</a:UseAsMetaClass>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o259"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o297">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>E693C12E-F441-4B67-BC31-4B7CD9C837F9</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o298">
<a:ObjectID>3153A6F9-F9EC-40DB-A2D3-15D1D16414FC</a:ObjectID>
<a:Name>isGuaranteedDeliveryRequired</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Both partners must agree to use a transport that guarantees delivery.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o299">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>BA31C956-3E3C-4610-830D-C837132A7DD7</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o300">
<a:ObjectID>3D340FC8-B70A-48C0-9E1E-2B7AFE81D356</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Business Transaction must be created under the model or a package</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = True
      else
         %CanCreate% = False
      end if
   end if   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o301">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>475E78C9-EEE2-4010-B2E3-FBEB792EF10A</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o302">
<a:ObjectID>001FC163-7452-43AC-9CBB-53FC7D593B47</a:ObjectID>
<a:Name>Composite process</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Business Transaction is composite.</a:HelpMessage>
<a:OutputMessage>The following Business Transactions are not composite:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = False
   If (obj.composite) Then
      %Check% = True
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o303">
<a:ObjectID>8861B7EE-C2F2-430E-980D-A98AF6E2F866</a:ObjectID>
<a:Name>Existence of exactly two Business Actions</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that a business transaction contains only two business actions:Requesting and Responding activities</a:HelpMessage>
<a:OutputMessage>The following Business Transactions have invalid sub-processes:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If obj.processes.Count &gt; 2 Then
      %Check% = False
      Exit Function
   End If
   Dim ba
   Dim nbReq, nbRep   
   For Each ba In obj.processes   &#39;Checks all the business actions of the business transaction (process)
      If ba.IsKindOf(PdBPM.cls_Process) Then
         Select Case ba.Stereotype
            Case &quot;RequestingBusinessActivity&quot;
               nbReq = nbReq + 1
            Case &quot;RespondingBusinessActivity&quot;
               nbRep = nbRep + 1
            Case Else
               nbReq = 100
          End Select
      End If
   Next
   If (nbReq &gt; 1 Or nbRep &gt; 1 Or nbReq = 0 Or nbRep = 0) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;The business transaction &quot; + obj.Name + &quot; must contain at least one RequestingBusinessActivity and one RespondingBusinessActivity.&quot;
   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o304">
<a:ObjectID>7DA2A90D-4FA5-47DC-88EC-CC2E10741563</a:ObjectID>
<a:Name>Existence and uniqueness of the Start object</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Business Transaction contains one and only one start.</a:HelpMessage>
<a:OutputMessage>The following Business Transactions do not contain one and only one start :</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.ProcessStarts.Count = 0 Or obj.ProcessStarts.Count &gt; 1) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o305">
<a:ObjectID>F4671720-7A8F-4A85-B9B4-94526ECF4333</a:ObjectID>
<a:Name>Existence of the end objects</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Business Transaction contains at least one End.</a:HelpMessage>
<a:OutputMessage>The following Business Transactions do not contain Ends:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.ProcessStarts.Count = 0 Or obj.ProcessStarts.Count &gt; 1) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o306">
<a:ObjectID>50B81D55-65B2-4E74-B3F5-8040FD3BB365</a:ObjectID>
<a:Name>Unsupported Decision or Synchronization objects</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Business Transaction does not contain invalid elements such as Synchronization or Decision.</a:HelpMessage>
<a:OutputMessage>The following Business Transactions contain Decisions or Synchronizations:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
      If obj.BpmSynchronizations.Count &gt; 0 Or obj.ProcessDecisions.Count &gt; 0 Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o307">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>3E8804A1-93F8-4107-9A13-7E61C8F1541B</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o308">
<a:ObjectID>F6191B4A-4059-4E1E-86AA-1FF9D3F88AAF</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>.if (%isGuaranteedDeliveryRequired% == true)
isGuaranteedDeliveryRequired=&quot;false&quot;
.endif(\n)
[beginsWhen=&quot;%.X:beginsWhen%&quot;\n]
[endsWhen=&quot;%.X:endsWhen%&quot;\n]
[preConditions=&quot;%.X:preConditions%&quot;\n]
[postConditions=&quot;%.X:postConditions%&quot;\n]</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o309">
<a:ObjectID>4BFD62AE-D2CD-4CE3-BAA4-0D533227C7D8</a:ObjectID>
<a:Name>removeSuffixFromCode</a:Name>
<a:TemplateTargetItem.Value>%.X:Code%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o310">
<a:ObjectID>40D8E0FE-DE5C-4355-B2C9-A9828DCD3E68</a:ObjectID>
<a:Name>bizProcess</a:Name>
<a:TemplateTargetItem.Value>.//Generates BusinessTransaction element: Attributes and the two Business Actions
%processHeader%
[   %documentation%\n]\
[   %browseReqRepActivities%\n]\
%processFooter%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o311">
<a:ObjectID>4BA64775-3776-4847-8714-98A87EA32AEB</a:ObjectID>
<a:Name>canCreateFlow</a:Name>
<a:TemplateTargetItem.Value>true</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o312">
<a:TypePublicName>StereotypeTargetItem</a:TypePublicName>
<a:ObjectID>9293C2D3-76F9-45E5-9A6D-EBA873D5986D</a:ObjectID>
<a:Name>Stereotypes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:StereotypeTargetItem Id="o313">
<a:ObjectID>1B166CF8-8AB4-48CD-AC35-CED863D56441</a:ObjectID>
<a:Name>BusinessTransaction1</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Atomic business process transaction between two roles.
This transaction contains only a request without response.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:EnableTool>1</a:EnableTool>
<a:ToolIcon>0D0000000800000008000000424D7E000000000000003E000000280000001000
0000100000000100010000000000400000000000000000000000000000000000
000000000000FFFFFF00FFF30000E0010000E0000000FFF30000FFFF0000C003
0000800100000000000000000000000000000000000000000000000000000000
000080010000C0030000424D3605000000000000360400002800000010000000
1000000001000800000000000001000000000000000000000000000012000000
000000000000800020000000202020003F3F9F0040000000402020005F5F9F00
60000000602020007F3F3F007F7FBF009F3F3F009F9FBF00BF7F7F00DFBFBF00
DFDFDF00FFFFFF00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000006020000000000050505050505050505080E0200
0000000C0E0E0E0E0E0E0E0E0E0F0A03000000000000000000000000090A0000
000000000000000000000000000000000000050E0E0E0E0E0E0E0E0E0E050000
000C1111111111111111111111110A000511110B010107111111011111111105
0E11110B0B110111111101111111110E0E11110B0B110111111101111111110E
0E11110B01010411111101111111110E0E11110B0B110111111101111111110E
0E11110B0B110111101001101011110E0511110B010107110D0101010D111105
000A1111111111111111111111110A000000050E0E0E0E0E0E0E0E0E0E050000
0E000000100000000A000000424DBE000000000000003E000000280000002000
0000200000000100010000000000800000000000000000000000000000000000
000000000000FFFFFF00FFFFFFFFFFFFFF1FFFFFFF8FFC000007FC000001FC00
0007FFFFFF8FFFFFFF1FFFFFFFFFFFFFFFFFFC00003FF000000FE0000007C000
0003800000018000000100000000000000000000000000000000000000000000
0000000000000000000000000000000000008000000180000001C0000003E000
0007F000000FFC00003F424D7602000000000000760000002800000020000000
2000000001000400000000000002000000000000000000000000000005000000
00000000000080008000000080808000FFFFFF00000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000032200000
0000000000000000000000000242000000000022222222222222222222242000
0000002444444444444444444444423000000022222222222222222222242000
0000000000000000000000000242000000000000000000000000000032200000
0000000000000000000000000000000000000000000000000000000000000000
0000002222222222222222222200000000002244444444444444444444220000
0022444444444444444444444444200000244444444444444444444444444200
0244444111111444444411444444442002444441111131444444114444444420
2444444114441144444411444444444224444441144411444444114444444442
2444444114441144444411444444444224444441144411444444114444444442
2444444111111144444411444444444224444441111114444444114444444442
2444444114441144444411444444444224444441144411444444114444444442
2444444114441144444411444444444224444441144411444334114334444442
0244444111113144411111111444442002444441111114444311111134444420
0024444444444444444444444444420000024444444444444444444444442000
0000224444444444444444444422000000000022222222222222222222000000
</a:ToolIcon>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o296"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o314">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>D6E9FFB1-D44E-4B6F-84B8-4CB2ADE27E4D</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o315">
<a:ObjectID>92D9A621-7D68-426F-8D3D-54FB6DEFC759</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)

   If InitializeBT(obj, 1) Then 
      %Initialize% = True
      obj.Stereotype = &quot;BusinessTransaction&quot;
   Else
      %Initialize% = False
   End If

End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
<o:EventHandlerTargetItem Id="o316">
<a:ObjectID>7EC084AB-E9AA-4821-826A-78F24368D57D</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Business Transaction must be created under the model or a package</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = True
      else
         %CanCreate% = False
      end if
   end if   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o317">
<a:ObjectID>48200A76-20E7-495B-B6F5-3688A5A6EEC6</a:ObjectID>
<a:Name>BusinessTransaction2</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Atomic business process transaction between two roles.
This transaction contains a request and a response.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:EnableTool>1</a:EnableTool>
<a:ToolIcon>0D0000000800000008000000424D7E000000000000003E000000280000001000
0000100000000100010000000000400000000000000000000000000000000000
000000000000FFFFFF00E7F30000C001000080000000C7F30000FFFF0000C003
0000800100000000000000000000000000000000000000000000000000000000
00000001000080030000424D3605000000000000360400002800000010000000
1000000001000800000000000001000000000000000000000000000012000000
000000000000800020000000202020003F3F9F0040000000402020005F5F9F00
60000000602020007F3F3F007F7FBF009F3F3F009F9FBF00BF7F7F00DFBFBF00
DFDFDF00FFFFFF00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000503000000000000000602000000000A0C0505050505050505080E0200
00060F0E0E0E0E0E0E0E0E0E0E0F0A030000020C0300000000000000090A0000
000000000000000000000000000000000000050E0E0E0E0E0E0E0E0E0E050000
000C1111111111111111111111110A000511110B010107111111011111111105
0E11110B0B110111111101111111110E0E11110B0B110111111101111111110E
0E11110B01010411111101111111110E0E11110B0B110111111101111111110E
0E11110B0B110111101001101011110E0511110B010107110D0101010D111105
020C1111111111111111111111110A000002050E0E0E0E0E0E0E0E0E0E050000
0E0000000C00000006000000424DBE000000000000003E000000280000002000
0000200000000100010000000000800000000000000000000000000000000000
000000000000FFFFFF00FFFFFFFFFC7FFF1FF8FFFF8FF0000007C0000001F000
0007F8FFFF8FFC7FFF1FFFFFFFFFFFFFFFFFFC00003FF000000FE0000007C000
0003800000018000000100000000000000000000000000000000000000000000
000000000000000000000000000000000000800000018000000180000003C000
0007E000000FFC00003F424D7602000000000000760000002800000020000000
2000000001000400000000000002000000000000000000000000000005000000
00000000000080008000000080808000FFFFFF00000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000022300000000000000032200000
0000024200000000000000000242000000002422222222222222222222242000
0032444444444444444444444444423000002422222222222222222222242000
0000024200000000000000000242000000000022300000000000000032200000
0000000000000000000000000000000000000000000000000000000000000000
0000002222222222222222222200000000002244444444444444444444220000
0022444444444444444444444444200000244444444444444444444444444200
0244444111111444444411444444442002444441111131444444114444444420
2444444114441144444411444444444224444441144411444444114444444442
2444444114441144444411444444444224444441144411444444114444444442
2444444111111144444411444444444224444441111114444444114444444442
2444444114441144444411444444444224444441144411444444114444444442
2444444114441144444411444444444224444441144411444334114334444442
0244444111113144411111111444442002444441111114444311111134444420
0224444444444444444444444444420000224444444444444444444444442000
0002224444444444444444444422000000000022222222222222222222000000
</a:ToolIcon>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o296"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o318">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>3F276027-D932-4C7A-9D18-C58D66AFF02D</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o319">
<a:ObjectID>163CB289-EB44-4218-B1C9-762DC6DDC75D</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Business Transaction must be created under the model or a package</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = True
      else
         %CanCreate% = False
      end if
   end if   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
<o:EventHandlerTargetItem Id="o320">
<a:ObjectID>63FA20D8-C42E-418F-BF12-836BAFE9DB3F</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)

   If InitializeBT(obj, 2) Then
      %Initialize% = True
      obj.Stereotype = &quot;BusinessTransaction&quot;
   Else
      %Initialize% = False
   End If

End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o321">
<a:ObjectID>7A25FC2C-4D75-4C7E-B8AA-23B33199B40C</a:ObjectID>
<a:Name>BusinessTransaction3</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Atomic business process transaction between two roles.
This transaction contains a request and a response with receipt acknowledgment.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:EnableTool>1</a:EnableTool>
<a:ToolIcon>0D0000000800000008000000424D7E000000000000003E000000280000001000
0000100000000100010000000000400000000000000000000000000000000000
000000000000FFFFFF00E1F30000C001000080000000C1F30000FFFF0000C003
0000800100000000000000000000000000000000000000000000000000000000
00000001000080030000424D3605000000000000360400002800000010000000
1000000001000800000000000001000000000000000000000000000014000000
000000000000800020000000202020003F3F9F0040000000402020005F5F9F00
60000000602020007F3F3F007F7FBF009F3F3F009F9FBF00BF7F7F00CFAFAF00
DFBFBF00DFDFDF00EFEFEF00FFFFFF0000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000503020600000000000602000000000A0C050F080505050505080E0200
0006100E0E120E0E0E0E0E0E0E100A030000020C030A090000000000090A0000
000000000000000000000000000000000000050E0E0E0E0E0E0E0E0E0E050000
000C1313131313131313131313130A000513130B010107131313011313131305
0E13130B0B130113131301131313130E0E13130B0B130113131301131313130E
0E13130B01010413131301131313130E0E13130B0B130113131301131313130E
0E13130B0B130113111101111113130E0513130B010107130D0101010D131305
020C1313131313131313131313130A000002050E0E0E0E0E0E0E0E0E0E050000
0E0000000C00000006000000424DBE000000000000003E000000280000002000
0000200000000100010000000000800000000000000000000000000000000000
000000000000FFFFFF00FFFFFFFFFC63FF1FF8C7FF8FF0000007C0000001F000
0007F8C7FF8FFC63FF1FFFFFFFFFFFFFFFFFFC00003FF000000FE0000007C000
0003800000018000000100000000000000000000000000000000000000000000
000000000000000000000000000000000000800000018000000180000003C000
0007E000000FFC00003F424D7602000000000000760000002800000020000000
2000000001000400000000000002000000000000000000000000000006000000
00000000000080008000000080808000C0C0C000FFFFFF000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000022300223000000000032200000
0000025200252000000000000252000000002522225422222222222222252000
0032555555555555555555555555523000002522225422222222222222252000
0000025200252000000000000252000000000022300223000000000032200000
0000000000000000000000000000000000000000000000000000000000000000
0000002222222222222222222200000000002255555555555555555555220000
0022555555555555555555555555200000255555555555555555555555555200
0255555111111555555511555555552002555551111131555555115555555520
2555555115551155555511555555555225555551155511555555115555555552
2555555115551155555511555555555225555551155511555555115555555552
2555555111111155555511555555555225555551111115555555115555555552
2555555115551155555511555555555225555551155511555555115555555552
2555555115551155555511555555555225555551155511555335115335555552
0255555111113155511111111555552002555551111115555311111135555520
0225555555555555555555555555520000225555555555555555555555552000
0002225555555555555555555522000000000022222222222222222222000000
</a:ToolIcon>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o296"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o322">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>D05C8D17-CE76-4B34-818D-36219257801C</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o323">
<a:ObjectID>172CEC6C-F66A-442D-AD09-752660833CA0</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Business Transaction must be created under the model or a package</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = True
      else
         %CanCreate% = False
      end if
   end if   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
<o:EventHandlerTargetItem Id="o324">
<a:ObjectID>2B8FDDF3-D0E8-48B9-8D67-180F19A7E5F3</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)

   If InitializeBT(obj, 3) Then
      %Initialize% = True
      obj.Stereotype = &quot;BusinessTransaction&quot;
   Else
      %Initialize% = False
   End If

End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o325">
<a:ObjectID>39072677-D019-492D-8086-B49319E4928C</a:ObjectID>
<a:Name>BusinessTransaction4</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Atomic business process transaction between two roles.
This transaction contains a request and a response with receipt and acceptance acknowledgments.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:EnableTool>1</a:EnableTool>
<a:ToolIcon>0D0000000800000008000000424D7E000000000000003E000000280000001000
0000100000000100010000000000400000000000000000000000000000000000
000000000000FFFFFF00C2730000800100000000000080730000FFFF0000C003
0000800100000000000000000000000000000000000000000000000000000000
00000001000080030000424D3605000000000000360400002800000010000000
1000000001000800000000000001000000000000000000000000000015000000
000000000000800020000000202020003F3F9F0040000000402020005F5F9F00
60000000602020007F3F3F007F7FBF009F3F3F009F9FBF00AF6F6F00BF7F7F00
CFAFAF00DFBFBF00DFDFDF00EFEFEF00FFFFFF00000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
00000503020600050300000006020000000A0C0510080A0E05050505080F0200
06110F0F130F11100F0F0F0F0F110A0300020C030A09020C03000000090A0000
000000000000000000000000000000000000050F0F0F0F0F0F0F0F0F0F050000
000C1414141414141414141414140A000514140B010107141414011414141405
0F14140B0B140114141401141414140F0F14140B0B140114141401141414140F
0F14140B01010414141401141414140F0F14140B0B140114141401141414140F
0F14140B0B140114121201121214140F0514140B010107140D0101010D141405
020C1414141414141414141414140A000002050F0F0F0F0F0F0F0F0F0F050000
0E000000100000000C000000424DBE000000000000003E000000280000002000
0000200000000100010000000000800000000000000000000000000000000000
000000000000FFFFFF00FFFFFFFFF18C7F1FE318FF8FC000000700000001C000
0007E318FF8FF18C7F1FFFFFFFFFFFFFFFFFFC00003FF000000FE0000007C000
0003800000018000000100000000000000000000000000000000000000000000
000000000000000000000000000000000000800000018000000180000003C000
0007E000000FFC00003F424D7602000000000000760000002800000020000000
2000000001000400000000000002000000000000000000000000000006000000
00000000000080008000000080808000C0C0C000FFFFFF000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000002230022300223000000032200000
0002520025200252000000000252000000252222542225422222222222252000
3255555555555555555555555555523000252222542225422222222222252000
0002520025200252000000000252000000002230022300223000000032200000
0000000000000000000000000000000000000000000000000000000000000000
0000002222222222222222222200000000002255555555555555555555220000
0022555555555555555555555555200000255555555555555555555555555200
0255555111111555555511555555552002555551111131555555115555555520
2555555115551155555511555555555225555551155511555555115555555552
2555555115551155555511555555555225555551155511555555115555555552
2555555111111155555511555555555225555551111115555555115555555552
2555555115551155555511555555555225555551155511555555115555555552
2555555115551155555511555555555225555551155511555335115335555552
0255555111113155511111111555552002555551111115555311111135555520
0225555555555555555555555555520000225555555555555555555555552000
0002225555555555555555555522000000000022222222222222222222000000
</a:ToolIcon>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o296"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o326">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>9AAD0DCD-6F69-406C-A5E2-AC337C887349</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o327">
<a:ObjectID>BD65D30E-92AA-4317-9A69-CAB4AA9FA125</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Business Transaction must be created under the model or a package</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = True
      else
         %CanCreate% = False
      end if
   end if   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
<o:EventHandlerTargetItem Id="o328">
<a:ObjectID>629A9074-15AB-4432-B9E5-AEBBFB1A817B</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)

   If InitializeBT(obj, 4) Then
      %Initialize% = True
      obj.Stereotype = &quot;BusinessTransaction&quot;
   Else
      %Initialize% = False
   End If

End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o329">
<a:ObjectID>FE1F5DF7-DCAD-44B6-9174-8D4F560B75AD</a:ObjectID>
<a:Name>BusinessTransaction5</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Atomic business process transaction between two roles.
This transaction contains a request and a response with receipt and acceptance acknowledgments.
There is also a receipt acknowledgment for the response message.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:EnableTool>1</a:EnableTool>
<a:ToolIcon>0D0000000800000008000000424D7E000000000000003E000000280000001000
0000100000000100010000000000400000000000000000000000000000000000
000000000000FFFFFF00C2430000800100000000000080410000FFFF0000C003
0000800100000000000000000000000000000000000000000000000000000000
00000001000080030000424D3605000000000000360400002800000010000000
1000000001000800000000000001000000000000000000000000000015000000
000000000000800020000000202020003F3F9F0040000000402020005F5F9F00
60000000602020007F3F3F007F7FBF009F3F3F009F9FBF00AF6F6F00BF7F7F00
CFAFAF00DFBFBF00DFDFDF00EFEFEF00FFFFFF00000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
00000503020600050300060203050000000A0C0510080A0E05050810050C0A00
06110F0E130F10100F0F0F130E0F110600020C030A09020C0300090A030C0200
000000000000000000000000000000000000050F0F0F0F0F0F0F0F0F0F050000
000C1414141414141414141414140A000514140B010107141414011414141405
0F14140B0B140114141401141414140F0F14140B0B140114141401141414140F
0F14140B01010414141401141414140F0F14140B0B140114141401141414140F
0F14140B0B140114121201121214140F0514140B010107140D0101010D141405
020C1414141414141414141414140A000002050F0F0F0F0F0F0F0F0F0F050000
0E000000100000000C000000424DBE000000000000003E000000280000002000
0000200000000100010000000000800000000000000000000000000000000000
000000000000FFFFFF00FFFFFFFFF18C718FE318F8C7C000000300000000C000
0003E318F8C7F18C718FFFFFFFFFFFFFFFFFFC00003FF000000FE0000007C000
0003800000018000000100000000000000000000000000000000000000000000
000000000000000000000000000000000000800000018000000180000003C000
0007E000000FFC00003F424D7602000000000000760000002800000020000000
2000000001000400000000000002000000000000000000000000000006000000
00000000000080008000000080808000C0C0C000FFFFFF000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000002230022300223000322003220000
0002520025200252000002520025200000252222542225422222224522225200
3255555455554555555555554555552300252222542225422222224522225200
0002520025200252000002520025200000002230022300223000322003220000
0000000000000000000000000000000000000000000000000000000000000000
0000002222222222222222222200000000002255555555555555555555220000
0022555555555555555555555555200000255555555555555555555555555200
0255555111111555555511555555552002555551111131555555115555555520
2555555115551155555511555555555225555551155511555555115555555552
2555555115551155555511555555555225555551155511555555115555555552
2555555111111155555511555555555225555551111115555555115555555552
2555555115551155555511555555555225555551155511555555115555555552
2555555115551155555511555555555225555551155511555335115335555552
0255555111113155511111111555552002555551111115555311111135555520
0225555555555555555555555555520000225555555555555555555555552000
0002225555555555555555555522000000000022222222222222222222000000
</a:ToolIcon>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o296"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o330">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>97D11D7C-F143-4728-A763-A93D7A1F71BF</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o331">
<a:ObjectID>D6026800-223B-415F-9212-FA40E23C254E</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Business Transaction must be created under the model or a package</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = True
      else
         %CanCreate% = False
      end if
   end if   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
<o:EventHandlerTargetItem Id="o332">
<a:ObjectID>E5399981-E5A0-43A9-9AAF-0BF7B845249B</a:ObjectID>
<a:Name>Initialize</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %Initialize%(obj)

   If InitializeBT(obj, 5) Then
      %Initialize% = True
      obj.Stereotype = &quot;BusinessTransaction&quot;
   Else
      %Initialize% = False
   End If

End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o333">
<a:ObjectID>044B5D87-EBE6-4EDF-A3DB-9FE4BE556D25</a:ObjectID>
<a:Name>BusinessAction</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:Abstract>1</a:Abstract>
<c:Categories>
<o:TypedCategoryTargetItem Id="o334">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>21D6931F-3F84-4F67-A874-446A5106CC4C</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o335">
<a:ObjectID>A5B4EB9A-8E6C-4910-8F97-05DF2E645035</a:ObjectID>
<a:Name>Parent should be a Business Transaction</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Business Action has a Business Transaction parent.</a:HelpMessage>
<a:OutputMessage>The following Business Actions do not have a Business Transaction parent:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Process) And obj.Parent.Stereotype &lt;&gt; &quot;BusinessTransaction&quot;) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o336">
<a:ObjectID>DC9EA8A5-E50C-4D29-B4AC-DD291647A4AF</a:ObjectID>
<a:Name>Non-composite process</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Business Action is not composite process.</a:HelpMessage>
<a:OutputMessage>The following Business Actions are composite:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.composite) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o337">
<a:ObjectID>29F5FF7D-D710-4031-9E15-94E026B6FE53</a:ObjectID>
<a:Name>Non-implemented by process</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Business Action is not implemented by another process.</a:HelpMessage>
<a:OutputMessage>The following Business Actions cannot be implemented by another process:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If Not (obj.Implementer Is Nothing) Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o338">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>719A8EAE-6B31-44A5-9B5C-B9D918CEE550</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o339">
<a:ObjectID>9D597C3A-06E9-4C0D-B66F-9E2086E97948</a:ObjectID>
<a:Name>isAuthorizationRequired</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>If a partner role needs authorization to request a business action or to respond to a business action then the sending partner role must sign the business document exchanged and the receiving partner role must validate this business control and approve the authorizer. A responding partner must signal an authorization exception if the sending partner role is not authorized to perform the business activity. A sending partner must send notification of failed authorization if a responding partner is not authorized to perform the responding business activity.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o340">
<a:ObjectID>3B53187F-972D-4B35-8DCE-B0D933095E0B</a:ObjectID>
<a:Name>isIntelligibleCheckRequired</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Receiving partner role must check that a requesting document is not garbled (unreadable, unintelligible) before sending acknowledgement of receipt</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o341">
<a:ObjectID>6D3375A9-BC45-48D0-9EFC-0280C0E1B04B</a:ObjectID>
<a:Name>isNonRepudiationReceiptRequired</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Both partners agree to mutually verify receipt of a requesting business document and that the receipt must be non-repudiable. A receiving partner must send notification of failed business control (possibly revoking a contractual offer) if a responding partner has not properly delivered their business document.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o342">
<a:ObjectID>F5A0C703-EF52-4990-934B-72266194532C</a:ObjectID>
<a:Name>isNonRepudiationRequired</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>If non-repudiation of origin and content is required then the business activity must store the business document in its original form for the duration mutually agreed to in a trading partner agreement. A responding partner must signal a business control exception if the sending partner role has not properly delivered their business document. A requesting partner must send notification of failed business control if a responding partner has not properly delivered their business document.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o343">
<a:ObjectID>6EA07CEF-A2A1-11D5-A3ED-0002A523AAEC</a:ObjectID>
<a:Name>timeToAcknowledgeReceipt</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The time a receiving role has to acknowledge receipt of a business document. this parameter is specified on the sending side.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>13</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o344">
<a:TypePublicName>StereotypeTargetItem</a:TypePublicName>
<a:ObjectID>55EA3FDA-DEC4-4ADF-95AE-A5A2301E4583</a:ObjectID>
<a:Name>Stereotypes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:StereotypeTargetItem Id="o345">
<a:ObjectID>93E0B304-56CA-4D82-B725-7FA596694090</a:ObjectID>
<a:Name>RequestingBusinessActivity</a:Name>
<a:Code>RequestingBusinessActivity</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Requesting activity of the Business Transaction.</a:Comment>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o333"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o346">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>B84160AA-2554-4930-A26C-702ADBF99044</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o347">
<a:ObjectID>6EA07CF0-A2A1-11D5-A3ED-0002A523AAEC</a:ObjectID>
<a:Name>timeToAcknowledgeAcceptance</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>The time a receiving role has to non-substantively acknowledge business acceptance of a business document. This parameter is specified on the requesting side.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>13</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o348">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>CFE6F981-12A2-434D-A585-EB572F7D3865</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o349">
<a:ObjectID>64CD651B-0819-41A3-B19D-BFC9635019EE</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Requesting Business Activity Activity must be created under a Business Transaction</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = False
      else
         if parent.Stereotype = &quot;BusinessTransaction&quot; then
            %CanCreate% = True
         else
            %CanCreate% = False
         end if
      end if
   end if    
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o350">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>CD6B39DC-E63E-4714-82C4-5803E93F2104</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o351">
<a:ObjectID>34565392-5602-4587-8C0B-D69249E480DE</a:ObjectID>
<a:Name>Missing outgoing transitions</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Requesting Business Activity has at least three outgoing transitions.</a:HelpMessage>
<a:OutputMessage>The following %classname% do not have enough outgoing transitions:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If obj.OutputFlows.Count &lt; 3 Then
      %Check% = False
   End If   
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.
   outmsg = &quot;The&quot; + obj.Stereotype + &quot; &quot; + obj.Name + &quot; should have three outgoing flows:to the responding activity,to the succes end, to the failure end.&quot;
   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o352">
<a:ObjectID>AA573266-FC62-45A4-9BF5-67FD50AB68C8</a:ObjectID>
<a:Name>No more than one transition to the responding activity</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that it exists only one transition from the Requesting Business Activity and the Responding Business Activity.</a:HelpMessage>
<a:OutputMessage>The following Requesting Business Activities have too many transitions from the %Stereotype% %Name% to responding activity.</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim nbFlowToRwF
   nbFlowToRwF = 0
   Dim nbFlowToR
   nbFlowToR = 0
   Dim Flow,dest
   For Each Flow In obj.OutputFlows
      Set dest = Flow.Destination
      Select Case dest.ObjectType
         Case &quot;Process&quot;
            If (dest.Stereotype = &quot;RespondingBusinessActivity&quot;) And Not Flow.Format Is Nothing Then
               nbFlowToR = nbFlowToR + 1
            Else
               If (dest.Stereotype = &quot;RespondingBusinessActivity&quot;) Then
                  nbFlowToRwF = nbFlowToRwF + 1
               End If
            End If
      End Select
   Next   
   If (nbFlowToRwF &gt; 1) Or (nbFlowToR &gt; 1) Then
      %Check%=False
   End If 
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o353">
<a:ObjectID>8E3473C4-3F7D-4C36-AFFA-869FCA6F92C2</a:ObjectID>
<a:Name>No more than one Business Error transition</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Requesting Business Activity exit with only one Business Error transition.</a:HelpMessage>
<a:OutputMessage>The following Requesting Business Activities have many Business Error transitions:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim nbFlowBERR
   nbFlowBERR = 0
   Dim Flow,dest
   For Each Flow In obj.OutputFlows
      Set dest = Flow.Destination
      If (dest.ObjectType = &quot;ProcessEnd&quot;) Then
            if (Flow.FlowType = &quot;Business Error&quot;) Then
               nbFlowBERR = nbFlowBERR + 1
            End If
       End If
   Next
   If nbFlowBERR &gt; 1 Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o354">
<a:ObjectID>5615C56E-D98D-4AFA-8087-1DEF3A822735</a:ObjectID>
<a:Name>No more than one Technical Error transition</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Requesting Business Activity exit with only one Technical Error transition.</a:HelpMessage>
<a:OutputMessage>The following Requesting Business Activities have many Technical Error transitions:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim nbFlowTERR
   nbFlowTERR = 0
   Dim Flow,dest
   For Each Flow In obj.OutputFlows
      Set dest = Flow.Destination
      if (dest.ObjectType = &quot;ProcessEnd&quot;) Then
            if (Flow.FlowType = &quot;Technical Error&quot;) Then
               nbFlowTERR = nbFlowTERR + 1
            End If
       End If
   Next
   If nbFlowTERR &gt; 1 Then
   %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o355">
<a:ObjectID>E8DFA819-52EA-4447-8791-840BC7FD75E3</a:ObjectID>
<a:Name>No more than one Success transition</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Requesting Business Activity exit with only one Success transition.</a:HelpMessage>
<a:OutputMessage>The following Requesting Business Activities have many Success transitions:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim nbFlowSucc
   nbFlowSucc = 0
   Dim Flow,dest
   For Each Flow In obj.OutputFlows
      Set dest = Flow.Destination
      if (dest.ObjectType = &quot;ProcessEnd&quot;) Then
            if ((Flow.FlowType = &quot;Success&quot;)Or(Flow.FlowType = &quot;&quot;)) Then
               nbFlowSucc = nbFlowSucc + 1
            End If
       End If
   Next
   If nbFlowSucc &gt; 1 Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o356">
<a:ObjectID>AE3B39C8-B923-4ACE-98C9-D0D6268FB5FE</a:ObjectID>
<a:Name>Outgoing transitions validity</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the transitions outgoing from the Requesting Business Activity are valids.</a:HelpMessage>
<a:OutputMessage>The following Requesting Business Activities have invalid transitions:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   Dim Flow,dest
   For Each Flow In obj.OutputFlows
      Set dest = Flow.Destination
      Select Case dest.ObjectType
         Case &quot;Process&quot;
            If (dest.Stereotype &lt;&gt; &quot;RespondingBusinessActivity&quot;) Then
               %Check% = False
            End If
       End Select
   Next
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o357">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>1D26EE25-5B5A-4234-8B9F-D6A790E55652</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o358">
<a:ObjectID>FD20D4C3-5FFF-49B5-96A3-2C8ADC47B746</a:ObjectID>
<a:Name>businessAction</a:Name>
<a:TemplateTargetItem.Value>.//Generate attributes of RequestingBusinessActivity element.
%reqRepActivity%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o359">
<a:ObjectID>831DDA49-27FA-4087-B8AC-5CA60F8358D1</a:ObjectID>
<a:Name>documentFlow</a:Name>
<a:TemplateTargetItem.Value>.//Generates the document envelope sent by a Requesting Business Activity.
%messageFormat%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o360">
<a:ObjectID>01BC9430-081C-4F59-B37A-0677A69677BC</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>.if (%isAuthorizationRequired%==TRUE)
isAuthorizationRequired=&quot;%isAuthorizationRequired%&quot;
.endif(\n)
.if (%isIntelligibleCheckRequired%==TRUE)
isIntelligibleCheckRequired=&quot;%isIntelligibleCheckRequired%&quot;
.endif(\n)
.if (%isNonRepudiationRequired%==TRUE)
isNonRepudiationRequired=&quot;%isNonRepudiationRequired%&quot;
.endif(\n)
.if (%isNonRepudiationReceiptRequired%==TRUE)
isNonRepudiationReceiptRequired=&quot;%isNonRepudiationReceiptRequired%&quot;
.endif(\n)
.if (%timeToAcknowledgeAcceptance%)
timeToAcknowledgeAcceptance=&quot;%.X:timeToAcknowledgeAcceptance%&quot;
.endif(\n)
.if (%timeToAcknowledgeReceipt%)
timeToAcknowledgeReceipt=&quot;%.X:timeToAcknowledgeReceipt%&quot;
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o361">
<a:ObjectID>D50B2C4F-F4BB-4571-A74D-558CF3A055CE</a:ObjectID>
<a:Name>suffix</a:Name>
<a:TemplateTargetItem.Value>_QBA_</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o362">
<a:ObjectID>28D5AAD6-CB7A-4012-9EAF-7F9F8188298B</a:ObjectID>
<a:Name>bizProcess</a:Name>
<a:TemplateTargetItem.Value>.//Generates an ebXML business action :RequestingBusinessActivity.
%businessAction%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o363">
<a:ObjectID>B130481D-195A-4379-BE47-E2D772E125E6</a:ObjectID>
<a:Name>RespondingBusinessActivity</a:Name>
<a:Code>RespondingBusinessActivity</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Responding activity of the Business Transaction.</a:Comment>
<c:ParentSttp>
<o:StereotypeTargetItem Ref="o333"/>
</c:ParentSttp>
<c:Categories>
<o:TypedCategoryTargetItem Id="o364">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>523B960B-7AA4-420F-9B0E-35DD0B9CF979</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o365">
<a:ObjectID>DA0025D0-D68E-4CDE-93EE-A67976B461E1</a:ObjectID>
<a:Name>Existence of incoming transitions</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Responding Business Activity has at least one incoming transition.</a:HelpMessage>
<a:OutputMessage>The following Responding Business Activities do not have incoming transitions:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If obj.InputFlows.Count = 0 Then
      %Check% = False
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o366">
<a:TypePublicName>EventHandlerTargetItem</a:TypePublicName>
<a:ObjectID>F2036DCB-AE81-4080-A0C3-EC00035454EF</a:ObjectID>
<a:Name>Event Handlers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:EventHandlerTargetItem Id="o367">
<a:ObjectID>D18EE02F-E74C-4E2C-91C7-55E78F6E9449</a:ObjectID>
<a:Name>CanCreate</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>A Responding Business Activity Activity must be created under a Business Transaction</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HandlerScript>Function %CanCreate%(parent)
   if parent is Nothing then
      %CanCreate% = False
   else
      If not parent.IsKindOf(PdBpm.Cls_Process) then
         %CanCreate% = False
      else
         if parent.Stereotype = &quot;BusinessTransaction&quot; then
            %CanCreate% = True
         else
            %CanCreate% = False
         end if
      end if
   end if   
End Function</a:HandlerScript>
</o:EventHandlerTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o368">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>EA1DDD81-5D4F-4F6D-A5B3-15148A33DCCE</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o369">
<a:ObjectID>CB891A4D-5E90-4C86-B36F-5A382CF6A1B5</a:ObjectID>
<a:Name>businessAction</a:Name>
<a:TemplateTargetItem.Value>.if (%isAuthorizationRequired%==TRUE) or (%isIntelligibleCheckRequired%==TRUE)or(%isNonRepudiationRequired%==TRUE)or(%isNonRepudiationReceiptRequired%==TRUE)or (%hasResponseDocuments%)
%reqRepActivity%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o370">
<a:ObjectID>E4642FCB-3B37-430C-AC04-1332763247F2</a:ObjectID>
<a:Name>documentFlow</a:Name>
<a:TemplateTargetItem.Value>.//Generates the document envelope sent by a Responding Business Activity.
%messageFormat%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o371">
<a:ObjectID>E967BC8F-8BE8-4654-B637-46B9736891B5</a:ObjectID>
<a:Name>extendedAttributes</a:Name>
<a:TemplateTargetItem.Value>.if (%isAuthorizationRequired%==TRUE)
isAuthorizationRequired=&quot;%isAuthorizationRequired%&quot;
.endif(\n)
.if (%isIntelligibleCheckRequired%==TRUE)
isIntelligibleCheckRequired=&quot;%isIntelligibleCheckRequired%&quot;
.endif(\n)
.if (%isNonRepudiationRequired%==TRUE)
isNonRepudiationRequired=&quot;%isNonRepudiationRequired%&quot;
.endif(\n)
.if (%isNonRepudiationReceiptRequired%==TRUE)
isNonRepudiationReceiptRequired=&quot;%isNonRepudiationReceiptRequired%&quot;
.endif(\n)
.if (%timeToAcknowledgeReceipt%)
timeToAcknowledgeReceipt=&quot;%.X:timeToAcknowledgeReceipt%&quot;
.endif(\n)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o372">
<a:ObjectID>3A6DA1AF-BD93-4A08-A6FE-DA47E7A1C962</a:ObjectID>
<a:Name>suffix</a:Name>
<a:TemplateTargetItem.Value>_RBA_</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o373">
<a:ObjectID>3917C727-5A33-4C54-8B40-4A49918B8B0E</a:ObjectID>
<a:Name>bizProcess</a:Name>
<a:TemplateTargetItem.Value>.//Generates an ebXML business action :RespondingBusinessActivity.
.if (%isAuthorizationRequired%==TRUE) or (%isIntelligibleCheckRequired%==TRUE)or(%isNonRepudiationRequired%==TRUE)or(%isNonRepudiationReceiptRequired%==TRUE)or (%hasResponseDocuments%)
%businessAction%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o374">
<a:ObjectID>A80F50FC-9EFF-4FC7-81A3-5F9723B346EF</a:ObjectID>
<a:Name>hasResponseDocuments</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(OutputFlows)
.if (%Format%)
true
.endif
.next()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:StereotypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o375">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>A81AA16A-02CA-482E-B17A-4E9C2F86F487</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o376">
<a:ObjectID>322D6940-9881-4C17-B6F7-09872F4AEA88</a:ObjectID>
<a:Name>Invalid stereotype</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the process has a valid ebXML stereotype.</a:HelpMessage>
<a:OutputMessage>The following objects do not have a valid ebXML stereotype:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = FALSE
   Select case obj.Stereotype
         Case &quot;MultiPartyCollaboration&quot;, &quot;BinaryCollaboration&quot;, &quot;BusinessTransaction&quot;,&quot;CollaborationActivity&quot;, &quot;BusinessTransactionActivity&quot;,&quot;RequestingBusinessActivity&quot;,&quot;RespondingBusinessActivity&quot;
            %Check% = TRUE
   End Select
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o377">
<a:ObjectID>FCD1C0B2-F897-48A8-B0DB-9A0A82658FF4</a:ObjectID>
<a:Name>BaseFolder</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o378">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>B038E724-2DD7-4F09-B80F-4A9823EDF171</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o379">
<a:ObjectID>B404A75B-8ADB-4438-9625-1D0C08BC1075</a:ObjectID>
<a:Name>Helpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o380">
<a:ObjectID>03894791-930D-4763-B279-0ED3150C8A40</a:ObjectID>
<a:Name>generateTransactions</a:Name>
<a:TemplateTargetItem.Value>.//browses only business transactions within the model or the sub-package and generates corresponding code.
.foreach_item(Processes,,\n)
   .if (%Stereotype%==&quot;BusinessTransaction&quot;) and (%Parent.ObjectID% == %Outer.ObjectID%)
%bizProcess%
   .else
%generateTransactions%
   .endif
.next(\n)
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o381">
<a:ObjectID>193E09A5-8465-4616-B27D-E542BF866C0C</a:ObjectID>
<a:Name>generateCollaborations</a:Name>
<a:TemplateTargetItem.Value>.//browses only Binary or MultiParty collaborations within the model or the sub-package and generates corresponding code.
.foreach_item(Processes,,\n)
   .if (%Stereotype%==&quot;BinaryCollaboration&quot;) and (%Parent.ObjectID% == %Outer.ObjectID%)
%bizProcess%
   .else
      .if (%Stereotype%==&quot;MultiPartyCollaboration&quot;) and (%Parent.ObjectID% == %Outer.ObjectID%)
%bizProcess%
      .else
%generateCollaborations%
      .endif
   .endif
.next(\n)
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o382">
<a:ObjectID>DB14400A-26DF-477D-89AF-F7BCAED3172A</a:ObjectID>
<a:Name>browseProcesses</a:Name>
<a:TemplateTargetItem.Value>%generateTransactions%
%generateCollaborations%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o383">
<a:ObjectID>652A1624-04BD-4C2B-91D4-71B43432669F</a:ObjectID>
<a:Name>browsePackages</a:Name>
<a:TemplateTargetItem.Value>.//browses sub-packages in order to generate ebXML packages.
.foreach_item(Packages)
%package%
.next(\n)


</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o384">
<a:ObjectID>3AF723EF-32A4-41D5-9DF7-E6779B6C9506</a:ObjectID>
<a:Name>ebXML</a:Name>
<a:TemplateTargetItem.Value>%browsePackages%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o385">
<a:ObjectID>BE5E86CF-4198-4C6C-9582-4F6652A57EA9</a:ObjectID>
<a:Name>browseMessageFormats</a:Name>
<a:TemplateTargetItem.Value>.//browses Message formats in order to generate Business Documents of the ebXML process specification.
.foreach_item(MessageFormats)
%documentType%
.next(\n)

</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o386">
<a:ObjectID>916C4E55-E7E1-4D0D-81E2-1674450A05C8</a:ObjectID>
<a:Name>pathName</a:Name>
<a:TemplateTargetItem.Value>.//Gets the qualified Name of the process. This is useful one the process is a shortcut to an external process.
.if (%Parent%)
%Parent.pathName%/%removeSuffixFromCode%
.else
%removeSuffixFromCode%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o387">
<a:ObjectID>FBD89A9C-D227-46BB-929A-6386E9D1D274</a:ObjectID>
<a:Name>model</a:Name>
<a:TemplateTargetItem.Value>.//Gets the current model.
.if(%Parent%)
%Parent.model%
.else
%Code%
.endif
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o388">
<a:ObjectID>6948FB05-6E91-4F1E-B638-E262DF554731</a:ObjectID>
<a:Name>documentationList</a:Name>
<a:TemplateTargetItem.Value>.//Generates documentation files attached to package or process.
.foreach_item(ExtendedDependencies,,)
   .if (%dependency%)
[%InfluentObject.documentationFile%\n]
   .endif
.next()
.foreach_item(ExtendedInfluences)
   .if (%invDependency%)
[%DependentObject.documentationFile%\n]
   .endif
.next()</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o389">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>2581B3D0-05D4-4A9F-A449-746550437536</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o390">
<a:ObjectID>B10D824A-0B70-43AF-96A1-42A0FDC04BA3</a:ObjectID>
<a:Name>ebXML nameID uniqueness</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the nameID ebXML extended attributes of objects are unique.</a:HelpMessage>
<a:OutputMessage>The following objects use duplicated nameID extended attribute values (See Output Script pane):</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = TRUE
   IDMap.RemoveAll
   If (obj.ObjectType = &quot;Model&quot;) Then
      output obj.Name
      %Check% = BrowseFolder(obj)
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o391">
<a:ObjectID>3C0A7C19-592C-455C-B1A4-F89BADDC3000</a:ObjectID>
<a:Name>ProcessStart</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o392">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>6E8EB60B-0254-46FE-98D6-F0060EF20B57</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o393">
<a:ObjectID>763D2094-E6D5-4720-94AC-39720079C947</a:ObjectID>
<a:Name>start</a:Name>
<a:TemplateTargetItem.Value>&lt;Start toBusinessState=&quot;%.X:OutputFlows.First.Destination.Code%&quot;[ toBusinessStateIDRef=&quot;%.X:OutputFlows.First.Destination.nameID%&quot;]/&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o394">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>4F09DCA8-35EB-48BD-959B-5FACB2372F16</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o395">
<a:ObjectID>C046B44B-93DA-4F95-BD18-5702DD834BFB</a:ObjectID>
<a:Name>Parent should be a Binary Collaboration or a Business Transaction</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that start is used by the choreography of Binary Collaboration or by a Business Transaction.</a:HelpMessage>
<a:OutputMessage>The following Starts are unexpected:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Model) Or obj.Parent.IsKindOf(PdBPM.cls_Package)) Then
      %Check% = False
      Exit Function
   End If
   If (obj.Parent.IsKindOf(PdBPM.cls_Process)) Then
      Select Case obj.Parent.Stereotype
         Case &quot;MultiPartyCollaboration&quot;
            %Check% = False
         Case &quot;BusinessTransaction&quot;, &quot;BinaryCollaboration&quot;
            %Check% = True
         Case Else
            %Check% = False
      End Select
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o396">
<a:ObjectID>BF7A3123-592D-4893-989D-DCEF47307FF0</a:ObjectID>
<a:Name>Isolated Start</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the Start is source of transitions within a choreography.</a:HelpMessage>
<a:OutputMessage>The following starts are isolated:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Process)) Then
      Select Case obj.Parent.Stereotype
         Case &quot;BusinessTransaction&quot;, &quot;BinaryCollaboration&quot;
            If (obj.OutputFlows.Count = 0) Then
               %Check% = False
            End If
      End Select
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o397">
<a:ObjectID>648F0F1E-EEBD-495A-B1BD-5B1160FB3B9C</a:ObjectID>
<a:Name>No more than one outgoing transitions</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures whether there is one and only one outgoing transition from the Start.</a:HelpMessage>
<a:OutputMessage>The following Starts have many outgoing transitions:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Process)) Then
      Select Case obj.Parent.Stereotype
         Case &quot;BusinessTransaction&quot;, &quot;BinaryCollaboration&quot;
            If (obj.OutputFlows.Count &gt; 1) Then
               %Check% = False
            End If
      End Select
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o398">
<a:ObjectID>755AD6D5-9419-4BBA-95B1-6B5E139F51C1</a:ObjectID>
<a:Name>ExtendedDependency</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o399">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>3C257CFD-FAC5-4BCB-BC16-DF539323CA67</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o400">
<a:ObjectID>C2B00512-E8A5-4CF4-B9D7-7A5F6533AF00</a:ObjectID>
<a:Name>invDependency</a:Name>
<a:TemplateTargetItem.Value>false</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o401">
<a:ObjectID>919FA5C0-0586-429E-925C-E27EBEDE8FAD</a:ObjectID>
<a:Name>dependency</a:Name>
<a:TemplateTargetItem.Value>false</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o402">
<a:ObjectID>CBE75E21-6172-421B-8133-D5EFAB3DE498</a:ObjectID>
<a:Name>invDependency&lt;&lt;Attachment&gt;&gt;</a:Name>
<a:TemplateTargetItem.Value>.if (%DependentObject.ObjectType%==FileObject)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o403">
<a:ObjectID>B1CE7D52-8DDF-4B7C-8989-1352B3210AD4</a:ObjectID>
<a:Name>dependency&lt;&lt;Attachment&gt;&gt;</a:Name>
<a:TemplateTargetItem.Value>.if (%InfluentObject.ObjectType%==FileObject)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o404">
<a:ObjectID>BE52A29B-5B49-4F83-8EDB-66B82ABFEC0F</a:ObjectID>
<a:Name>dependency&lt;&lt;Documentation&gt;&gt;</a:Name>
<a:TemplateTargetItem.Value>.if (%InfluentObject.ObjectType%==FileObject)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o405">
<a:ObjectID>CADDBED3-8C91-4166-8C53-A41BC80BB100</a:ObjectID>
<a:Name>invDependency&lt;&lt;Documentation&gt;&gt;</a:Name>
<a:TemplateTargetItem.Value>.if (%DependentObject.ObjectType%==FileObject)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o406">
<a:TypePublicName>StereotypeTargetItem</a:TypePublicName>
<a:ObjectID>7EA6EBBE-7AD0-4CFC-947D-D1F936A87492</a:ObjectID>
<a:Name>Stereotypes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:StereotypeTargetItem Id="o407">
<a:ObjectID>D7EE0450-55E4-47CE-9529-1D46AA041838</a:ObjectID>
<a:Name>Attachment</a:Name>
<a:Code>Attachment</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>represents an optional attachment to a Business Document in a ebXML DocumentEnvelope using the file object.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o408">
<a:ObjectID>C648E7AA-AF40-41CD-985E-9035DAA7B302</a:ObjectID>
<a:Name>Documentation</a:Name>
<a:Code>Documentation</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>used to describe an additional documentation for anyebXML element using the file object.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:StereotypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o409">
<a:ObjectID>11671FD8-7C4B-4CD0-8ADD-68482DDDB032</a:ObjectID>
<a:Name>BaseObject</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o410">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>D965EAC7-6F87-4FCD-9799-ED3BAB20FB92</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o411">
<a:ObjectID>2BE2FCD1-7FEF-421C-A978-3A3FE6FCBDF8</a:ObjectID>
<a:Name>Helpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o412">
<a:ObjectID>B87780B7-2DD6-4B68-B31E-030879D79167</a:ObjectID>
<a:Name>documentation</a:Name>
<a:TemplateTargetItem.Value>.//The documentation can be the comment attribute of the object, its description and/or any attached files.
.if (%Comment%)
&lt;Documentation&gt;
  %.X:Comment%
&lt;/Documentation&gt;
.endif(\n)
[%docDescription%\n][%documentationList%\n]</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o413">
<a:ObjectID>0E3BB890-9523-49C9-9FF5-6E61676D698C</a:ObjectID>
<a:Name>NamedObject</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o414">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>E4F47548-3132-476E-B521-6272B43527ED</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o415">
<a:ObjectID>2DA856D1-8437-4DBD-A6A5-9F75AD8A6887</a:ObjectID>
<a:Name>docDescription</a:Name>
<a:TemplateTargetItem.Value>.//Generates Documentation element from Description attribute of a Named Object.
.if (%GenOptions.generateDescription%)
   .ifnot (%Description%  == &quot;&quot;)
[&lt;Documentation&gt;[\n  %.X:Description%\n]&lt;/Documentation&gt;]
   .endif
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o416">
<a:ObjectID>B493FEF5-5244-4509-A300-F87BB3551583</a:ObjectID>
<a:Name>removeSuffixFromCode</a:Name>
<a:TemplateTargetItem.Value>%.X:Code%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o417">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>AAF0D4B8-7CA9-48F0-9D15-716194B31D0E</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o418">
<a:ObjectID>8037E5FD-BC83-4112-955E-C012E1699ED7</a:ObjectID>
<a:Name>nameID</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Specification elements reference other specification elements by name through the use of attributes.Two types of attributes are provided for names and references, XML ID/IDREF based and plain text. Each named element has a required name attribute and an optional nameID attribute. XML ID/IDREF functionality requires all IDs to be unique within a document and that all IDREFs point to a defined ID value. </a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o419">
<a:ObjectID>EF4B16FB-F3C5-4E13-8FDF-7CEACD76B986</a:ObjectID>
<a:Name>ProcessEnd</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o420">
<a:TypePublicName>StereotypeTargetItem</a:TypePublicName>
<a:ObjectID>32267E7C-9ADA-42D5-9C03-22A4724B1C92</a:ObjectID>
<a:Name>Stereotypes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:StereotypeTargetItem Id="o421">
<a:ObjectID>871EA0E8-DE6B-4102-879A-E351A6899EE3</a:ObjectID>
<a:Name>AnyFailure</a:Name>
<a:Code>AnyFailure</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Business Transaction or Binary Collaboration ends with any other Failure.</a:Comment>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o422">
<a:ObjectID>39D07787-2AA6-47E9-89F9-E8728944DCE7</a:ObjectID>
<a:Name>BusinessFailure</a:Name>
<a:Code>BusinessFailure</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Business Transaction or Binary Collaboration ends with Business Failure.</a:Comment>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o423">
<a:ObjectID>A5ACD0CE-7E31-41D1-8FB8-EF2011B05FDE</a:ObjectID>
<a:Name>Success</a:Name>
<a:Code>Success</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Business Transaction or Binary Collaboration successfully terminates</a:Comment>
</o:StereotypeTargetItem>
<o:StereotypeTargetItem Id="o424">
<a:ObjectID>F44C4082-D2F0-4B95-AE2E-E9DB2E519FD0</a:ObjectID>
<a:Name>TechnicalFailure</a:Name>
<a:Code>TechnicalFailure</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Business Transaction or Binary Collaboration ends with technical Failure.</a:Comment>
</o:StereotypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o425">
<a:TypePublicName>CustomCheckTargetItem</a:TypePublicName>
<a:ObjectID>F1EE3B07-A0C6-4D6B-B0AE-C84460B2A72C</a:ObjectID>
<a:Name>Custom Checks</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CustomCheckTargetItem Id="o426">
<a:ObjectID>83A2C4E4-54C2-4F93-8E1E-ED70966E2241</a:ObjectID>
<a:Name>No more than one incoming transition</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures whether there is one and only one incoming transition to the End.</a:HelpMessage>
<a:OutputMessage>The following Ends have many incoming transitions:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Process)) Then
      Select Case obj.Parent.Stereotype
         Case &quot;BusinessTransaction&quot;, &quot;BinaryCollaboration&quot;
            If (obj.InputFlows.Count &gt; 1) Then
               %Check% = False
            End If
      End Select
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o427">
<a:ObjectID>488458C3-BA2E-4940-A4B6-F612F399B8F8</a:ObjectID>
<a:Name>Parent should be a Binary Collaboration or a Business Transaction</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that End object is used by the choreography of Binary Collaboration or by a Business Transaction.</a:HelpMessage>
<a:OutputMessage>The parent of following End objects are invalid:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Model) Or obj.Parent.IsKindOf(PdBPM.cls_Package)) Then
      %Check% = False
      Exit Function
   End If
   If (obj.Parent.IsKindOf(PdBPM.cls_Process)) Then
      Select Case obj.Parent.Stereotype
         Case &quot;MultiPartyCollaboration&quot;
            %Check% = False
         Case &quot;BusinessTransaction&quot;, &quot;BinaryCollaboration&quot;
            %Check% = True
         Case Else
            %Check% = False
      End Select
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
<o:CustomCheckTargetItem Id="o428">
<a:ObjectID>08A940F5-82D8-4550-A268-395D6D502C53</a:ObjectID>
<a:Name>Isolated End</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that the End object has incoming transitions.</a:HelpMessage>
<a:OutputMessage>The following End objects are isolated:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
   If (obj.Parent.IsKindOf(PdBPM.cls_Process)) Then
      Select Case obj.Parent.Stereotype
         Case &quot;BusinessTransaction&quot;, &quot;BinaryCollaboration&quot;
            If (obj.InputFlows.Count = 0) Then
               %Check% = False
            End If
      End Select
   End If
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   &#39; Implement your automatic correction on &lt;obj&gt; here
   &#39; filling &lt;outmsg&gt; as you wish
   &#39; and return True if successful.

   outmsg = &quot;Automatic correction %Fix%() is not implemented&quot;

   %Fix% = False
End Function</a:AutoFixScrpt>
</o:CustomCheckTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o429">
<a:ObjectID>183BCFA5-FB74-4406-B5E7-53C74E5C185E</a:ObjectID>
<a:Name>ServiceProvider</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o430">
<a:ObjectID>C80905DF-6823-402B-800F-C8203E596D1A</a:ObjectID>
<a:Name>ServiceInterface</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o431">
<a:ObjectID>DDCCA852-0A86-4675-B315-A2BBC6FC96D2</a:ObjectID>
<a:Name>Operation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o432">
<a:ObjectID>A9205D8B-BAD5-4987-A8F6-32E9C539ED12</a:ObjectID>
<a:Name>Data</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o433">
<a:ObjectID>AE06CC6E-A166-4483-9EBB-A3A252A94A81</a:ObjectID>
<a:Name>Variable</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o434">
<a:ObjectID>36407894-3E97-4C28-9FB3-E99015A8BE9C</a:ObjectID>
<a:Name>Correlation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o435">
<a:ObjectID>1B195118-52F1-42BF-AD8E-5685DBF96FC2</a:ObjectID>
<a:Name>DataTransformation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o436">
<a:ObjectID>956CA83C-AE79-484E-89D5-B827B56BF593</a:ObjectID>
<a:Name>Event</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o437">
<a:ObjectID>66EF68E8-D0D1-404E-BB88-E3C3FCD09071</a:ObjectID>
<a:Name>ChoreographyTask</a:Name>
<a:CreationDate>1276846733</a:CreationDate>
<a:Creator>qxzhang</a:Creator>
<a:ModificationDate>1276846749</a:ModificationDate>
<a:Modifier>qxzhang</a:Modifier>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o438">
<a:ObjectID>D9DE6CBE-9BC4-4D16-9500-6D0C67F6A601</a:ObjectID>
<a:Name>ConversationNode</a:Name>
<a:CreationDate>1276846733</a:CreationDate>
<a:Creator>qxzhang</a:Creator>
<a:ModificationDate>1276846749</a:ModificationDate>
<a:Modifier>qxzhang</a:Modifier>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o439">
<a:ObjectID>266C9415-2B5A-4A43-BDC9-7BC3A9DAE3BB</a:ObjectID>
<a:Name>ChoreographyDiagram</a:Name>
<a:CreationDate>1280897724</a:CreationDate>
<a:Creator>qxzhang</a:Creator>
<a:ModificationDate>1280897733</a:ModificationDate>
<a:Modifier>qxzhang</a:Modifier>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o440">
<a:ObjectID>7AD1CB5D-9CAB-4F35-8547-DC96584071FB</a:ObjectID>
<a:Name>ConversationDiagram</a:Name>
<a:CreationDate>1280897724</a:CreationDate>
<a:Creator>qxzhang</a:Creator>
<a:ModificationDate>1280897733</a:ModificationDate>
<a:Modifier>qxzhang</a:Modifier>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o441">
<a:ObjectID>C325EE18-D3D1-418F-B3D1-830C79C934AE</a:ObjectID>
<a:Name>ConversationLink</a:Name>
<a:CreationDate>1284958087</a:CreationDate>
<a:Creator>qxzhang</a:Creator>
<a:ModificationDate>1284958098</a:ModificationDate>
<a:Modifier>qxzhang</a:Modifier>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExcludeFromModel>1</a:ExcludeFromModel>
</o:MetaClassTargetItem>
</c:Categories>
</o:ProfileTargetItem>
<o:TargetCategory Id="o442">
<a:ObjectID>4FDDAA06-DC28-4B61-BE60-749EF27F005B</a:ObjectID>
<a:Name>Settings</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<c:Categories>
<o:TargetCategory Id="o443">
<a:ObjectID>00A41BFF-65E3-4BFD-A2C9-37EAACA10B3F</a:ObjectID>
<a:Name>Choreography</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:BooleanTargetItem Id="o444">
<a:ObjectID>EF91B5AA-F897-4F77-8F16-E7B93582C8C9</a:ObjectID>
<a:Name>EnableMultipleStarts</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>When set to No, this setting ensures that no more  than one start is defined under a composite process.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:BooleanTargetItem>
<o:BooleanTargetItem Id="o445">
<a:ObjectID>63382A7F-2A3D-452E-8566-9D6879FD8A64</a:ObjectID>
<a:Name>EnableTopLevelChoreography</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>When set to No, this setting ensures that no flow or choreography object (start, end, decision...) is defined directly under the model or a package. These objects can be defined uniquely under a composite process.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:BooleanTargetItem>
</c:Categories>
</o:TargetCategory>
</c:Categories>
</o:TargetCategory>
</c:Categories>
</o:ProcessLanguage>

</BPMS>