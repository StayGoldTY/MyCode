<?xml version="1.0" encoding="UTF-8"?>
<?PowerDesigner AppLocale="UTF16" AutoAttach="FALSE" Code="IQStaging" HasExtendedMetaClass="FALSE" ID="{0250DFBF-B3A1-471E-A866-90B6D28C8A22}" LastModificationDate="1266338780" LibID="{6CE9859A-BA73-4EBB-B7D4-8E9176359B46}" Name="IQ Staging" Objects="299" Symbols="0" Type="{186C8AC3-D3DC-11D3-881C-00508B03C75C}" signature="XEM_XML" version="16.5.5.4689"?>
<!-- do not edit this file -->

<EXASET xmlns:a="attribute" xmlns:c="collection" xmlns:o="object">

<o:ExtendedModelDefinition Id="o1">
<a:ObjectID>0250DFBF-B3A1-471E-A866-90B6D28C8A22</a:ObjectID>
<a:Name>IQ Staging</a:Name>
<a:Code>IQStaging</a:Code>
<a:CreationDate>1103179818</a:CreationDate>
<a:Creator>xwang</a:Creator>
<a:ModificationDate>1266338780</a:ModificationDate>
<a:Modifier>pmangas</a:Modifier>
<a:Comment>The IQ Staging extended model definition allows users to create a staging database for IQ based on the Replication Server definition.
Users can use Information Liquidity Model to define replication using IQ as the target database.
When the design is complete, a popup menu command from the IQ database symbol automatically creates the staging database using ASE or SQL Anywhere, the stored procedures and the function strings to replicate data in the staging database.
To load data from staging database into IQ, users can:
1) Suspend replication
2) Run the IQ_LOAD_STAGING stored procedure in IQ to load the data
3) Run the IQ_CLEAN_STAGING stored procedure in the staging database to clean the transferred data
4) Resume replication
Users could also write a script and use a scheduler to automate the data transfer.</a:Comment>
<a:LibraryID>6CE9859A-BA73-4EBB-B7D4-8E9176359B46</a:LibraryID>
<a:CheckGlobalScript>&#39;******************************************************************************
&#39;* Purpose:  This VB-Script holds global definitions shared by all the custom-
&#39;*            checks scripts of the model extension.
&#39;******************************************************************************

Option Explicit &#39; This is to ensure all used variables are defined

Const IQStagingTarget = &quot;%CurrentTargetCode%.&quot;
Const StagingStereotype = &quot;Staging&quot;

Sub CreateStagingDatabaseIQ(Transformation, IQDatabase, bASEStagingDB, bDisplayTitle)

   Dim dlg
   If bASEStagingDB Then
      Set dlg = IQDatabase.CreateCustomDialog(IQStagingTarget + &quot;Add an ASE Staging Database for the IQ Database&quot;)
      If Not dlg.ShowDialog() Then
         Exit Sub
      End If
   Else
      Set dlg = IQDatabase.CreateCustomDialog(IQStagingTarget + &quot;Add a SQL Anywhere Staging Database for the IQ Database&quot;)
      If Not dlg.ShowDialog() Then
         Exit Sub
      End If
   End If
      
   &#39; Make sure that the IQ PDM exists and is opened
   Dim IQPDM
   Set IQPDM = GetDatabasePDM(IQDatabase)
   If IQPDM is Nothing Then
      MsgBox &quot;The IQ PDM is not defined or is not opened.&quot;, vbOKOnly, &quot;Error&quot;
      Exit Sub
   End If

   &#39; Get RepServer process
   Dim repServerProcess
   Set repServerProcess = GetRepServerProcess(IQDatabase)
   If repServerProcess is Nothing Then
      MsgBox &quot;The Replication Server for IQ database is not defined.&quot;, vbOKOnly, &quot;Error&quot;
      Exit Sub
   End If

   &#39; Make sure that the primary database PDM exists and is opened
   Dim primPDM
   Set primPDM = GetPrimaryDatabase(repServerProcess)
   If primPDM is Nothing Then
      MsgBox &quot;The primary database PDM is not defined or is not opened.&quot;, vbOKOnly, &quot;Error&quot;
      Exit Sub
   End If

   Output &quot;&quot;
   If bASEStagingDB Then
      Output &quot;Adding an ASE staging database for the IQ database &#39;&quot; + IQDatabase.Code + &quot;&#39;...&quot;
   Else
      Output &quot;Adding a SQL Anywhere staging database for the IQ database &#39;&quot; + IQDatabase.Code + &quot;&#39;...&quot;
   End If
   
   &#39; Create an ASE staging database PDM
   Dim stagingDatabase
   Set stagingDatabase = CreateStagingDatabase(Transformation, IQDatabase, bASEStagingDB)
   If stagingDatabase is Nothing Then
      &#39; Canceled
      Output &quot;Operation canceled.&quot;
      Exit Sub
   End If
   &#39; Create a staging process
   Dim stagingProcess
   Set stagingProcess = CreateStagingProcessProcess(Transformation, stagingDatabase, IQDatabase, bASEStagingDB)
   
   &#39; Create inserted, updated and deleted staging tables and stored procedures in the staging database PDM
   CreateStagingTablesInStagingDB stagingDatabase, IQDatabase, bASEStagingDB
        
   &#39; Add RepServer rs_insert, rs_update and rs_delete function strings to replicate data in the staging database; it may be useful to create stored procedures and use them in function strings
   ChangeFunctionStrings repServerProcess, stagingDatabase, IQDatabase, bASEStagingDB

   &#39; Create inserted, updated and deleted staging tables and stored procedures in the IQ PDM
   CreateStagingTablesInIQ stagingDatabase, IQDatabase, bASEStagingDB
   
   &#39; Create stored procedures in IQ PDM
   CreateProceduresInIQ stagingDatabase, IQDatabase, bASEStagingDB
  
   If bASEStagingDB Then 
      Output &quot;Successfully added an ASE staging database for the IQ database &#39;&quot; + IQDatabase.Code + &quot;&#39;.&quot;
   Else
      Output &quot;Successfully added a SQL Anywhere staging database for the IQ database &#39;&quot; + IQDatabase.Code + &quot;&#39;.&quot;
   End If
   if Not(Transformation is Nothing) then
      Transformation.SetSource IQDatabase, stagingDatabase
   end if
End Sub

&#39; Get the RepServer process
Function GetRepServerProcess(IQDatabase)
   Set GetRepServerProcess = Nothing
   Dim xem
   Set xem = GetIQStagingXEM(IQDatabase)
   Dim conn
   For Each conn in IQDatabase.DataConnections
      If conn.process.EvaluateTemplate(&quot;isRepServer&quot;, xem) Then
         Set GetRepServerProcess = conn.Process
         Exit For
      End If
   Next
End Function

&#39; Get the primary database of RepServer process
Function GetPrimaryDatabase(process)
   Set GetPrimaryDatabase = Nothing
   Dim xem
   Set xem = GetIQStagingXEM(process)
   Dim pub
   For Each pub in process.Publications
      If Not (pub.DataConnection is Nothing) Then
         Set GetPrimaryDatabase = GetDatabasePDM(pub.DataConnection.DataStore)
         Exit For
      End If
   Next
End Function

&#39; Create a default staging database PDM for ASE or ASA
Function CreateStagingDatabase(Transformation, IQDatabase, bASEStagingDB)
   Set CreateStagingDatabase = Nothing
   &#39; Get XEM
   Dim xem
   Set xem = GetIQStagingXEM(IQDatabase)

   &#39; Create a server
   Dim server, serverName, serverCode
   Set server = IQDatabase.Model.Servers.CreateNew
   serverName = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;StagingServerName&quot;)
   serverCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;StagingServerCode&quot;)
   If serverName = &quot;&quot; Then
      If bASEStagingDB Then
         serverName = &quot;ASE&quot;
      Else
         serverName = &quot;ASA&quot;
      End If
   End If
   If serverCode = &quot;&quot; Then
      If bASEStagingDB Then
         serverCode = &quot;ASE&quot;
      Else
         serverCode = &quot;ASA&quot;
      End If
   End If
   server.SetNameAndCode serverName, serverCode, true
   
   &#39; Create a new database object
   Set CreateStagingDatabase = IQDatabase.Model.Databases.CreateNew
   Dim dbName, dbCode
   dbName = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;StagingDatabaseName&quot;)
   dbCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;StagingDatabaseCode&quot;)

   CreateStagingDatabase.Server = server
   CreateStagingDatabase.SetNameAndCode dbName, dbCode, true
   CreateStagingDatabase.Comment = IQDatabase.EvaluateTemplate(&quot;stgDatabaseComment&quot;, xem)
   CreateStagingDatabase.Type = &quot;IQStaging&quot;

   &#39; Show the symbol
   Dim symbol, newSymbol, diagram
   Set diagram = IQDatabase.Model.DefaultDiagram
   Set newSymbol = diagram.AttachObject(CreateStagingDatabase)
   &#39; Move the existing symbol to the right
   Set symbol = IQDatabase.Model.DefaultDiagram.FindSymbol(IQDatabase, false)
   newSymbol.Rect = symbol.Rect
   symbol.Rect.Left = symbol.Rect.Left + 18000
   symbol.Rect.Right = symbol.Rect.Right + 18000
   &#39; Attach the existing connection to the staging database
   Dim conn, symConn
   For Each conn in IQDatabase.DataConnections
      If conn.DataStore.ObjectID = IQDatabase.ObjectID Then
         Set conn.DataStore = CreateStagingDatabase
         Set symConn = diagram.FindSymbol(conn)
         If Not (symConn is Nothing) Then
            symConn.SourceSymbol = newSymbol
         End If
         &#39; For ASA, the batch mode should be off
         If Not bASEStagingDB Then
            Dim xem2, xemCode
            Set xem2 = GetRepServerXEM(IQDatabase)
            If Not xem2 Is Nothing Then
               xemCode = xem2.Code + &quot;.&quot;
            End If
            conn.SetExtendedAttribute xemCode+&quot;DatabaseParameter_batch&quot;, &quot;off&quot;
         End If
      End If
   Next

   if (CreateStagingDatabase.SourceModels.Count = 0) then
      &#39; Create a new PDM
      Dim PDM, DBMS
      If bASEStagingDB Then
         DBMS = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;ASEStagingDatabaseDBMS&quot;)
      Else
         DBMS = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;ASAStagingDatabaseDBMS&quot;)
      End If
      Set PDM = CreateModel(PdPDM.cls_Model, &quot;|DBMS=&quot; + DBMS + &quot;|PhysicalDiagram&quot;)
      PDM.Name = &quot;Staging Database for IQ&quot;
      PDM.Code = &quot;IQStagingDatabase&quot;
      &#39; Attach the PDM to the staging database
      CreateStagingDatabase.AddSourceModel PDM
      if Not(Transformation is Nothing) then
         Transformation.SetSource IQDatabase, CreateStagingDatabase.SourceModels.Item(0), &quot;PDM&quot;
      end if
      PDM.DefaultDiagram.CloseView
   end if
End Function

&#39; Create a staging process
Function CreateStagingProcessProcess(Transformation, stagingDatabase, IQDatabase, bASEStagingDB)
   Output &quot;Creating transformation process...&quot;
   Dim model, diagram, conn1, conn2
   Set model = stagingDatabase.Model
   Set diagram = model.DefaultDiagram
   &#39; Create process
   Set CreateStagingProcessProcess = model.TransformationProcesses.CreateNew
   CreateStagingProcessProcess.SetNameAndCode &quot;Staging&quot;, &quot;Staging&quot;, true
   CreateStagingProcessProcess.Comment = &quot;IQ staging&quot;
   CreateStagingProcessProcess.Type = &quot;IQStaging&quot;
   &#39; Display the process in the middle
   Dim procSymbol, stgSymbol, IQSymbol
   Set procSymbol = diagram.AttachObject(CreateStagingProcessProcess)   
   Set stgSymbol = diagram.FindSymbol(stagingDatabase, false)
   Set IQSymbol  = diagram.FindSymbol(IQDatabase, false)
   Dim x, y, dx, dy
   x = ((stgSymbol.Rect.Left + stgSymbol.Rect.Right) + (IQSymbol.Rect.Left + IQSymbol.Rect.Right)) / 4
   y = ((stgSymbol.Rect.Top + stgSymbol.Rect.Bottom) + (IQSymbol.Rect.Top + IQSymbol.Rect.Bottom)) / 4
   dx = x - (procSymbol.Rect.Left + procSymbol.Rect.Right) / 2
   dy = y - (procSymbol.Rect.Top + procSymbol.Rect.Bottom) / 2   
   procSymbol.Rect.Left   = procSymbol.Rect.Left   + dx
   procSymbol.Rect.Right  = procSymbol.Rect.Right  + dx
   procSymbol.Rect.Top    = procSymbol.Rect.Top    + dy
   procSymbol.Rect.Bottom = procSymbol.Rect.Bottom + dy
   &#39; Create connections
   Set conn1 = model.DataConnections.CreateNew
   Set conn1.DataStore = stagingDatabase
   Set conn1.Process = CreateStagingProcessProcess
   conn1.AccessType = &quot;RO&quot;
   Set conn2 = model.DataConnections.CreateNew
   Set conn2.DataStore = IQDatabase
   Set conn2.Process = CreateStagingProcessProcess
   conn2.AccessType = &quot;WO&quot;
   if Not(Transformation is Nothing) then
      Transformation.SetSource stagingDatabase, conn1, &quot;DataConnect1&quot;
      Transformation.SetSource stagingDatabase, conn2, &quot;DataConnect2&quot;
   end if
   diagram.AttachLinkObject conn1, stgSymbol, procSymbol
   diagram.AttachLinkObject conn2, IQSymbol, procSymbol
End Function

&#39; Create inserted, updated, deleted staging tables in the staging database PDM
Sub CreateStagingTablesInStagingDB(stagingDatabase, IQDatabase, bASEStagingDB)
   Output &quot;Creating staging database PDM for IQ...&quot;
   Dim stgPDM, IQPDM, tab, stgTab, tabName, tabCode
   Set stgPDM = GetDatabasePDM(stagingDatabase)
   Set IQPDM = GetDatabasePDM(IQDatabase)
   If (Not stgPDM is Nothing) and (Not IQPDM is Nothing)Then
      Dim diagram
      Set diagram = stgPDM.DefaultDiagram
      
      &#39; Get XEM
      Dim xem
      Set xem = GetIQStagingXEM(stagingDatabase)
      
      &#39; Create tables
      Dim bSupportUpdate
      bSupportUpdate = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;SupportUpdateInIQ&quot;)
      For Each tab in IQPDM.Tables
         If Not tab.IsShortcut Then
            If (tab.Stereotype &lt;&gt; StagingStereotype) Then
               &#39; Create inserted table
               tabName = tab.EvaluateTemplate(&quot;stgInsertTableName&quot;, xem)
               tabCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;InsertStagingTableCode&quot;)
               tabCode = Replace(tabCode, &quot;&lt;Table&gt;&quot;, Left(tab.Code, 26))
               tabCode = UCase(Left(tabCode, 30))
               Set stgTab = AddTable(stagingDatabase, tabName, tabCode)
               stgTab.Comment = tab.EvaluateTemplate(&quot;stgInsertTableComment&quot;, xem)
               CopyColumns stgTab, tab, false
               &#39; Create an index for ASE
               If bASEStagingDB Then
                  CreatePKIndexe stgTab
               End If
               stgTab.Stereotype = StagingStereotype
               If diagram.FindSymbol(stgTab) is Nothing Then
                  diagram.AttachObject stgTab
               End If

               &#39; Create updated table
               If bSupportUpdate Then
                  tabName = tab.EvaluateTemplate(&quot;stgUpdateTableName&quot;, xem)
                  tabCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;UpdateStagingTableCode&quot;)
                  tabCode = Replace(tabCode, &quot;&lt;Table&gt;&quot;, Left(tab.Code, 26))
                  tabCode = UCase(Left(tabCode, 30))
                  Set stgTab = AddTable(stagingDatabase, tabName, tabCode)
                  stgTab.Comment = tab.EvaluateTemplate(&quot;stgUpdateTableComment&quot;, xem)
                  CopyColumns stgTab, tab, false
                  &#39; Create an index for ASE
                  If bASEStagingDB Then
                     CreatePKIndexe stgTab
                  End If
                  stgTab.Stereotype = StagingStereotype
                  If diagram.FindSymbol(stgTab) is Nothing Then
                     diagram.AttachObject stgTab
                  End If
               End If

               &#39; Create deleted table
               tabName = tab.EvaluateTemplate(&quot;stgDeleteTableName&quot;, xem)
               tabCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;DeleteStagingTableCode&quot;)
               tabCode = Replace(tabCode, &quot;&lt;Table&gt;&quot;, Left(tab.Code, 26))
               tabCode = UCase(Left(tabCode, 30))
               Set stgTab = AddTable(stagingDatabase, tabName, tabCode)
               stgTab.Comment = tab.EvaluateTemplate(&quot;stgDeleteTableComment&quot;, xem)
               CopyColumns stgTab, tab, true
               &#39; Create an index for ASE
               If bASEStagingDB Then
                  CreatePKIndexe stgTab
               End If
               stgTab.Stereotype = StagingStereotype
               If diagram.FindSymbol(stgTab) is Nothing Then
                  diagram.AttachObject stgTab
               End If
            End If
         End If
      Next
      
      &#39; Create a stored procedure to clean the staging tables in the staging database PDM
      Dim proc, procName, procCode, procComment, definition
      procName = IQDatabase.EvaluateTemplate(&quot;stgCleanStgProcName&quot;, xem)
      procCode = IQDatabase.EvaluateTemplate(&quot;stgCleanStgProcCode&quot;, xem)
      procComment = IQDatabase.EvaluateTemplate(&quot;stgCleanStgProcComment&quot;, xem)
      If bASEStagingDB Then
         definition = IQDatabase.EvaluateTemplate(&quot;stgASECleanStgProcDefinition&quot;, xem)
      Else
         definition = IQDatabase.EvaluateTemplate(&quot;stgASACleanStgProcDefinition&quot;, xem)
      End If
      Set proc = AddProcedure(stagingDatabase, procName, procCode)
      proc.Comment = procComment
      proc.Text = definition
      If diagram.FindSymbol(proc) is Nothing Then
         diagram.AttachObject proc
      End If
   End If
End Sub

&#39; Create inserted, updated, deleted staging tables in the IQ PDM
Sub CreateStagingTablesInIQ(stagingDatabase, IQDatabase, bASEStagingDB)
   On Error Resume Next
   Output &quot;Creating staging tables in IQ PDM...&quot;
   Dim PDM, tab, stgTab, tabName, tabCode
   Set PDM = GetDatabasePDM(IQDatabase)
   If Not (PDM is Nothing) Then
      &#39; Create a diagram
      Dim diagram, diag
      Set diagram = Nothing
      For Each diag in PDM.PhysicalDiagrams
         If Lcase(diag.Code) = &quot;staging&quot; Then
            Set diagram = diag
            Exit For
         End If
      Next
      If diagram is Nothing Then
         Set diagram = PDM.PhysicalDiagrams.CreateNew
         diagram.SetNameAndCode &quot;Staging&quot;, &quot;Staging&quot;, true
         diagram.CloseView
      End If
      
      &#39; Get XEM
      Dim xem
      Set xem = GetIQStagingXEM(IQDatabase)
      
      &#39; Create staging tables in IQ PDM
      Dim bUseInsertTable, bSupportUpdate
      bUseInsertTable = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;UseInsertStagingTableInIQ&quot;)
      bSupportUpdate  = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;SupportUpdateInIQ&quot;)
      For Each tab in PDM.Tables
         If Not tab.IsShortcut Then
            If (tab.Stereotype &lt;&gt; StagingStereotype) Then
               &#39; Create inserted table
               If bUseInsertTable Then
                  tabName = tab.EvaluateTemplate(&quot;iqStgInsertTableName&quot;, xem)
                  tabCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;InsertStagingTableCode&quot;)
                  tabCode = Replace(tabCode, &quot;&lt;Table&gt;&quot;, Left(tab.Code, 26))
                  tabCode = UCase(Left(tabCode, 30))
                  Set stgTab = AddTable(IQDatabase, tabName, tabCode)
                  stgTab.Comment = tab.EvaluateTemplate(&quot;iqStgInsertTableComment&quot;, xem)
                  CopyColumns stgTab, tab, false
                  stgTab.Stereotype = StagingStereotype
                  &#39; create IQ table
                  If diagram.FindSymbol(stgTab) is Nothing Then
                     diagram.AttachObject stgTab
                  End If
               End If

               &#39; Create updated table
               If bSupportUpdate Then
                  tabName = tab.EvaluateTemplate(&quot;iqStgUpdateTableName&quot;, xem)
                  tabCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;UpdateStagingTableCode&quot;)
                  tabCode = Replace(tabCode, &quot;&lt;Table&gt;&quot;, Left(tab.Code, 26))
                  tabCode = UCase(Left(tabCode, 30))
                  Set stgTab = AddTable(IQDatabase, tabName, tabCode)
                  stgTab.Comment = tab.EvaluateTemplate(&quot;iqStgUpdateTableComment&quot;, xem)
                  CopyColumns stgTab, tab, false
                  stgTab.Stereotype = StagingStereotype
                  &#39; create IQ table
                  If diagram.FindSymbol(stgTab) is Nothing Then
                     diagram.AttachObject stgTab
                  End If
               End If

               &#39; Create deleted table
               tabName = tab.EvaluateTemplate(&quot;iqStgDeleteTableName&quot;, xem)
               tabCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;DeleteStagingTableCode&quot;)
               tabCode = Replace(tabCode, &quot;&lt;Table&gt;&quot;, Left(tab.Code, 26))
               tabCode = UCase(Left(tabCode, 30))
               Set stgTab = AddTable(IQDatabase, tabName, tabCode)
               stgTab.Comment = tab.EvaluateTemplate(&quot;iqStgDeleteTableComment&quot;, xem)
               CopyColumns stgTab, tab, true
               stgTab.Stereotype = StagingStereotype
               &#39; create IQ table
               If diagram.FindSymbol(stgTab) is Nothing Then
                  diagram.AttachObject stgTab
               End If
            End If
         End If
      Next     
   End If
End Sub

&#39; Create stored procedures in IQ PDM
Sub CreateProceduresInIQ(stagingDatabase, IQDatabase, bASEStagingDB)
   Dim PDM
   Set PDM = GetDatabasePDM(IQDatabase)
   If Not (PDM is Nothing) Then
      &#39; Create a diagram
      Dim diagram, diag
      Set diagram = Nothing
      For Each diag in PDM.PhysicalDiagrams
         If Lcase(diag.Code) = &quot;staging&quot; Then
            Set diagram = diag
            Exit For
         End If
      Next
      If diagram is Nothing Then
         Set diagram = PDM.PhysicalDiagrams.CreateNew
         diagram.SetNameAndCode &quot;Staging&quot;, &quot;Staging&quot;, true
         diagram.CloseView
      End If
      
      &#39; Get XEM
      Dim xem
      Set xem = GetIQStagingXEM(IQDatabase)

      &#39; Create a stored procedure in the IQ PDM to:
      &#39; - Load data from the staging database in IQ staging tables using insert...location command
      &#39; - Load data from the IQ staging tables into IQ tables
      &#39; - Purge the IQ staging tables
      Dim proc, procName, procCode, procComment, definition
      procName = IQDatabase.EvaluateTemplate(&quot;iqLoadStgProcName&quot;, xem)
      procCode = IQDatabase.EvaluateTemplate(&quot;iqLoadStgProcCode&quot;, xem)
      procComment = IQDatabase.EvaluateTemplate(&quot;iqLoadStgProcComment&quot;, xem)
      definition = IQDatabase.EvaluateTemplate(&quot;iqLoadStgProcDefinition&quot;, xem)
      Set proc = AddProcedure(IQDatabase, procName, procCode)
      proc.Comment = procComment
      Dim serverName, databaseName
      serverName = stagingDatabase.EvaluateTemplate(&quot;stgServerName&quot;, xem)
      databaseName = stagingDatabase.EvaluateTemplate(&quot;stgDatabaseName&quot;, xem)
      If (serverName &lt;&gt; &quot;&quot;) then
         serverName = serverName + &quot;.&quot;
      End If
      definition = Replace(definition, &quot;&lt;Server&gt;.&quot;, serverName)
      definition = Replace(definition, &quot;&lt;Database&gt;&quot;, databaseName)
      proc.Text = definition
      If diagram.FindSymbol(proc) is Nothing Then
         diagram.AttachObject proc
      End If
   End If
End Sub

&#39; Add RepServer rs_insert, rs_update, rs_delete function strings to replicate data in the staging database; it may be useful to create stored procedures and use them in function strings
Sub ChangeFunctionStrings(process, stagingDatabase, IQDatabase, bASEStagingDB)
   ProcessRebuildFunctionStrings process, stagingDatabase, IQDatabase, bASEStagingDB, false
End Sub

&#39; Get the first PDM of a database
Function GetDatabasePDM(database)
   On Error Resume Next
   Set GetDatabasePDM = Nothing
   If Not (database Is Nothing) Then
      Dim pdm
      For Each pdm in database.SourceModels
         &#39; pdm is a shortcut
         Set pdm = pdm.TargetObject
         If Not (pdm is Nothing) Then
            Set GetDatabasePDM = pdm
            Exit Function
         End If
      Next
   End If
End Function

&#39; Get the IQStaging XEM
Function GetIQStagingXEM(obj)
   On Error Resume Next
   Set GetIQStagingXEM = Nothing
   Dim xem
   For Each xem in obj.Model.ExtendedModelDefinitions
      If xem.Code = &quot;%CurrentTargetCode%&quot; Then
         Set GetIQStagingXEM = xem
         Exit For
      End If
   Next
End Function

&#39; Get the RepServer XEM
Function GetRepServerXEM(obj)
   On Error Resume Next
   Set GetIQStagingXEM = Nothing
   Dim xem
   For Each xem in obj.Model.ExtendedModelDefinitions
      If Left(xem.Code, 18) = &quot;Replication Server&quot; Then
         Set GetRepServerXEM = xem
         Exit For
      End If
   Next
End Function

&#39; Find a table by name
Function FindTable(database, tabName)
   On Error Resume Next
   Set FindTable = Nothing
   If Not (database Is Nothing) Then
      Dim pdm, tab
      Set pdm = GetDatabasePDM(database)
      If Not (pdm is Nothing) Then
         For Each tab in pdm.Tables
            If LCase(tab.Code) = LCase(tabName) Then
               Set FindTable = tab
               Exit Function
            End If
         Next
      End If
   End If
End Function

&#39; Find a column by name
Function FindColumn(table, colName)
   On Error Resume Next
   Set FindColumn = Nothing
   If Not (table Is Nothing) Then
      Dim col
      For Each col in table.Columns
         If LCase(col.Code) = LCase(colName) Then
            Set FindColumn = col
            Exit Function
         End If
      Next
   End If
End Function

&#39; Add a table in a database
Function AddTable(database, tabName, tabCode)
   On Error Resume Next
   Set AddTable = FindTable(database, tabCode)
   If Not (AddTable Is Nothing) Then
      Exit Function
   End If

   Dim pdm, tab
   Set pdm = GetDatabasePDM(database)
   If Not (pdm is Nothing) Then
      Set tab = pdm.Tables.CreateNew
      If Not (tab is Nothing) Then
         tab.SetNameAndCode tabName, tabCode, false
         Output &quot;   Adding the Table &#39;&quot; + tab.Code + &quot;&#39;&quot;
         Set AddTable = tab
         Exit Function
      End If
   End If
End Function

&#39; Add a column in a database
Function AddColumn(table, colName, colCode, datatype, defaultValue, bDisplayTitle)
   On Error Resume Next
   Set AddColumn = FindColumn(table, colCode)
   If Not (AddColumn Is Nothing) Then
      Exit Function
   End if
   
   If Not (table Is Nothing) Then
      Dim column
      Set column = table.Columns.CreateNew
      If Not (column is Nothing) Then
         column.SetNameAndCode colName, colCode, false
         column.DataType = datatype
         column.DefaultValue = defaultValue
         If bDisplayTitle Then
            Output &quot;   Adding the Column &#39;&quot; + column.Code + &quot;&#39; in the Table &#39;&quot; + table.Code + &quot;&#39;&quot;
         End If
         Set AddColumn = column
         Exit Function
      End If
   End If
End Function

&#39; Copy columns
Sub CopyColumns(tableTarget, tableSource, bPrimaryKeyOnly)
   On Error Resume Next
   If (Not (tableSource Is Nothing)) and (Not (tableTarget Is Nothing)) Then
      Dim colSource, colTarget
      For Each colSource in tableSource.Columns
         If (Not bPrimaryKeyOnly) or (bPrimaryKeyOnly and colSource.Primary) Then
            If (FindColumn(tableTarget, colSource.Code) Is Nothing) Then
               Set colTarget = tableTarget.Columns.CreateNew
               CopyColumn colTarget, colSource
            End If
         End If
      Next
      SetPrimaryKeyColumnsOrder tableTarget, tableSource
   End If
End Sub

&#39; Copy primary key columns
Sub DatabaseCopyPrimaryKeyColumns(tableTarget, tableSource)
   CopyColumns tableTarget, tableSource, true
End Sub

&#39; Set primary key columns order
Sub SetPrimaryKeyColumnsOrder(tableTarget, tableSource)
   On Error Resume Next
   If (Not (tableSource Is Nothing)) and (Not (tableTarget Is Nothing)) Then
      Dim keySource, keyTarget, colSource, colTarget
      &#39; Find primary keys
      Set keySource = Nothing
      For Each keySource in tableSource.Keys
         If keySource.Primary Then
            Exit For
         End If
      Next
      Set keyTarget = Nothing
      For Each keyTarget in tableTarget.Keys
         If keyTarget.Primary Then
            Exit For
         End If
      Next
      If (Not (keySource Is Nothing)) and (Not (keyTarget Is Nothing)) Then
         &#39; Change columns order in primary key
         Dim nColSource, nColTarget, bFound
         nColSource = 0
         For Each colSource in keySource.Columns
            nColTarget = 0
            &#39; Try to move columns
            For Each colTarget in keyTarget.Columns
               If colTarget.Code = colSource.Code Then
                  If nColSource &lt;&gt; nColTarget Then
                     keyTarget.Columns.Move nColSource, nColTarget
                  End If
                  Exit For
               End If
               nColTarget = nColTarget + 1
            Next
            nColSource = nColSource + 1
         Next
      End If
   End If
End Sub

&#39; Copy column attributes
Sub CopyColumn(colTarget, colSource)
   On Error Resume Next
   If (Not (colSource Is Nothing)) and (Not (colTarget Is Nothing)) Then
      colTarget.SetNameAndCode colSource.Name, colSource.Code, false
      colTarget.Comment = colSource.Comment
      colTarget.Description = colSource.Description
      colTarget.Annotation = colSource.Annotation
      colTarget.Primary = colSource.Primary
      colTarget.DataType = GetColumnDataType(colSource)
   End if
End Sub

&#39; Get column data type
Function GetColumnDataType(col)
   On Error Resume Next
   GetColumnDataType = col.DataType
   If col.Model.DBMS.Family = &quot;ORACLE&quot; Then
      &#39; Use default scale for Oracle to avoid losing precision
      If (UCase(GetColumnDataType) = &quot;NUMERIC&quot;) or (UCase(GetColumnDataType) = &quot;NUMBER&quot;) Then
         GetColumnDataType = col.DataType + &quot;(38)&quot;
      End If
   End If
End Function

&#39; Create PK index
Sub CreatePKIndexe(table)
   On Error Resume Next
   If Not (table Is Nothing) Then
      If FindPKIndexe(table) is nothing Then
         Dim idx
         Set idx = table.Indexes.CreateNew
         idx.Primary = true
         If Not (table.PrimaryKey is Nothing) Then
            Set idx.LinkedObject = table.PrimaryKey
         End If
      End If
   End If
End Sub

&#39; Find a PK index
Function FindPKIndexe(table)
   On Error Resume Next
   Set FindPKIndexe = Nothing
   If Not (table Is Nothing) Then
      Dim index
      For Each index in table.Indexes
         If (index.Primary) Then
            Set FindPKIndexe = index
            Exit Function
         End If
      Next
   End If
End Function

&#39; Add a procedure in a database
Function AddProcedure(database, procName, procCode)
   On Error Resume Next
   Set AddProcedure = FindProcedure(database, procCode)
   If Not (AddProcedure Is Nothing) Then
      Exit Function
   End If

   If Not (database Is Nothing) Then
      Dim pdm, proc
      Set pdm = GetDatabasePDM(database)
      If Not (pdm is Nothing) Then
         Set proc = pdm.Procedures.CreateNew
         If Not (proc is Nothing) Then
            proc.SetNameAndCode procName, procCode, false
            Output &quot;   Adding the Stored Procedure &#39;&quot; + proc.Code + &quot;&#39;&quot;
            Set AddProcedure = proc
            Exit Function
         End If
      End If
   End If
End Function

&#39; Find a procedure by name
Function FindProcedure(database, procName)
   On Error Resume Next
   Set FindProcedure = Nothing
   If Not (database Is Nothing) Then
      Dim pdm, proc
      Set pdm = GetDatabasePDM(database)
      If Not (pdm is Nothing) Then
         For Each proc in pdm.Procedures
            If LCase(proc.Code) = LCase(procName) Then
               Set FindProcedure = proc
               Exit Function
            End If
         Next
      End If
   End If
End Function

&#39; Rebuild function strings for a replication process
Sub ProcessRebuildFunctionStrings(process, stagingDatabase, IQDatabase, bASEStagingDB, bDisplayTitle)
   On Error Resume Next
   If Not (process is Nothing) Then
      Dim conn, bFound
      bFound = False
      For Each conn in process.DataConnection
         If conn.DataStore.Type = &quot;IQStaging&quot; Then
            bFound = True
            Exit For
         End If
      Next
      If Not bFound Then
         Exit Sub
      End If
      
      If bDisplayTitle Then
         If MsgBox(&quot;This command will add missing Function Strings for the RepServer.  Do you want to continue?&quot;, vbYesNo + vbQuestion, &quot;Rebuild Function Strings&quot;) &lt;&gt; vbYes Then
            Exit Sub
         End If
      End If
      
      If bDisplayTitle Then
         Output &quot;&quot;
      End If
      Output &quot;Rebuilding Function Strings for the RepServer &#39;&quot; + process.Code + &quot;&#39;...&quot;

      &#39; Rebuild event scripts for articles
      Dim publish, article
      For Each publish in process.Publications
         For Each article in publish.Articles
            ArticleRebuildFunctionStrings article, stagingDatabase, IQDatabase, bASEStagingDB
         Next
      Next
      
      If bDisplayTitle Then
         Output &quot;Successfully rebuilt Function Strings.&quot;
      End If
   End If
End Sub

&#39; Rebuild function strings for an article
Sub ArticleRebuildFunctionStrings(article, stagingDatabase, IQDatabase, bASEStagingDB)
   On Error Resume Next
   If Not (article is Nothing) Then
      &#39; Get IQ Staging XEM
      Dim xem
      Set xem = GetIQStagingXEM(article)

      &#39; Get staging tables code
      Dim tabCode, tabCode26, tabCode23, insertTableCode, updateTableCode, deleteTableCode, insertProcCode, updateProcCode, deleteProcCode
      If article.RemoteTable &lt;&gt; &quot;&quot; Then
         tabCode = article.RemoteTable
      Else
         tabCode = article.Code
      End If
      &#39; Limit table code length
      tabCode   = UCase(Left(tabCode, 30))
      tabCode26 = Left(tabCode, 26)
      tabCode23 = Left(tabCode, 23)
      insertTableCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;InsertStagingTableCode&quot;)
      updateTableCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;UpdateStagingTableCode&quot;)
      deleteTableCode = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;DeleteStagingTableCode&quot;)
      insertProcCode  = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;InsertProcedureCode&quot;)
      updateProcCode  = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;UpdateProcedureCode&quot;)
      deleteProcCode  = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;DeleteProcedureCode&quot;)
      insertTableCode = Replace(insertTableCode, &quot;&lt;Table&gt;&quot;, tabCode26)
      updateTableCode = Replace(updateTableCode, &quot;&lt;Table&gt;&quot;, tabCode26)
      deleteTableCode = Replace(deleteTableCode, &quot;&lt;Table&gt;&quot;, tabCode26)
      insertProcCode  = Replace(insertProcCode , &quot;&lt;Table&gt;&quot;, tabCode23)
      updateProcCode  = Replace(updateProcCode , &quot;&lt;Table&gt;&quot;, tabCode23)
      deleteProcCode  = Replace(deleteProcCode , &quot;&lt;Table&gt;&quot;, tabCode23)
      &#39; Limit table code length
      insertTableCode = UCase(Left(insertTableCode, 30))
      updateTableCode = UCase(Left(updateTableCode, 30))
      deleteTableCode = UCase(Left(deleteTableCode, 30))
      &#39; Limit procedure code length
      insertProcCode  = UCase(Left(insertProcCode, 30))
      updateProcCode  = UCase(Left(updateProcCode, 30))
      deleteProcCode  = UCase(Left(deleteProcCode, 30))
   
      Dim bUseProcedure
      bUseProcedure = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;UseProcedureForFunctionString&quot;)

      Dim stgPDM, diagram
      Set stgPDM = GetDatabasePDM(stagingDatabase)
      Set diagram = Nothing
      If Not (stgPDM is Nothing)Then
         Set diagram = stgPDM.DefaultDiagram
      End If

      Dim funcString, script, proc, procName, procCode

      &#39; Add rs_insert function string
      Set funcString = ArticleAddFunctionString(article, &quot;rs_insert&quot;)
      If bUseProcedure Then
         script = article.EvaluateTemplate(&quot;rsInsertUseProc&quot;, xem)
      Else
         script = article.EvaluateTemplate(&quot;rsInsert&quot;, xem)
      End If
      script = Replace(script, &quot;&lt;Table&gt;&quot;          , tabCode)
      script = Replace(script, &quot;&lt;InsertTable&gt;&quot;    , insertTableCode)
      script = Replace(script, &quot;&lt;UpdateTable&gt;&quot;    , updateTableCode)
      script = Replace(script, &quot;&lt;DeleteTable&gt;&quot;    , deleteTableCode)
      script = Replace(script, &quot;&lt;InsertProcedure&gt;&quot;, insertProcCode)
      script = Replace(script, &quot;&lt;UpdateProcedure&gt;&quot;, updateProcCode)
      script = Replace(script, &quot;&lt;DeleteProcedure&gt;&quot;, deleteProcCode)
      funcString.Script = script

      &#39; Add stored procedure for rs_insert
      If bUseProcedure Then
         procName = article.EvaluateTemplate(&quot;rsInsertProcName&quot;, xem)
         procName = Replace(procName, &quot;&lt;Table&gt;&quot;, tabCode)
         procCode = insertProcCode
         Set proc = AddProcedure(stagingDatabase, procName, procCode)
         proc.Comment = article.EvaluateTemplate(&quot;rsInsertProcComment&quot;, xem)
         script = article.EvaluateTemplate(&quot;rsInsertProcDefinition&quot;, xem)
         script = Replace(script, &quot;&lt;Table&gt;&quot;          , tabCode)
         script = Replace(script, &quot;&lt;InsertTable&gt;&quot;    , insertTableCode)
         script = Replace(script, &quot;&lt;UpdateTable&gt;&quot;    , updateTableCode)
         script = Replace(script, &quot;&lt;DeleteTable&gt;&quot;    , deleteTableCode)
         script = Replace(script, &quot;&lt;InsertProcedure&gt;&quot;, insertProcCode)
         script = Replace(script, &quot;&lt;UpdateProcedure&gt;&quot;, updateProcCode)
         script = Replace(script, &quot;&lt;DeleteProcedure&gt;&quot;, deleteProcCode)
         proc.Text = script
         If (Not diagram is Nothing) Then
            If diagram.FindSymbol(proc) is Nothing Then
               diagram.AttachObject proc
            End If
         End If
      End If
      
      &#39; Add rs_update function string
      Dim bSupportUpdate
      bSupportUpdate = IQDatabase.GetExtendedAttribute(IQStagingTarget + &quot;SupportUpdateInIQ&quot;)
      Set funcString = ArticleAddFunctionString(article, &quot;rs_update&quot;)
      If bUseProcedure Then
         script = article.EvaluateTemplate(&quot;rsUpdateUseProc&quot;, xem)
      Else
         If bSupportUpdate Then
            script = article.EvaluateTemplate(&quot;rsUpdateUseUpdate&quot;, xem)
         Else
            script = article.EvaluateTemplate(&quot;rsUpdate&quot;, xem)
         End If
      End If
      script = Replace(script, &quot;&lt;Table&gt;&quot;          , tabCode)
      script = Replace(script, &quot;&lt;InsertTable&gt;&quot;    , insertTableCode)
      script = Replace(script, &quot;&lt;UpdateTable&gt;&quot;    , updateTableCode)
      script = Replace(script, &quot;&lt;DeleteTable&gt;&quot;    , deleteTableCode)
      script = Replace(script, &quot;&lt;InsertProcedure&gt;&quot;, insertProcCode)
      script = Replace(script, &quot;&lt;UpdateProcedure&gt;&quot;, updateProcCode)
      script = Replace(script, &quot;&lt;DeleteProcedure&gt;&quot;, deleteProcCode)
      funcString.Script = script

      &#39; Add stored procedure for rs_update
      If bUseProcedure Then
         procName = article.EvaluateTemplate(&quot;rsUpdateProcName&quot;, xem)
         procName = Replace(procName, &quot;&lt;Table&gt;&quot;, tabCode)
         procCode = updateProcCode
         Set proc = AddProcedure(stagingDatabase, procName, procCode)
         proc.Comment = article.EvaluateTemplate(&quot;rsUpdateProcComment&quot;, xem)
         If bSupportUpdate Then
            script = article.EvaluateTemplate(&quot;rsUpdateProcDefinitionUseUpdate&quot;, xem)
         Else
            script = article.EvaluateTemplate(&quot;rsUpdateProcDefinition&quot;, xem)
         End If
         script = Replace(script, &quot;&lt;Table&gt;&quot;          , tabCode)
         script = Replace(script, &quot;&lt;InsertTable&gt;&quot;    , insertTableCode)
         script = Replace(script, &quot;&lt;UpdateTable&gt;&quot;    , updateTableCode)
         script = Replace(script, &quot;&lt;DeleteTable&gt;&quot;    , deleteTableCode)
         script = Replace(script, &quot;&lt;InsertProcedure&gt;&quot;, insertProcCode)
         script = Replace(script, &quot;&lt;UpdateProcedure&gt;&quot;, updateProcCode)
         script = Replace(script, &quot;&lt;DeleteProcedure&gt;&quot;, deleteProcCode)
         proc.Text = script
         If (Not diagram is Nothing) Then
            If diagram.FindSymbol(proc) is Nothing Then
               diagram.AttachObject proc
            End If
         End If
      End If

      &#39; Add rs_delete function string
      Set funcString = ArticleAddFunctionString(article, &quot;rs_delete&quot;)
      If bUseProcedure Then
         script = article.EvaluateTemplate(&quot;rsDeleteUseProc&quot;, xem)
      Else
         If bSupportUpdate Then
            script = article.EvaluateTemplate(&quot;rsDeleteUseUpdate&quot;, xem)
         Else
            script = article.EvaluateTemplate(&quot;rsDelete&quot;, xem)
         End If
      End If
      script = Replace(script, &quot;&lt;Table&gt;&quot;          , tabCode)
      script = Replace(script, &quot;&lt;InsertTable&gt;&quot;    , insertTableCode)
      script = Replace(script, &quot;&lt;UpdateTable&gt;&quot;    , updateTableCode)
      script = Replace(script, &quot;&lt;DeleteTable&gt;&quot;    , deleteTableCode)
      script = Replace(script, &quot;&lt;InsertProcedure&gt;&quot;, insertProcCode)
      script = Replace(script, &quot;&lt;UpdateProcedure&gt;&quot;, updateProcCode)
      script = Replace(script, &quot;&lt;DeleteProcedure&gt;&quot;, deleteProcCode)
      funcString.Script = script

      &#39; Add stored procedure for rs_delete
      If bUseProcedure Then
         procName = article.EvaluateTemplate(&quot;rsDeleteProcName&quot;, xem)
         procName = Replace(procName, &quot;&lt;Table&gt;&quot;, tabCode)
         procCode = deleteProcCode
         Set proc = AddProcedure(stagingDatabase, procName, procCode)
         proc.Comment = article.EvaluateTemplate(&quot;rsDeleteProcComment&quot;, xem)
         If bSupportUpdate Then
            script = article.EvaluateTemplate(&quot;rsDeleteProcDefinitionUseUpdate&quot;, xem)
         Else
            script = article.EvaluateTemplate(&quot;rsDeleteProcDefinition&quot;, xem)
         End If
         script = Replace(script, &quot;&lt;Table&gt;&quot;          , tabCode)
         script = Replace(script, &quot;&lt;InsertTable&gt;&quot;    , insertTableCode)
         script = Replace(script, &quot;&lt;UpdateTable&gt;&quot;    , updateTableCode)
         script = Replace(script, &quot;&lt;DeleteTable&gt;&quot;    , deleteTableCode)
         script = Replace(script, &quot;&lt;InsertProcedure&gt;&quot;, insertProcCode)
         script = Replace(script, &quot;&lt;UpdateProcedure&gt;&quot;, updateProcCode)
         script = Replace(script, &quot;&lt;DeleteProcedure&gt;&quot;, deleteProcCode)
         proc.Text = script
         If (Not diagram is Nothing) Then
            If diagram.FindSymbol(proc) is Nothing Then
               diagram.AttachObject proc
            End If
         End If
      End If
   End If
End Sub

&#39; Add a function string for an article
Function ArticleAddFunctionString(article, eventName)
   On Error Resume Next
   Set ArticleAddFunctionString = Nothing
   If (Not (article is Nothing)) and (eventName &lt;&gt; &quot;&quot;) Then
      Dim evt
      &#39; Search existing event script
      Set evt = ArticleFindFunctionString(article, eventName)
      If Not (evt is Nothing) Then
         Exit Function
      End If
      &#39; Add event script
      set evt = article.EventScripts.CreateNew
      If Not (evt is Nothing) Then
         evt.Event   = eventName
         Output &quot;   Adding the Function String &#39;&quot; + eventName + &quot;&#39; for the Replication Definition &#39;&quot; + article.Code + &quot;&#39;&quot;
         Set ArticleAddFunctionString = evt
      End If
   End If
End Function

&#39; Find a function string for an article
Function ArticleFindFunctionString(article, eventName)
   On Error Resume Next
   Set ArticleFindFunctionString = Nothing
   If (Not (article is Nothing)) and (eventName &lt;&gt; &quot;&quot;) Then
      Dim evt
      &#39; Search existing event script
      For Each evt in article.EventScripts
         If (evt.Event = eventName) Then
            Set ArticleFindFunctionString = evt
            Exit Function
         End If
      Next
   End If
End Function
</a:CheckGlobalScript>
<c:Categories>
<o:TargetCategory Id="o2">
<a:ObjectID>1EF473BB-0486-4B8C-BE26-8ADC0A2E0162</a:ObjectID>
<a:Name>Generation</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
</o:TargetCategory>
<o:ProfileTargetItem Id="o3">
<a:ObjectID>E4F4254A-28A8-42AD-985A-BEF2089B0E3D</a:ObjectID>
<a:Name>Profile</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TargetCategory Id="o4">
<a:ObjectID>22A36F0B-04AC-4CAA-BC91-AC8FAF3968DE</a:ObjectID>
<a:Name>Shared</a:Name>
<a:Code>Shared</a:Code>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o5">
<a:TypePublicName>ExtendedAttributeTypeTargetItem</a:TypePublicName>
<a:ObjectID>65732A64-050D-4D19-AAEB-F65E94657540</a:ObjectID>
<a:Name>Extended Attribute Types</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTypeTargetItem Id="o6">
<a:ObjectID>604C82A3-C61B-4095-8AFE-FFA41FA9C424</a:ObjectID>
<a:Name>ASE StagingDatabaseDBMSType</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>1388998726</a:ModificationDate>
<a:Modifier>I063968</a:Modifier>
<a:Comment>ASE staging database DBMS type</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTypeTargetItem.Value>SAP Sybase AS Enterprise 16.0</a:ExtendedAttributeTypeTargetItem.Value>
<a:ExtendedAttributeTypeTargetItem.ListOfValues>Sybase AS Enterprise 11.0
Sybase AS Enterprise 11.5-11.9
Sybase AS Enterprise 12.0
Sybase AS Enterprise 12.5
Sybase AS Enterprise 12.5.1
Sybase AS Enterprise 12.5.2
Sybase AS Enterprise 12.5.3a
Sybase AS Enterprise 15.0
Sybase AS Enterprise 15.0.2
Sybase AS Enterprise 15.5
Sybase AS Enterprise 15.7
SAP Sybase AS Enterprise 16.0</a:ExtendedAttributeTypeTargetItem.ListOfValues>
</o:ExtendedAttributeTypeTargetItem>
<o:ExtendedAttributeTypeTargetItem Id="o7">
<a:ObjectID>947B36AC-3F6B-4AE6-A0F3-7477C7F83922</a:ObjectID>
<a:Name>ASAStagingDatabaseDBMSType</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>1388998726</a:ModificationDate>
<a:Modifier>I063968</a:Modifier>
<a:Comment>ASA staging database DBMS type</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTypeTargetItem.Value>Sybase SQL Anywhere 16</a:ExtendedAttributeTypeTargetItem.Value>
<a:ExtendedAttributeTypeTargetItem.ListOfValues>Sybase AS Anywhere 9
Sybase SQL Anywhere 10
Sybase SQL Anywhere 11
Sybase SQL Anywhere 12
Sybase SQL Anywhere 16</a:ExtendedAttributeTypeTargetItem.ListOfValues>
</o:ExtendedAttributeTypeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TargetCategory>
<o:MetaClassTargetItem Id="o8">
<a:ObjectID>7C9F0B44-FB99-49B8-985B-EE85D586EAF7</a:ObjectID>
<a:Name>Database</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o9">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>5F28C4AC-D7E9-4550-8DF1-39D01EDE8674</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o10">
<a:ObjectID>CC5C2137-8BF6-42AC-8A3C-ADD863E6151C</a:ObjectID>
<a:Name>Helpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o11">
<a:ObjectID>892B5F74-B06F-4EA4-91DE-7272C2DECAA7</a:ObjectID>
<a:Name>getDBFamily</a:Name>
<a:TemplateTargetItem.Value>.ifnot (%SourceModels.IsEmpty%)
   .if (%SourceModels.First.Shortcut.TargetObject%)
%SourceModels.First.DBMS.Family%
   .endif
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o12">
<a:ObjectID>F0F33418-978B-45F5-8848-1CABD6FC4E7E</a:ObjectID>
<a:Name>isIQ</a:Name>
<a:TemplateTargetItem.Value>.bool (%getDBFamily% == &quot;ADAPTIVE IQ&quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o13">
<a:ObjectID>EC0510A3-E19B-4779-B3FE-78814C6D66BB</a:ObjectID>
<a:Name>isRemoteDatabase</a:Name>
<a:TemplateTargetItem.Value>.set_value(_isRemoteDatabase, false, new)
.foreach_item(DataConnections)
   .if (%Process.ObjectType% == &quot;ReplicationProcess&quot;)
      .if (%Process.isRepServer%)
         .foreach_item(Subscriptions)
            .set_value(_isRemoteDatabase, true)
         .next
      .endif
   .endif
.next
%_isRemoteDatabase%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o14">
<a:ObjectID>D0225ACF-17D6-4C1C-8985-4286F6CFA6EC</a:ObjectID>
<a:Name>StagingDB</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o15">
<a:ObjectID>2751FF7E-2B09-4BF1-9955-1052807FA038</a:ObjectID>
<a:Name>stgServerName</a:Name>
<a:TemplateTargetItem.Value>.if (%Server%)
%Server.Code%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o16">
<a:ObjectID>7865D74B-093B-490A-BCE1-5EEBDB7F14B0</a:ObjectID>
<a:Name>stgDatabaseName</a:Name>
<a:TemplateTargetItem.Value>%Code%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o17">
<a:ObjectID>2C085355-5BED-498A-B77E-A3ABC6A18A05</a:ObjectID>
<a:Name>stgDatabaseComment</a:Name>
<a:TemplateTargetItem.Value>IQ staging database</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o18">
<a:TypePublicName>CriterionTargetItem</a:TypePublicName>
<a:ObjectID>3DCA21D4-BF99-420D-A557-4AE2DAA1A9BE</a:ObjectID>
<a:Name>Criteria</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CriterionTargetItem Id="o19">
<a:ObjectID>035F2B9D-00D2-4B07-B54E-C21330F550D5</a:ObjectID>
<a:Name>isIQ</a:Name>
<a:CriterionTargetItem.Value>%isIQ%</a:CriterionTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o20">
<a:TypePublicName>ExtendedAttributeTargetItem</a:TypePublicName>
<a:ObjectID>C18D637C-0DA1-4018-B762-17BB53CAC76B</a:ObjectID>
<a:Name>Extended Attributes</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:ExtendedAttributeTargetItem Id="o21">
<a:ObjectID>1816C1AD-2C67-4579-A827-E00CAAA55ABF</a:ObjectID>
<a:Name>ASEStagingDatabaseDBMS</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>1388998726</a:ModificationDate>
<a:Modifier>I063968</a:Modifier>
<a:Comment>ASE staging database DBMS</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>-1</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>SAP Sybase AS Enterprise 16.0</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
<c:ExtendedAttributeType>
<o:ExtendedAttributeTypeTargetItem Ref="o6"/>
</c:ExtendedAttributeType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o22">
<a:ObjectID>1D927841-72C5-4B5A-95C0-07E5601BCB84</a:ObjectID>
<a:Name>StagingDatabaseName</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Staging database name</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>Staging database</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o23">
<a:ObjectID>53A27DEE-2382-4F4A-B48B-54C4324D7084</a:ObjectID>
<a:Name>StagingDatabaseCode</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Staging database code</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>StagingDB</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o24">
<a:ObjectID>BF350F3A-D007-43B3-8A24-EF2DA92C11BE</a:ObjectID>
<a:Name>StagingServerName</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Staging database server name</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o25">
<a:ObjectID>07642AF3-B856-4575-8691-5F7BB01FE993</a:ObjectID>
<a:Name>StagingServerCode</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Staging database server code</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o26">
<a:ObjectID>25CA4DE0-8866-41B2-BB8B-5BD472CA82A6</a:ObjectID>
<a:Name>UseInsertStagingTableInIQ</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Use an insert staging table in IQ to copy inserted rows from staging database into this table to support transformation inside IQ</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o27">
<a:ObjectID>F313B4B4-03E1-40D7-8030-8773982DA4FD</a:ObjectID>
<a:Name>SupportUpdateInIQ</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Support update in IQ.  If true, a update will cause a update in IQ.  If false, update will be replaced by delete and insert.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>false</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o28">
<a:ObjectID>00056D16-ECA0-4CFF-BDE7-FFB2F44EC51D</a:ObjectID>
<a:Name>InsertStagingTableCode</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Insert staging table code template</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>&lt;Table&gt;_inserted</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o29">
<a:ObjectID>BF25DD36-3B3B-4DDE-8535-EA49857581DF</a:ObjectID>
<a:Name>UpdateStagingTableCode</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Update staging table code template</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>&lt;Table&gt;_updated</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o30">
<a:ObjectID>2F76C7C9-AB89-4584-9352-A01F4D884F93</a:ObjectID>
<a:Name>DeleteStagingTableCode</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Delete staging table code template</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>&lt;Table&gt;_deleted</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o31">
<a:ObjectID>C03AE486-6A28-41CD-8176-3BE0C73ECE96</a:ObjectID>
<a:Name>UseProcedureForFunctionString</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Use stored procedure for function string</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.Value>true</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o32">
<a:ObjectID>649AEAD4-8199-434A-9189-9A646072FC20</a:ObjectID>
<a:Name>InsertProcedureCode</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Stored procedure code template for rs_insert</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>sp_ins_&lt;Table&gt;</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o33">
<a:ObjectID>0F3C7608-3E28-4EF1-AF1F-33E02A2C7DB4</a:ObjectID>
<a:Name>UpdateProcedureCode</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Stored procedure code template for rs_update</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>sp_upd_&lt;Table&gt;</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o34">
<a:ObjectID>38361645-BB06-4812-A347-00CD15B6583E</a:ObjectID>
<a:Name>DeleteProcedureCode</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Stored procedure code template for rs_delete</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>12</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>sp_del_&lt;Table&gt;</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
</o:ExtendedAttributeTargetItem>
<o:ExtendedAttributeTargetItem Id="o35">
<a:ObjectID>6D389F4A-CFD7-4216-AF22-2F2F5543C117</a:ObjectID>
<a:Name>ASAStagingDatabaseDBMS</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>1388998726</a:ModificationDate>
<a:Modifier>I063968</a:Modifier>
<a:Comment>ASA staging database DBMS</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:ExtendedAttributeTargetItem.DataType>-1</a:ExtendedAttributeTargetItem.DataType>
<a:ExtendedAttributeTargetItem.Value>Sybase SQL Anywhere 16</a:ExtendedAttributeTargetItem.Value>
<a:ValidateDataType>0</a:ValidateDataType>
<c:ExtendedAttributeType>
<o:ExtendedAttributeTypeTargetItem Ref="o7"/>
</c:ExtendedAttributeType>
</o:ExtendedAttributeTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o36">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>F9FDF319-6069-484E-AF38-3A75F4224BDC</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o37">
<a:ObjectID>7E093FF5-D8F9-4CAD-8B1B-6BEFDC1193A7</a:ObjectID>
<a:Name>IQ</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o38">
<a:ObjectID>79F67D9B-D685-48E9-808F-162E9303655B</a:ObjectID>
<a:Name>iqLoadStgProcName</a:Name>
<a:TemplateTargetItem.Value>Load staging</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o39">
<a:ObjectID>FBE264A8-F192-4DB6-83EA-B841B1F36B8E</a:ObjectID>
<a:Name>iqLoadStgProcCode</a:Name>
<a:TemplateTargetItem.Value>IQ_LOAD_STAGING</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o40">
<a:ObjectID>57C072D1-1EC5-4EE5-9D8A-F8A15AAF6C21</a:ObjectID>
<a:Name>iqLoadStgProcComment</a:Name>
<a:TemplateTargetItem.Value>This stored procedure loads data from the staging database into the staging tables</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o41">
<a:ObjectID>C683D3A6-B4A0-4674-AB5A-12CB3ACAF9C1</a:ObjectID>
<a:Name>iqLoadStgProcDefinition</a:Name>
<a:TemplateTargetItem.Value>create procedure \[%%QUALIFIER%%\]%%PROC%% ()
begin
[   %iqLoadStgTables%\n]\
end</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o42">
<a:ObjectID>EE57E465-46F3-4845-84C7-799DA6CD37D4</a:ObjectID>
<a:Name>iqLoadStgTables</a:Name>
<a:TemplateTargetItem.Value>.set_value(_insertStagingTableCode, %InsertStagingTableCode%, new)
.set_value(_updateStagingTableCode, %UpdateStagingTableCode%, new)
.set_value(_deleteStagingTableCode, %DeleteStagingTableCode%, new)
.set_value(_bUseInsertStagingTableInIQ, %UseInsertStagingTableInIQ%, new)
.set_value(_bSupportUpdateInIQ, %SupportUpdateInIQ%, new)
.foreach_item(SourceModels)
   .foreach_item(Tables)
      .if (%Stereotype% &lt;&gt; &quot;Staging&quot;)
%iqLoadStgTable%
      .endif(\n\n)
   .next
   .break
.next
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o43">
<a:ObjectID>D39E2E59-1F29-41A7-86DB-5B3EAF892BB0</a:ObjectID>
<a:Name>StagingDB</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o44">
<a:ObjectID>DD5D6F67-54E7-4935-8CB8-BC35951E71AD</a:ObjectID>
<a:Name>stgCleanStgTables</a:Name>
<a:TemplateTargetItem.Value>.set_value(_insertStagingTableCode, %InsertStagingTableCode%, new)
.set_value(_updateStagingTableCode, %UpdateStagingTableCode%, new)
.set_value(_deleteStagingTableCode, %DeleteStagingTableCode%, new)
.set_value(_bUseInsertStagingTableInIQ, %UseInsertStagingTableInIQ%, new)
.set_value(_bSupportUpdateInIQ, %SupportUpdateInIQ%, new)
.foreach_item(SourceModels)
   .foreach_item(Tables)
      .if (%Stereotype% &lt;&gt; &quot;Staging&quot;)
%stgCleanStgTable%
      .endif(\n\n)
   .next
   .break
.next
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o45">
<a:ObjectID>33DB25A7-90FA-4368-A801-B32431A944B4</a:ObjectID>
<a:Name>stgCleanStgProcCode</a:Name>
<a:TemplateTargetItem.Value>IQ_CLEAN_STAGING</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o46">
<a:ObjectID>B4FD92FF-F3B2-49EF-806C-18329837E9D7</a:ObjectID>
<a:Name>stgCleanStgProcComment</a:Name>
<a:TemplateTargetItem.Value>This stored procedure cleans the staging tables content</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o47">
<a:ObjectID>1212E527-908B-4402-8991-2932DB0DACE1</a:ObjectID>
<a:Name>stgASECleanStgProcDefinition</a:Name>
<a:TemplateTargetItem.Value>.set_value(_statementTerminator, &quot;&quot;, new)
create procedure \[%%QUALIFIER%%\]%%PROC%% as
begin
   -- Clean staging tables
 [   %stgCleanStgTables%\n]\
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o48">
<a:ObjectID>75FFB749-AC11-45F6-A35A-F5A579BC8985</a:ObjectID>
<a:Name>stgCleanStgProcName</a:Name>
<a:TemplateTargetItem.Value>Clean staging tables</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o49">
<a:ObjectID>C49B4D0D-F1C5-4D74-8001-BA648D0ABD96</a:ObjectID>
<a:Name>stgASACleanStgProcDefinition</a:Name>
<a:TemplateTargetItem.Value>.set_value(_statementTerminator, &quot;;&quot;, new)
create procedure \[%%QUALIFIER%%\]%%PROC%%()
begin
   -- Clean staging tables
 [   %stgCleanStgTables%\n]\
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o50">
<a:TypePublicName>FormTargetItem</a:TypePublicName>
<a:ObjectID>9750DC7C-2812-4CD1-844D-70382D601585</a:ObjectID>
<a:Name>Forms</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:FormTargetItem Id="o51">
<a:ObjectID>74EDEC97-342B-4BF1-B395-A17DE04CD3DE</a:ObjectID>
<a:Name>Staging Database</a:Name>
<a:FormTargetItem.Value>&lt;Form  &gt;
   &lt;ExtendedAttribute Name=&quot;StagingDatabaseName&quot; Caption=&quot;Database name&quot; Attribute=&quot;StagingDatabaseName&quot; AttributeID=&quot;{1D927841-72C5-4B5A-95C0-07E5601BCB84}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingDatabaseCode&quot; Caption=&quot;Database code&quot; Attribute=&quot;StagingDatabaseCode&quot; AttributeID=&quot;{53A27DEE-2382-4F4A-B48B-54C4324D7084}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingServerName&quot; Caption=&quot;Server name&quot; Attribute=&quot;StagingServerName&quot; AttributeID=&quot;{BF350F3A-D007-43B3-8A24-EF2DA92C11BE}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingServerCode&quot; Caption=&quot;Server code&quot; Attribute=&quot;StagingServerCode&quot; AttributeID=&quot;{07642AF3-B856-4575-8691-5F7BB01FE993}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;VerticalLayout Name=&quot;VerticalLayout1&quot;   &gt;
      &lt;HorizontalLayout Name=&quot;HorizontalLayout1&quot;   &gt;
         &lt;ExtendedAttribute Name=&quot;UseInsertStagingTableInIQ&quot; Caption=&quot;Use insert table in Sybase IQ&quot; Attribute=&quot;UseInsertStagingTableInIQ&quot; AttributeID=&quot;{25CA4DE0-8866-41B2-BB8B-5BD472CA82A6}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
         &lt;ExtendedAttribute Name=&quot;SupportUpdateInIQ&quot; Caption=&quot;Support update in Sybase IQ&quot; Attribute=&quot;SupportUpdateInIQ&quot; AttributeID=&quot;{F313B4B4-03E1-40D7-8030-8773982DA4FD}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;/HorizontalLayout&gt;
   &lt;/VerticalLayout&gt;
   &lt;ExtendedAttribute Name=&quot;InsertStagingTableCode&quot; Caption=&quot;Insert table code&quot; Attribute=&quot;InsertStagingTableCode&quot; AttributeID=&quot;{00056D16-ECA0-4CFF-BDE7-FFB2F44EC51D}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;UpdateStagingTableCode&quot; Caption=&quot;Update table code&quot; Attribute=&quot;UpdateStagingTableCode&quot; AttributeID=&quot;{BF25DD36-3B3B-4DDE-8535-EA49857581DF}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;DeleteStagingTableCode&quot; Caption=&quot;Delete table code&quot; Attribute=&quot;DeleteStagingTableCode&quot; AttributeID=&quot;{2F76C7C9-AB89-4584-9352-A01F4D884F93}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;GroupBox Name=&quot;GroupBox1&quot;    ControlAsLabel=&quot;Yes&quot; &gt;
      &lt;ExtendedAttribute Name=&quot;UseProcedureForFunctionString&quot; Caption=&quot;Use stored procedure for function strings&quot; Attribute=&quot;UseProcedureForFunctionString&quot; AttributeID=&quot;{C03AE486-6A28-41CD-8176-3BE0C73ECE96}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;ExtendedAttribute Name=&quot;InsertProcedureCode&quot; Caption=&quot;Insert procedure code&quot; Attribute=&quot;InsertProcedureCode&quot; AttributeID=&quot;{649AEAD4-8199-434A-9189-9A646072FC20}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;ExtendedAttribute Name=&quot;UpdateProcedureCode&quot; Caption=&quot;Update procedure code&quot; Attribute=&quot;UpdateProcedureCode&quot; AttributeID=&quot;{0F3C7608-3E28-4EF1-AF1F-33E02A2C7DB4}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;ExtendedAttribute Name=&quot;DeleteProcedureCode&quot; Caption=&quot;Delete procedure code&quot; Attribute=&quot;DeleteProcedureCode&quot; AttributeID=&quot;{38361645-BB06-4812-A347-00CD15B6583E}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;/GroupBox&gt;
&lt;/Form&gt;
</a:FormTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:FormTargetItem>
<o:FormTargetItem Id="o52">
<a:ObjectID>71099F42-5C29-4A37-A2E5-633D20090D3E</a:ObjectID>
<a:Name>Add an ASE Staging Database for the IQ Database</a:Name>
<a:FormTargetItem.Value>&lt;Form  &gt;
   &lt;ExtendedAttribute Name=&quot;ASEStagingDatabaseDBMS&quot; Caption=&quot;ASE version&quot; Attribute=&quot;ASEStagingDatabaseDBMS&quot; AttributeID=&quot;{1816C1AD-2C67-4579-A827-E00CAAA55ABF}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;Yes&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingDatabaseName&quot; Caption=&quot;Database name&quot; Attribute=&quot;StagingDatabaseName&quot; AttributeID=&quot;{1D927841-72C5-4B5A-95C0-07E5601BCB84}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingDatabaseCode&quot; Caption=&quot;Database code&quot; Attribute=&quot;StagingDatabaseCode&quot; AttributeID=&quot;{53A27DEE-2382-4F4A-B48B-54C4324D7084}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingServerName&quot; Caption=&quot;Server name&quot; Attribute=&quot;StagingServerName&quot; AttributeID=&quot;{BF350F3A-D007-43B3-8A24-EF2DA92C11BE}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingServerCode&quot; Caption=&quot;Server code&quot; Attribute=&quot;StagingServerCode&quot; AttributeID=&quot;{07642AF3-B856-4575-8691-5F7BB01FE993}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;VerticalLayout Name=&quot;VerticalLayout1&quot;   &gt;
      &lt;HorizontalLayout Name=&quot;HorizontalLayout1&quot;   &gt;
         &lt;ExtendedAttribute Name=&quot;UseInsertStagingTableInIQ&quot; Caption=&quot;Use insert table in Sybase IQ&quot; Attribute=&quot;UseInsertStagingTableInIQ&quot; AttributeID=&quot;{25CA4DE0-8866-41B2-BB8B-5BD472CA82A6}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
         &lt;ExtendedAttribute Name=&quot;SupportUpdateInIQ&quot; Caption=&quot;Support update in Sybase IQ&quot; Attribute=&quot;SupportUpdateInIQ&quot; AttributeID=&quot;{F313B4B4-03E1-40D7-8030-8773982DA4FD}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;/HorizontalLayout&gt;
   &lt;/VerticalLayout&gt;
   &lt;ExtendedAttribute Name=&quot;InsertStagingTableCode&quot; Caption=&quot;Insert table code&quot; Attribute=&quot;InsertStagingTableCode&quot; AttributeID=&quot;{00056D16-ECA0-4CFF-BDE7-FFB2F44EC51D}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;UpdateStagingTableCode&quot; Caption=&quot;Update table code&quot; Attribute=&quot;UpdateStagingTableCode&quot; AttributeID=&quot;{BF25DD36-3B3B-4DDE-8535-EA49857581DF}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;DeleteStagingTableCode&quot; Caption=&quot;Delete table code&quot; Attribute=&quot;DeleteStagingTableCode&quot; AttributeID=&quot;{2F76C7C9-AB89-4584-9352-A01F4D884F93}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;GroupBox Name=&quot;GroupBox1&quot;    ControlAsLabel=&quot;Yes&quot; &gt;
      &lt;ExtendedAttribute Name=&quot;UseProcedureForFunctionString&quot; Caption=&quot;Use stored procedure for function strings&quot; Attribute=&quot;UseProcedureForFunctionString&quot; AttributeID=&quot;{C03AE486-6A28-41CD-8176-3BE0C73ECE96}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;ExtendedAttribute Name=&quot;InsertProcedureCode&quot; Caption=&quot;Insert procedure code&quot; Attribute=&quot;InsertProcedureCode&quot; AttributeID=&quot;{649AEAD4-8199-434A-9189-9A646072FC20}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;ExtendedAttribute Name=&quot;UpdateProcedureCode&quot; Caption=&quot;Update procedure code&quot; Attribute=&quot;UpdateProcedureCode&quot; AttributeID=&quot;{0F3C7608-3E28-4EF1-AF1F-33E02A2C7DB4}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;ExtendedAttribute Name=&quot;DeleteProcedureCode&quot; Caption=&quot;Delete procedure code&quot; Attribute=&quot;DeleteProcedureCode&quot; AttributeID=&quot;{38361645-BB06-4812-A347-00CD15B6583E}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;/GroupBox&gt;   
&lt;/Form&gt;
</a:FormTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Add an ASE staging database for the IQ database</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:FormType>Dialog</a:FormType>
</o:FormTargetItem>
<o:FormTargetItem Id="o53">
<a:ObjectID>26BF776E-E49C-40D6-8A9C-1CC092607A6F</a:ObjectID>
<a:Name>Add a SQL Anywhere Staging Database for the IQ Database</a:Name>
<a:FormTargetItem.Value>&lt;Form  &gt;
   &lt;ExtendedAttribute Name=&quot;ASAStagingDatabaseDBMS&quot; Caption=&quot;SQL Anywhere version&quot; Attribute=&quot;ASAStagingDatabaseDBMS&quot; AttributeID=&quot;{6D389F4A-CFD7-4216-AF22-2F2F5543C117}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;Yes&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingDatabaseName&quot; Caption=&quot;Database name&quot; Attribute=&quot;StagingDatabaseName&quot; AttributeID=&quot;{1D927841-72C5-4B5A-95C0-07E5601BCB84}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingDatabaseCode&quot; Caption=&quot;Database code&quot; Attribute=&quot;StagingDatabaseCode&quot; AttributeID=&quot;{53A27DEE-2382-4F4A-B48B-54C4324D7084}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingServerName&quot; Caption=&quot;Server name&quot; Attribute=&quot;StagingServerName&quot; AttributeID=&quot;{BF350F3A-D007-43B3-8A24-EF2DA92C11BE}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;StagingServerCode&quot; Caption=&quot;Server code&quot; Attribute=&quot;StagingServerCode&quot; AttributeID=&quot;{07642AF3-B856-4575-8691-5F7BB01FE993}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; HorizontalResize=&quot;Yes&quot; /&gt;
   &lt;VerticalLayout Name=&quot;VerticalLayout1&quot;   &gt;
      &lt;HorizontalLayout Name=&quot;HorizontalLayout1&quot;   &gt;
         &lt;ExtendedAttribute Name=&quot;UseInsertStagingTableInIQ&quot; Caption=&quot;Use insert table in Sybase IQ&quot; Attribute=&quot;UseInsertStagingTableInIQ&quot; AttributeID=&quot;{25CA4DE0-8866-41B2-BB8B-5BD472CA82A6}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
         &lt;ExtendedAttribute Name=&quot;SupportUpdateInIQ&quot; Caption=&quot;Support update in Sybase IQ&quot; Attribute=&quot;SupportUpdateInIQ&quot; AttributeID=&quot;{F313B4B4-03E1-40D7-8030-8773982DA4FD}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;/HorizontalLayout&gt;
   &lt;/VerticalLayout&gt;
   &lt;ExtendedAttribute Name=&quot;InsertStagingTableCode&quot; Caption=&quot;Insert table code&quot; Attribute=&quot;InsertStagingTableCode&quot; AttributeID=&quot;{00056D16-ECA0-4CFF-BDE7-FFB2F44EC51D}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;UpdateStagingTableCode&quot; Caption=&quot;Update table code&quot; Attribute=&quot;UpdateStagingTableCode&quot; AttributeID=&quot;{BF25DD36-3B3B-4DDE-8535-EA49857581DF}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;ExtendedAttribute Name=&quot;DeleteStagingTableCode&quot; Caption=&quot;Delete table code&quot; Attribute=&quot;DeleteStagingTableCode&quot; AttributeID=&quot;{2F76C7C9-AB89-4584-9352-A01F4D884F93}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;GroupBox Name=&quot;GroupBox1&quot;    ControlAsLabel=&quot;Yes&quot; &gt;
      &lt;ExtendedAttribute Name=&quot;UseProcedureForFunctionString&quot; Caption=&quot;Use stored procedure for function strings&quot; Attribute=&quot;UseProcedureForFunctionString&quot; AttributeID=&quot;{C03AE486-6A28-41CD-8176-3BE0C73ECE96}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;ExtendedAttribute Name=&quot;InsertProcedureCode&quot; Caption=&quot;Insert procedure code&quot; Attribute=&quot;InsertProcedureCode&quot; AttributeID=&quot;{649AEAD4-8199-434A-9189-9A646072FC20}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;ExtendedAttribute Name=&quot;UpdateProcedureCode&quot; Caption=&quot;Update procedure code&quot; Attribute=&quot;UpdateProcedureCode&quot; AttributeID=&quot;{0F3C7608-3E28-4EF1-AF1F-33E02A2C7DB4}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
      &lt;ExtendedAttribute Name=&quot;DeleteProcedureCode&quot; Caption=&quot;Delete procedure code&quot; Attribute=&quot;DeleteProcedureCode&quot; AttributeID=&quot;{38361645-BB06-4812-A347-00CD15B6583E}&quot; GrayHiddenAttributes=&quot;Yes&quot; SizeInChars=&quot;1&quot; LineNumber=&quot;3&quot; HorizontalResize=&quot;true&quot; VerticalResize=&quot;true&quot; LeftText=&quot;false&quot; /&gt;
   &lt;/GroupBox&gt;   
&lt;/Form&gt;
</a:FormTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Add a SQL Anywhere staging database for the IQ database</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:FormType>Dialog</a:FormType>
</o:FormTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:CriterionTargetItem>
<o:CriterionTargetItem Id="o54">
<a:ObjectID>4AAEB7ED-5D53-4D39-B159-D6F84025A5A9</a:ObjectID>
<a:Name>isRemoteIQ</a:Name>
<a:CriterionTargetItem.Value>(%isIQ%) and (%isRemoteDatabase%)</a:CriterionTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o55">
<a:TypePublicName>MenuTargetItem</a:TypePublicName>
<a:ObjectID>1D87ECA4-687C-4117-BF45-9FC6BD910166</a:ObjectID>
<a:Name>Menus</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:MenuTargetItem Id="o56">
<a:ObjectID>70C0576B-7B9C-4D25-B019-DDAD19E6A191</a:ObjectID>
<a:Name>Menu_1</a:Name>
<a:MenuTargetItem.Value>&lt;Menu&gt;
   &lt;Command Name=&quot;CreateASEStagingDB&quot; Caption=&quot;Create an ASE Staging Database for IQ...&quot; /&gt;
   &lt;Command Name=&quot;CreateASAStagingDB&quot; Caption=&quot;Create a SQL Anywhere Staging Database for IQ...&quot; /&gt;
&lt;/Menu&gt;
</a:MenuTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:MenuTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o57">
<a:TypePublicName>MethodTargetItem</a:TypePublicName>
<a:ObjectID>AD2BE982-DC4F-4285-804B-5821F001D12C</a:ObjectID>
<a:Name>Methods</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:MethodTargetItem Id="o58">
<a:ObjectID>A00548F6-92FF-4BCE-B29F-0E7311810B50</a:ObjectID>
<a:Name>CreateASEStagingDB</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>1266336405</a:ModificationDate>
<a:Modifier>pmangas</a:Modifier>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:MethodScript>Sub %Method%(database)
   CreateStagingDatabaseIQ Nothing, database, true, true
End Sub</a:MethodScript>
</o:MethodTargetItem>
<o:MethodTargetItem Id="o59">
<a:ObjectID>5AD52C3A-86D8-462D-BF33-63CD7288C934</a:ObjectID>
<a:Name>CreateASAStagingDB</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>1266336405</a:ModificationDate>
<a:Modifier>pmangas</a:Modifier>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:MethodScript>Sub %Method%(database)
   CreateStagingDatabaseIQ Nothing, database, false, true   
End Sub</a:MethodScript>
</o:MethodTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o60">
<a:TypePublicName>TransformationTargetItem</a:TypePublicName>
<a:ObjectID>6404A11B-03D6-4931-8FDC-1926B13B75F2</a:ObjectID>
<a:Name>Transformations</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TransformationTargetItem Id="o61">
<a:ObjectID>57A1B55D-6D52-429E-B3C1-A6B45F7B0421</a:ObjectID>
<a:Name>Create an ASE Staging Database for IQ</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>1266336124</a:ModificationDate>
<a:Modifier>pmangas</a:Modifier>
<a:Comment>Create an ASE staging database for IQ</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:TransformationScript>Sub %Transformation%(database, trfm)
   
   CreateStagingDatabaseIQ trfm, database, true, true

End Sub</a:TransformationScript>
</o:TransformationTargetItem>
<o:TransformationTargetItem Id="o62">
<a:ObjectID>370AC5E1-9B2B-4155-9871-FE92284C4E75</a:ObjectID>
<a:Name>Create a SQL Anywhere Staging Database for IQ</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>1266335981</a:ModificationDate>
<a:Modifier>pmangas</a:Modifier>
<a:Comment>Create a SQL Anywhere staging database for IQ</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:TransformationScript>Sub %Transformation%(database, trfm)
   CreateStagingDatabaseIQ trfm, database, false, true
End Sub</a:TransformationScript>
</o:TransformationTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:CriterionTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o63">
<a:ObjectID>D8209AB9-835C-4948-8826-AA2FDA2C79E5</a:ObjectID>
<a:Name>TransformationProcess</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Enable transformation process</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o64">
<a:ObjectID>B66CBD40-9A11-44EA-BA41-8059E01D31C2</a:ObjectID>
<a:Name>ReplicationProcess</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o65">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>F6FC64FB-A399-4497-9D65-B916D2E27E93</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o66">
<a:ObjectID>73BD1044-6A46-48E1-8A9E-F7FDA3C80CCC</a:ObjectID>
<a:Name>isRepServer</a:Name>
<a:TemplateTargetItem.Value>.bool (%.18:Type% == &quot;Replication Server&quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o67">
<a:ObjectID>3E9746C8-6443-4663-B3CD-FC27D3245E56</a:ObjectID>
<a:Name>PdPDM.Table</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o68">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>FDFC0B4E-6069-4ACB-96A8-ACEBE229FE8F</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o69">
<a:ObjectID>BCAE4AAC-5D77-4E5E-86C5-A6F2E734A930</a:ObjectID>
<a:Name>IQ</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o70">
<a:ObjectID>4F9DC8C4-D44A-4478-BF4D-6964603E7081</a:ObjectID>
<a:Name>iqLoadStgTable</a:Name>
<a:TemplateTargetItem.Value>------------------------------------------------------------
-- Loading Table: %iqTableCode%
------------------------------------------------------------
[%iqDeleteRows%\n\n]\
[%iqUpdateRows%\n\n]\
[%iqInsertRows%\n\n]\
[%iqCleanStaging%\n\n]\
-- Commit
commit;
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o71">
<a:ObjectID>2BD36B9F-9B89-44B0-8863-E18883A70A7E</a:ObjectID>
<a:Name>iqColumns</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns)
%Code%
.next(&quot;, &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o72">
<a:ObjectID>2BDA9F86-F629-458C-BE4A-14250939114D</a:ObjectID>
<a:Name>iqUpdateSetColumns</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%Primary%==false)
%Code% = stg.%Code%
.next(&quot;, &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o73">
<a:ObjectID>866B6DE9-1675-4332-A04F-27D6DC35F46E</a:ObjectID>
<a:Name>iqWherePkColumns</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%Primary%)
tab.%Code% = stg.%Code%
.next(&quot; and &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o74">
<a:ObjectID>E2E1AFCB-B493-42FF-9C99-6A5D017A5CD5</a:ObjectID>
<a:Name>iqPkColumns</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%Primary%)
%Code%
.next(&quot;, &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TypedCategoryTargetItem Id="o75">
<a:ObjectID>2C254A28-DAD7-4F1D-AF1F-04314EB9D466</a:ObjectID>
<a:Name>Helpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o76">
<a:ObjectID>5D634C6B-D851-41EA-9929-3E811A694EFD</a:ObjectID>
<a:Name>iqStgDeleteTableCodeLong</a:Name>
<a:TemplateTargetItem.Value>.replace(&lt;Table&gt;, %.26:Code%)
%_deleteStagingTableCode%
.endreplace</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o77">
<a:ObjectID>DA051775-9CAE-4E57-90F5-A8AACB125FED</a:ObjectID>
<a:Name>iqStgDeleteTableComment</a:Name>
<a:TemplateTargetItem.Value>Delete staging table for %Code%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o78">
<a:ObjectID>E4B9FC32-64EE-4D21-B3CC-91BF472FD4CB</a:ObjectID>
<a:Name>iqStgDeleteTableName</a:Name>
<a:TemplateTargetItem.Value>%Code% deleted</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o79">
<a:ObjectID>4089F9D5-BAC5-4707-84A1-0D6910FB5EAC</a:ObjectID>
<a:Name>iqStgInsertTableCodeLong</a:Name>
<a:TemplateTargetItem.Value>.replace(&lt;Table&gt;, %.26:Code%)
%_insertStagingTableCode%
.endreplace</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o80">
<a:ObjectID>A7767C55-9C7A-4580-B2C1-91832B01A329</a:ObjectID>
<a:Name>iqStgInsertTableComment</a:Name>
<a:TemplateTargetItem.Value>Insert staging table for %Code%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o81">
<a:ObjectID>BDC82804-3605-4CD1-A03E-8972D8E82CF9</a:ObjectID>
<a:Name>iqStgInsertTableName</a:Name>
<a:TemplateTargetItem.Value>%Code% inserted</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o82">
<a:ObjectID>D43991FD-3B28-415F-B08C-CA186D5C89AB</a:ObjectID>
<a:Name>iqStgUpdateTableCodeLong</a:Name>
<a:TemplateTargetItem.Value>.replace(&lt;Table&gt;, %.26:Code%)
%_updateStagingTableCode%
.endreplace</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o83">
<a:ObjectID>26D9E42B-EECF-4FF9-86F5-491AC416DCFD</a:ObjectID>
<a:Name>iqStgUpdateTableComment</a:Name>
<a:TemplateTargetItem.Value>Update staging table for %Code%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o84">
<a:ObjectID>27CDCC70-9851-4B31-ABEA-25E0595D4D0F</a:ObjectID>
<a:Name>iqStgUpdateTableName</a:Name>
<a:TemplateTargetItem.Value>%Code% updated</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o85">
<a:ObjectID>EA561B63-B875-4C24-80F8-ED421853DCB5</a:ObjectID>
<a:Name>iqTableCode</a:Name>
<a:TemplateTargetItem.Value>.if (%Owner%)
%Owner.Code%.
.endif
%Code%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o86">
<a:ObjectID>90FE07EB-1175-4F73-8822-16E8D95E6A34</a:ObjectID>
<a:Name>iqStgDeleteTableCode</a:Name>
<a:TemplateTargetItem.Value>%.30U:iqStgDeleteTableCodeLong%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o87">
<a:ObjectID>03C3957F-749F-4A0A-9ACF-C5E81D04661A</a:ObjectID>
<a:Name>iqStgInsertTableCode</a:Name>
<a:TemplateTargetItem.Value>%.30U:iqStgInsertTableCodeLong%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o88">
<a:ObjectID>5CAB2C80-0FA4-453A-A36A-30B21AF73712</a:ObjectID>
<a:Name>iqStgUpdateTableCode</a:Name>
<a:TemplateTargetItem.Value>%.30U:iqStgUpdateTableCodeLong%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TemplateTargetItem Id="o89">
<a:ObjectID>6E1E2C87-EF36-4C35-B189-9B5CEB196FA7</a:ObjectID>
<a:Name>iqInsertRows</a:Name>
<a:TemplateTargetItem.Value>.if (%_bUseInsertStagingTableInIQ%)
-- Load inserted rows into insert staging table
insert into %iqStgInsertTableCode% (%iqColumns%)
location &#39;&lt;Server&gt;.&lt;Database&gt;&#39;
&#39; select %iqColumns%
   from  %stgInsertTableCode% &#39;;

-- Load inserted rows into IQ table
insert into %iqTableCode% (%iqColumns%)
&#39; select %iqColumns%
   from  %iqStgInsertTableCode% &#39;;
.else
-- Load inserted rows into IQ table
insert into %iqTableCode% (%iqColumns%)
location &#39;&lt;Server&gt;.&lt;Database&gt;&#39;
&#39; select %iqColumns%
   from  %stgInsertTableCode% &#39;;
.endif(\n)
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o90">
<a:ObjectID>A36B5E7D-FFA6-4376-805C-076EE511B1C1</a:ObjectID>
<a:Name>iqDeleteRows</a:Name>
<a:TemplateTargetItem.Value>-- Load deleted rows into delete staging table
insert into %iqStgDeleteTableCode% (%iqPkColumns%)
location &#39;&lt;Server&gt;.&lt;Database&gt;&#39;
&#39; select %iqPkColumns%
   from  %stgDeleteTableCode% &#39;;

-- Remove deleted rows in IQ table
delete %iqTableCode%
 from  %iqTableCode% tab, %iqStgDeleteTableCode% stg
where  %iqWherePkColumns%;
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o91">
<a:ObjectID>115D8A3E-D184-410B-98DF-6561173B18C4</a:ObjectID>
<a:Name>iqUpdateRows</a:Name>
<a:TemplateTargetItem.Value>.if (%_bSupportUpdateInIQ%)
-- Load updated rows into update staging table
insert into %iqStgUpdateTableCode% (%iqColumns%)
location &#39;&lt;Server&gt;.&lt;Database&gt;&#39;
&#39; select %iqColumns%
   from  %stgUpdateTableCode% &#39;; 

   .if (%iqUpdateSetColumns%)
-- Update modified rows in IQ table
update %iqTableCode%
 Set   %iqUpdateSetColumns%
 from  %iqTableCode% tab, %iqStgUpdateTableCode% stg
where  %iqWherePkColumns%;
   .endif
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o92">
<a:ObjectID>7DBA18F4-3A0A-4D82-A76A-88D1BF210E15</a:ObjectID>
<a:Name>iqCleanStaging</a:Name>
<a:TemplateTargetItem.Value>-- Clean staging data\n
.if (%_bUseInsertStagingTableInIQ%)
truncate table %iqStgInsertTableCode%;
.endif(\n)
.if (%_bSupportUpdateInIQ%)
truncate table %iqStgUpdateTableCode%;
.endif(\n)
truncate table %iqStgDeleteTableCode%;
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o93">
<a:ObjectID>A28E8360-A90B-45BE-B7AB-FDBB997CBECB</a:ObjectID>
<a:Name>StagingDB</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o94">
<a:ObjectID>3B2334FC-724D-4B30-A932-4B7328572650</a:ObjectID>
<a:Name>stgCleanStgTable</a:Name>
<a:TemplateTargetItem.Value>-- Clean the staging tables of &#39;%Code%&#39;
truncate table %stgInsertTableCode%%_statementTerminator%\n
.if (%_bSupportUpdateInIQ%)
truncate table %stgUpdateTableCode%%_statementTerminator%
.endif(\n)
truncate table %stgDeleteTableCode%%_statementTerminator%
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TypedCategoryTargetItem Id="o95">
<a:ObjectID>3A22D1A0-0EF9-4E25-80FE-A695D629916D</a:ObjectID>
<a:Name>Helpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o96">
<a:ObjectID>A17B8EFB-4A8D-4B43-912E-186C762DC05D</a:ObjectID>
<a:Name>stgDeleteTableCode</a:Name>
<a:TemplateTargetItem.Value>%.30U:stgDeleteTableCodeLong%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o97">
<a:ObjectID>36C8B35D-AA87-458B-9DFD-F4336D75CA39</a:ObjectID>
<a:Name>stgDeleteTableComment</a:Name>
<a:TemplateTargetItem.Value>Delete staging table for %Code%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o98">
<a:ObjectID>599D5D59-2C6D-4132-ABDD-B87871A193D7</a:ObjectID>
<a:Name>stgDeleteTableName</a:Name>
<a:TemplateTargetItem.Value>%Code% deleted</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o99">
<a:ObjectID>698B1DD7-4D01-466E-8895-49EE32D33630</a:ObjectID>
<a:Name>stgInsertTableCodeLong</a:Name>
<a:TemplateTargetItem.Value>.replace(&lt;Table&gt;, %.26:Code%)
%_insertStagingTableCode%
.endreplace</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o100">
<a:ObjectID>235A147A-D4C6-4001-9043-E599C9EA0597</a:ObjectID>
<a:Name>stgInsertTableComment</a:Name>
<a:TemplateTargetItem.Value>Insert staging table for %Code%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o101">
<a:ObjectID>A9FB7EE0-5D48-49B5-B9BD-E47815081728</a:ObjectID>
<a:Name>stgInsertTableName</a:Name>
<a:TemplateTargetItem.Value>%Code% inserted</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o102">
<a:ObjectID>09A2CB26-1696-4F83-95F3-25D508336549</a:ObjectID>
<a:Name>stgUpdateTableCodeLong</a:Name>
<a:TemplateTargetItem.Value>.replace(&lt;Table&gt;, %.26:Code%)
%_updateStagingTableCode%
.endreplace</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o103">
<a:ObjectID>75E124D6-7DBA-4E47-9F71-14D5754A3797</a:ObjectID>
<a:Name>stgUpdateTableComment</a:Name>
<a:TemplateTargetItem.Value>Update staging table for %Code%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o104">
<a:ObjectID>AE84B324-2727-4F7E-BF64-454690C7AC65</a:ObjectID>
<a:Name>stgUpdateTableName</a:Name>
<a:TemplateTargetItem.Value>%Code% updated</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o105">
<a:ObjectID>B2D2F677-83F5-441E-9803-2071B2FE27B8</a:ObjectID>
<a:Name>stgDeleteTableCodeLong</a:Name>
<a:TemplateTargetItem.Value>.replace(&lt;Table&gt;, %.26:Code%)
%_deleteStagingTableCode%
.endreplace</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o106">
<a:ObjectID>0712A327-DD44-47AD-95F7-7CB389611135</a:ObjectID>
<a:Name>stgInsertTableCode</a:Name>
<a:TemplateTargetItem.Value>%.30U:stgInsertTableCodeLong%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o107">
<a:ObjectID>9460A3CE-749D-4CE5-958E-6B22FD6753C8</a:ObjectID>
<a:Name>stgUpdateTableCode</a:Name>
<a:TemplateTargetItem.Value>%.30U:stgUpdateTableCodeLong%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o108">
<a:ObjectID>3685F250-1119-45CB-9768-010690BF9E0D</a:ObjectID>
<a:Name>IQSystem</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o109">
<a:ObjectID>130CCEA8-8E00-4E5A-A0E6-06BF0A0F3604</a:ObjectID>
<a:Name>iqSystemLoadStgTable</a:Name>
<a:TemplateTargetItem.Value>------------------------------------------------------------
-- Loading Table: %iqTableCode%
------------------------------------------------------------
[%iqSystemDeleteRows%\n\n]\
[%iqSystemUpdateRows%\n\n]\
[%iqSystemInsertRows%\n\n]\
[%iqSystemCleanStaging%\n\n]\
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o110">
<a:ObjectID>B364A035-86F3-451F-A552-0FBE313051BA</a:ObjectID>
<a:Name>iqSystemDeleteRows</a:Name>
<a:TemplateTargetItem.Value>-- Remove deleted rows in IQ table
delete %iqTableCode%
 from  %iqTableCode% tab, %iqStgDeleteTableCode% stg
where  %iqWherePkColumns%;
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o111">
<a:ObjectID>6D7457D5-215D-428C-BC07-E6754A9A07B6</a:ObjectID>
<a:Name>iqSystemUpdateRows</a:Name>
<a:TemplateTargetItem.Value>.if (%_bSupportUpdateInIQ%)
-- Update modified rows in IQ table
update %iqTableCode%
 Set   %iqUpdateSetColumns%
 from  %iqTableCode% tab, %iqStgUpdateTableCode% stg
where  %iqWherePkColumns%;
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o112">
<a:ObjectID>1E5E9492-CB65-4252-9E5B-636612C89E27</a:ObjectID>
<a:Name>iqSystemInsertRows</a:Name>
<a:TemplateTargetItem.Value>-- Load inserted rows into IQ table
insert into %iqTableCode% (%iqColumns%)
{ select %iqColumns%
   from  %stgInsertTableCode% };
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o113">
<a:ObjectID>698A14D6-072A-4444-B6BC-D435E8E9A824</a:ObjectID>
<a:Name>iqSystemCleanStaging</a:Name>
<a:TemplateTargetItem.Value>-- Clean staging data
truncate table %iqStgInsertTableCode%;\n
.if (%_bSupportUpdateInIQ%)
truncate table %iqStgUpdateTableCode%;
.endif(\n)
truncate table %iqStgDeleteTableCode%;
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o114">
<a:ObjectID>7A4B2D34-9FA8-4AC9-8940-37328144EB9E</a:ObjectID>
<a:Name>Article</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:EnableSelectionGeneration>1</a:EnableSelectionGeneration>
<c:Categories>
<o:TypedCategoryTargetItem Id="o115">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>FC508F36-6BAC-4B0B-97BF-9E5A13CAF8A7</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o116">
<a:ObjectID>0F40B0AF-8DBA-41AF-96DE-32F6562AAD6E</a:ObjectID>
<a:Name>Procedure</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o117">
<a:ObjectID>E3A95D0A-4C75-4298-8FEC-B17AA1C8428C</a:ObjectID>
<a:Name>Insert</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o118">
<a:ObjectID>5B8AFB17-F6A9-43EA-BAB2-98219F09A619</a:ObjectID>
<a:Name>rsInsertProcBody</a:Name>
<a:TemplateTargetItem.Value>[%insertError%\n]\

-- Insert into the insert table
insert into %stgInsertTableCode% (%insertColumns%)
values (%procInsertValues%)%statementTerminator%

return 0%statementTerminator%
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o119">
<a:ObjectID>14738695-C857-4D50-86A1-A25871D1E6E4</a:ObjectID>
<a:Name>rsInsertProcCode</a:Name>
<a:TemplateTargetItem.Value>&lt;InsertProcedure&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o120">
<a:ObjectID>7385EBB1-D91B-4BF3-8F7D-85E48BD0FF27</a:ObjectID>
<a:Name>rsInsertProcComment</a:Name>
<a:TemplateTargetItem.Value>Stored procedure for rs_insert</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o121">
<a:ObjectID>07817CB4-9232-42A7-B964-E633DC5371CC</a:ObjectID>
<a:Name>rsInsertProcDefinition</a:Name>
<a:TemplateTargetItem.Value>create procedure \[%%QUALIFIER%%\]%%PROC%%
[%openParenthesis%\n]\
   %rsInsertProcParameters%
[%closeParenthesis%\n]\
[%as%\n]\
begin  
[   %rsInsertProcBody%\n]\
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o122">
<a:ObjectID>B181DA82-6868-4B19-AFF4-741741D13FCF</a:ObjectID>
<a:Name>rsInsertProcName</a:Name>
<a:TemplateTargetItem.Value>&lt;Table&gt; insert</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o123">
<a:ObjectID>98CE1A41-C00A-4EE9-8ADC-7196315C0A8A</a:ObjectID>
<a:Name>rsInsertProcParameters</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isValidColumn%)
[%Outer.inOut% ]%newParameterName% %columnDataType%
.next(&quot;,\n&quot;)
.if (%useRsOrigin%)
,
[%inOut% ]@rs_origin_commit_time datetime,
[%inOut% ]@rs_origin_ds char(30),
[%inOut% ]@rs_origin_db char(30),
[%inOut% ]@rs_origin_user char(30),
[%inOut% ]@rs_origin_xact_name char(30)
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o124">
<a:ObjectID>17826F5A-DB30-4FE2-9AE4-EB661704F9D9</a:ObjectID>
<a:Name>Update</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o125">
<a:ObjectID>04254D91-DFB3-423B-933F-482E2DF55EAA</a:ObjectID>
<a:Name>rsUpdateProcBody</a:Name>
<a:TemplateTargetItem.Value>[%updateError%\n]\

-- Check for existing row in the insert table and overwrite it if found
if exists (select 1 from %stgInsertTableCode% where %procWherePkColumns%)[ %then%]
[%begin%\n]\
   update %stgInsertTableCode%
    set   %procUpdateSetColumns%
   where  %procWherePkColumns%
[%end%\n]\
%elseif% not exists (select 1 from %stgDeleteTableCode% where %procWherePkColumns%)[ %then%]
[%begin%\n]\
   -- Insert into the delete table
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%procPkValues%)%statementTerminator%

   -- Insert into the insert table
   insert into %stgInsertTableCode% (%insertColumns%)
   values (%procInsertValues%)%statementTerminator%
[%end%\n]\
[%endif%\n]\

return 0%statementTerminator%

</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o126">
<a:ObjectID>92E8E393-9284-423A-AB46-F4ED722A3594</a:ObjectID>
<a:Name>rsUpdateProcCode</a:Name>
<a:TemplateTargetItem.Value>&lt;UpdateProcedure&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o127">
<a:ObjectID>2BFADF7E-9B8A-49F8-BDD8-31BD200299B3</a:ObjectID>
<a:Name>rsUpdateProcComment</a:Name>
<a:TemplateTargetItem.Value>Stored procedure for rs_update</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o128">
<a:ObjectID>C5B8B216-3138-4F71-AA80-C5E67F6B3B04</a:ObjectID>
<a:Name>rsUpdateProcDefinition</a:Name>
<a:TemplateTargetItem.Value>create procedure \[%%QUALIFIER%%\]%%PROC%%
[%openParenthesis%\n]\
   %rsUpdateProcParameters%
[%closeParenthesis%\n]\
[%as%\n]\
begin  
[   %rsUpdateProcBody%\n]\
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o129">
<a:ObjectID>AF9062A5-6D37-4DFE-AB09-1B116C35E55F</a:ObjectID>
<a:Name>rsUpdateProcName</a:Name>
<a:TemplateTargetItem.Value>&lt;Table&gt; update</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o130">
<a:ObjectID>06D4D343-383E-4FF9-BF57-A8224C8D0C0D</a:ObjectID>
<a:Name>rsUpdateProcParameters</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isValidColumn%)
[%Outer.inOut% ]%newParameterName% %columnDataType%, 
[%Outer.inOut% ]%oldParameterName% %columnDataType%
.next(&quot;,\n&quot;)
.if (%useRsOrigin%)
,
[%inOut% ]@rs_origin_commit_time datetime,
[%inOut% ]@rs_origin_ds char(30),
[%inOut% ]@rs_origin_db char(30),
[%inOut% ]@rs_origin_user char(30),
[%inOut% ]@rs_origin_xact_name char(30)
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o131">
<a:ObjectID>42C4A402-01CB-49A7-BAFB-C0B6E8C825E1</a:ObjectID>
<a:Name>rsUpdateProcDefinitionUseUpdate</a:Name>
<a:TemplateTargetItem.Value>create procedure \[%%QUALIFIER%%\]%%PROC%%
[%openParenthesis%\n]\
   %rsUpdateProcParameters%
[%closeParenthesis%\n]\
[%as%\n]\
begin  
[   %rsUpdateProcBodyUseUpdate%\n]\
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o132">
<a:ObjectID>4547A9AC-6519-41D3-B5C9-A0E19AA5A65E</a:ObjectID>
<a:Name>rsUpdateProcBodyUseUpdate</a:Name>
<a:TemplateTargetItem.Value>[%updateError%\n]\

-- Check for existing row in the insert table and overwrite it if found
if exists (select 1 from %stgInsertTableCode% where %procWherePkColumns%)[ %then%]
[%begin%\n]\
   update %stgInsertTableCode%
    set   %procUpdateSetColumns%
   where  %procWherePkColumns%
[%end%\n]\
-- Check for existing row in the update table and overwrite it if found
%elseif% exists (select 1 from %stgUpdateTableCode% where %procWherePkColumns%)[ %then%]
[%begin%\n]\
   update %stgUpdateTableCode%
    set   %procUpdateSetColumns%
   where  %procWherePkColumns%
[%end%\n]\
%elseif% not exists (select 1 from %stgDeleteTableCode% where %procWherePkColumns%)[ %then%]
[%begin%\n]\
   -- Insert into the delete table
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%procPkValues%)%statementTerminator%

   -- Insert into the insert table
   insert into %stgInsertTableCode% (%insertColumns%)
   values (%procInsertValues%)%statementTerminator%
[%end%\n]\
[%endif%\n]\

return 0%statementTerminator%

</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o133">
<a:ObjectID>AF76ADCE-F1A9-42E4-AB21-4A7CC682F454</a:ObjectID>
<a:Name>Delete</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o134">
<a:ObjectID>163D274D-6F89-4AD2-B542-9399A4F27321</a:ObjectID>
<a:Name>rsDeleteProcBody</a:Name>
<a:TemplateTargetItem.Value>[%deleteError%\n]\

-- Check for existing row in the insert table and remove it if found
if exists (select 1 from %stgInsertTableCode% where %procWherePkColumns%)[ %then%]
[%begin%\n]\
   delete %stgInsertTableCode%
   where  %procWherePkColumns%
[%end%\n]\
[%endif%\n]\
-- Check for existing row in the delete table and insert it if not found
if not exists (select 1 from %stgDeleteTableCode% where %procWherePkColumns%)[ %then%]
[%begin%\n]\
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%procPkValues%)
[%end%\n]\
[%endif%\n]\

return 0%statementTerminator%
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o135">
<a:ObjectID>9504F9CC-06F1-446D-9C25-E3B48CD3BCDD</a:ObjectID>
<a:Name>rsDeleteProcCode</a:Name>
<a:TemplateTargetItem.Value>&lt;DeleteProcedure&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o136">
<a:ObjectID>CFD032DF-BF6B-4FB0-A9A6-4CABA9B7A7CF</a:ObjectID>
<a:Name>rsDeleteProcComment</a:Name>
<a:TemplateTargetItem.Value>Stored procedure for rs_delete</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o137">
<a:ObjectID>8CC02D82-E019-4510-B00E-421CC1A944CC</a:ObjectID>
<a:Name>rsDeleteProcDefinition</a:Name>
<a:TemplateTargetItem.Value>create procedure \[%%QUALIFIER%%\]%%PROC%%
[%openParenthesis%\n]\
   %rsDeleteProcParameters%
[%closeParenthesis%\n]\
[%as%\n]\
begin  
[   %rsDeleteProcBody%\n]\
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o138">
<a:ObjectID>5FB53EEC-3E14-4705-ACF9-3C4154F50C61</a:ObjectID>
<a:Name>rsDeleteProcName</a:Name>
<a:TemplateTargetItem.Value>&lt;Table&gt; delete</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o139">
<a:ObjectID>92B408EC-1F24-457C-935B-9311B31635D7</a:ObjectID>
<a:Name>rsDeleteProcParameters</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isValidColumn%)
[%Outer.inOut% ]%oldParameterName% %columnDataType%
.next(&quot;,\n&quot;)
.if (%useRsOrigin%)
,
[%inOut% ]@rs_origin_commit_time datetime,
[%inOut% ]@rs_origin_ds char(30),
[%inOut% ]@rs_origin_db char(30),
[%inOut% ]@rs_origin_user char(30),
[%inOut% ]@rs_origin_xact_name char(30)
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o140">
<a:ObjectID>8393530D-A4B5-499C-83B8-301F0045A2EE</a:ObjectID>
<a:Name>rsDeleteProcDefinitionUseUpdate</a:Name>
<a:TemplateTargetItem.Value>create procedure \[%%QUALIFIER%%\]%%PROC%%
[%openParenthesis%\n]\
   %rsDeleteProcParameters%
[%closeParenthesis%\n]\
[%as%\n]\
begin  
[   %rsDeleteProcBodyUseUpdate%\n]\
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o141">
<a:ObjectID>232BACF6-1238-4A54-A09A-5C3E484D5277</a:ObjectID>
<a:Name>rsDeleteProcBodyUseUpdate</a:Name>
<a:TemplateTargetItem.Value>[%deleteError%\n]\

-- Check for existing row in the insert table and remove it if found
if exists (select 1 from %stgInsertTableCode% where %procWherePkColumns%)[ %then%]
[%begin%\n]\
   delete %stgInsertTableCode%
   where  %procWherePkColumns%
[%end%\n]\
[%endif%\n]\
-- Check for existing row in the update table and remove it if found
if exists (select 1 from %stgUpdateTableCode% where %procWherePkColumns%)[ %then%]
[%begin%\n]\
   delete %stgUpdateTableCode%
   where  %procWherePkColumns%
[%end%\n]\
[%endif%\n]\
-- Check for existing row in the delete table and insert it if not found
if not exists (select 1 from %stgDeleteTableCode% where %procWherePkColumns%)[ %then%]
[%begin%\n]\
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%procPkValues%)
[%end%\n]\
[%endif%\n]\

return 0%statementTerminator%
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TemplateTargetItem Id="o142">
<a:ObjectID>57769FFB-81A7-47A0-88BA-76894ACE0032</a:ObjectID>
<a:Name>procWherePkColumns</a:Name>
<a:TemplateTargetItem.Value>.// redefine this template to workaround RepServer template problem
.foreach_item(Columns,,,%isPrimary%)
%remoteColumnNameNoQuote% = %oldParameterName%
.next(&quot; and &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o143">
<a:ObjectID>18BEB013-81B8-42B4-9946-594DD79B7E86</a:ObjectID>
<a:Name>procInsertValues</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isInsertColumn%)
   .if (%isTextImage% == false)
%newParameterName%
   .else
&quot;&quot;
   .endif
.next(&quot;, &quot;)
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o144">
<a:ObjectID>3C2B480B-5466-4C82-B2B0-2F49937DD0E4</a:ObjectID>
<a:Name>procUpdateSetColumns</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isUpdateColumn%)
   .if (%isTextImage% == false)
%remoteColumnNameNoQuote% = %newParameterName%
   .else
%remoteColumnNameNoQuote% = &quot;&quot;
   .endif
.next(&quot;, &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o145">
<a:ObjectID>95CDF269-F164-4B2E-839F-672C69A0D1F0</a:ObjectID>
<a:Name>procPkValues</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isPrimary%)
%oldParameterName%
.next(&quot;, &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o146">
<a:ObjectID>8115E4F1-1394-4349-B8F0-BBE64B60C46C</a:ObjectID>
<a:Name>procWherePkColumnsNew</a:Name>
<a:TemplateTargetItem.Value>.// redefine this template to workaround RepServer template problem
.foreach_item(Columns,,,%isPrimary%)
%remoteColumnNameNoQuote% = %newParameterName%
.next(&quot; and &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o147">
<a:ObjectID>6EB5E33E-181F-4113-8419-9AEFE3DE8CA9</a:ObjectID>
<a:Name>FunctionString</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o148">
<a:ObjectID>AD8BFE8B-B0BA-4FF6-B3F9-8AFB96137AD6</a:ObjectID>
<a:Name>pkColumns</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isPrimary%)
%columnNameNoQuote%
.next(&quot;, &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o149">
<a:ObjectID>29E3CA9A-D449-4DA7-877D-9932B0B6AF3C</a:ObjectID>
<a:Name>pkValues</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isPrimary%)
?%columnNameNoQuote%!old?
.next(&quot;, &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o150">
<a:ObjectID>BDEC2827-9839-4033-8F15-D60E486022CB</a:ObjectID>
<a:Name>wherePkColumns</a:Name>
<a:TemplateTargetItem.Value>.// redefine this template to workaround RepServer template problem
.foreach_item(Columns,,,%isPrimary%)
%remoteColumnNameNoQuote% = ?%columnNameNoQuote%!old?
.next(&quot; and &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TypedCategoryTargetItem Id="o151">
<a:ObjectID>9817D961-C52B-41EC-8624-D0E5CB6629D5</a:ObjectID>
<a:Name>UseProcedure</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o152">
<a:ObjectID>F0D3D1BB-5817-47B5-A702-AFC609DB4BB5</a:ObjectID>
<a:Name>rsInsertUseProc</a:Name>
<a:TemplateTargetItem.Value>%execute% %rsInsertProcCode% %openParenthesis%%rsInsertParamValues%%closeParenthesis%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o153">
<a:ObjectID>2A4E678F-0FA7-4411-A90D-6DC94666328C</a:ObjectID>
<a:Name>rsUpdateUseProc</a:Name>
<a:TemplateTargetItem.Value>%execute% %rsUpdateProcCode% %openParenthesis%%rsUpdateParamValues%%closeParenthesis%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o154">
<a:ObjectID>35272397-C68D-419A-B6F3-1F620316E0F8</a:ObjectID>
<a:Name>rsDeleteUseProc</a:Name>
<a:TemplateTargetItem.Value>%execute% %rsDeleteProcCode% %openParenthesis%%rsDeleteParamValues%%closeParenthesis%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o155">
<a:ObjectID>179008F8-7112-49D1-AD85-BDAD9033EABE</a:ObjectID>
<a:Name>rsInsertParamValues</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isValidColumn%)
?%columnNameNoQuote%!new?
.next(&quot;,\n&quot;)
.if (%useRsOrigin%)
,
?rs_origin_commit_time!sys?,
?rs_origin_ds!sys?,
?rs_origin_db!sys?,
?rs_origin_user!sys?,
?rs_origin_xact_name!sys?
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o156">
<a:ObjectID>D578359E-5EBB-4EA3-8544-3F55C8668244</a:ObjectID>
<a:Name>rsUpdateParamValues</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isValidColumn%)
?%columnNameNoQuote%!new?, ?%columnNameNoQuote%!old?
.next(&quot;,\n&quot;)
.if (%useRsOrigin%)
,
?rs_origin_commit_time!sys?,
?rs_origin_ds!sys?,
?rs_origin_db!sys?,
?rs_origin_user!sys?,
?rs_origin_xact_name!sys?
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o157">
<a:ObjectID>1BED293B-A6A4-4043-89D0-E6F71BF9374A</a:ObjectID>
<a:Name>rsDeleteParamValues</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isValidColumn%)
?%columnNameNoQuote%!old?
.next(&quot;,\n&quot;)
.if (%useRsOrigin%)
,
?rs_origin_commit_time!sys?,
?rs_origin_ds!sys?,
?rs_origin_db!sys?,
?rs_origin_user!sys?,
?rs_origin_xact_name!sys?
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o158">
<a:ObjectID>B5010FBA-6E8C-4A18-A166-805B726BD5E2</a:ObjectID>
<a:Name>WithoutProcedure</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o159">
<a:ObjectID>A3E31272-737F-4223-9E75-984C05FC132C</a:ObjectID>
<a:Name>rsInsert</a:Name>
<a:TemplateTargetItem.Value>-- Check for existing row in the delete table and remove it if found
if exists (select 1 from %stgDeleteTableCode% where %wherePkColumnsNew%)
begin
   delete %stgDeleteTableCode% 
   where  %wherePkColumnsNew%%statementTerminator%
end
-- Insert into the insert table
insert into %stgInsertTableCode% (%insertColumns%)
values (%insertValues%)%statementTerminator%
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o160">
<a:ObjectID>33F54EC4-A90C-44F5-91BF-0FC814FFE3AD</a:ObjectID>
<a:Name>rsUpdate</a:Name>
<a:TemplateTargetItem.Value>-- Check for existing row in the insert table and overwrite it if found
if exists (select 1 from %stgInsertTableCode% where %wherePkColumns%)
begin
   update %stgInsertTableCode%
    set   %updateSetColumns%
   where  %wherePkColumns%%statementTerminator%
end
else if not exists (select 1 from %stgDeleteTableCode% where %wherePkColumns%)
begin
   -- Insert into the delete table
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%pkValues%)%statementTerminator%

   -- Insert into the insert table
   insert into %stgInsertTableCode% (%insertColumns%)
   values (%insertValues%)%statementTerminator%
end</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o161">
<a:ObjectID>F68E8716-B135-43DE-9640-299E133FC2AA</a:ObjectID>
<a:Name>rsDelete</a:Name>
<a:TemplateTargetItem.Value>-- Check for existing row in the insert table and remove it if found
if exists (select 1 from %stgInsertTableCode% where %wherePkColumns%)
begin
   delete %stgInsertTableCode%
   where  %wherePkColumns%%statementTerminator%
end
-- Check for existing row in the delete table and insert it if not found
if not exists (select 1 from %stgDeleteTableCode% where %wherePkColumns%)
begin
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%pkValues%)%statementTerminator%
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o162">
<a:ObjectID>7646A23A-9C21-43E7-8A90-FD28A6A7C792</a:ObjectID>
<a:Name>rsDeleteUseUpdate</a:Name>
<a:TemplateTargetItem.Value>-- Check for existing row in the insert table and remove it if found
if exists (select 1 from %stgInsertTableCode% where %wherePkColumns%)
begin
   delete %stgInsertTableCode%
   where  %wherePkColumns%%statementTerminator%
end
-- Check for existing row in the update table and remove it if found
if exists (select 1 from %stgUpdateTableCode% where %wherePkColumns%)
begin
   delete %stgUpdateTableCode%
   where  %wherePkColumns%%statementTerminator%
end
-- Insert into the delete table
if exists (select 1 from %stgDeleteTableCode% where %wherePkColumns%)
begin
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%pkValues%)%statementTerminator%
end</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o163">
<a:ObjectID>5861D21A-6CDB-4ACF-9240-CF1B3233CE03</a:ObjectID>
<a:Name>rsUpdateUseUpdate</a:Name>
<a:TemplateTargetItem.Value>-- Check for existing row in the insert table and overwrite it if found
if exists (select 1 from %stgInsertTableCode% where %wherePkColumns%)
begin
   update %stgInsertTableCode%
    set   %updateSetColumns%
   where  %wherePkColumns%%statementTerminator%
end
-- Check for existing row in the update table and overwrite it if found
else if exists (select 1 from %stgUpdateTableCode% where %wherePkColumns%)
begin
   update %stgUpdateTableCode%
    set   %updateSetColumns%
   where  %wherePkColumns%%statementTerminator%
end
else
-- Insert into the update table
begin
   insert into %stgUpdateTableCode% (%insertColumns%)
   values (%insertValues%)%statementTerminator%
end</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TemplateTargetItem Id="o164">
<a:ObjectID>1213AA07-C3F4-4BD8-A7E8-50F62DBBBB88</a:ObjectID>
<a:Name>insertColumns</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isInsertColumn%)
%remoteColumnNameNoQuote%
.next(&quot;, &quot;)
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o165">
<a:ObjectID>153A1DE9-71B8-4229-865A-8ECCBFE5A611</a:ObjectID>
<a:Name>insertValues</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isInsertColumn%)
   .if (%isTextImage% == false)
?%columnNameNoQuote%!new?
   .else
&quot;&quot;
   .endif
.next(&quot;, &quot;)
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o166">
<a:ObjectID>B024612B-4663-43D9-9078-33946FC1E2B8</a:ObjectID>
<a:Name>wherePkColumnsNew</a:Name>
<a:TemplateTargetItem.Value>.// redefine this template to workaround RepServer template problem
.foreach_item(Columns,,,%isPrimary%)
%remoteColumnNameNoQuote% = ?%columnNameNoQuote%!new?
.next(&quot; and &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o167">
<a:ObjectID>3F64552E-FDA8-4FF4-AEF2-67E4AC62E692</a:ObjectID>
<a:Name>updateSetColumns</a:Name>
<a:TemplateTargetItem.Value>.foreach_item(Columns,,,%isUpdateColumn%)
   .if (%isTextImage% == false)
%remoteColumnNameNoQuote% = ?%columnNameNoQuote%!new?
   .else
%remoteColumnNameNoQuote% = &quot;&quot;
   .endif
.next(&quot;, &quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o168">
<a:ObjectID>26D5F39F-1CD0-4E05-B026-F472E66ECA10</a:ObjectID>
<a:Name>textImageFunctionStrings</a:Name>
<a:TemplateTargetItem.Value>.if (%isStagingDatabase%)
   .foreach_item(Columns,,,%isReplicableTextImage%)
%textImageFunctionStrings%
   .next(\n\n)
.endif
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o169">
<a:ObjectID>088904F9-6DFD-4E2D-B7E4-DA4038C9AE2C</a:ObjectID>
<a:Name>Helpers</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o170">
<a:ObjectID>B2C49D66-AACA-4C2B-8795-1C275DE67D93</a:ObjectID>
<a:Name>stgDeleteTableCode</a:Name>
<a:TemplateTargetItem.Value>&lt;DeleteTable&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o171">
<a:ObjectID>83E7B636-1DDE-4A31-B8CF-3C64524283F0</a:ObjectID>
<a:Name>stgInsertTableCode</a:Name>
<a:TemplateTargetItem.Value>&lt;InsertTable&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o172">
<a:ObjectID>6B828897-029D-4C34-8CF6-F8A39643AB15</a:ObjectID>
<a:Name>stgUpdateTableCode</a:Name>
<a:TemplateTargetItem.Value>&lt;UpdateTable&gt;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o173">
<a:ObjectID>CD14FE89-207B-469E-92DF-7E0AC39778D8</a:ObjectID>
<a:Name>getDBFamily</a:Name>
<a:TemplateTargetItem.Value>.set_value(_getDBFamily, &quot;SQL SERVER&quot;, new)
.foreach_item(Publication.Subscriptions)
   .set_value(_getDBFamily, %DataConnection.DataStore.getDBFamily%)
   .break
.next
%_getDBFamily%
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o174">
<a:ObjectID>8663E23A-0803-451E-A0E1-BA503BDAAA37</a:ObjectID>
<a:Name>isIQ</a:Name>
<a:TemplateTargetItem.Value>.bool (%getDBFamily% == &quot;ADAPTIVE IQ&quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o175">
<a:ObjectID>21F93C8A-DB05-42B5-895E-EF3843CC0F69</a:ObjectID>
<a:Name>isASE</a:Name>
<a:TemplateTargetItem.Value>.bool (%getDBFamily% == &quot;SQL SERVER&quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o176">
<a:ObjectID>001A6B58-36C5-49D2-BF0A-41EA3746715C</a:ObjectID>
<a:Name>useRsOrigin</a:Name>
<a:TemplateTargetItem.Value>false</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o177">
<a:ObjectID>46837CE8-48AE-4545-8CE8-75856A03522D</a:ObjectID>
<a:Name>isOracleSource</a:Name>
<a:TemplateTargetItem.Value>.bool (%getSourceDBFamily% == &quot;ORACLE&quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o178">
<a:ObjectID>61ECF64D-73EC-4AC6-B280-62D5FE2E60CC</a:ObjectID>
<a:Name>getSourceDBFamily</a:Name>
<a:TemplateTargetItem.Value>.set_value(_getDBFamily, %Publication.DataConnection.DataStore.getDBFamily%, new)
%_getDBFamily%
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o179">
<a:ObjectID>9B5B319E-9750-4BDB-90F5-E1D654FF5816</a:ObjectID>
<a:Name>isASA</a:Name>
<a:TemplateTargetItem.Value>.bool (%getDBFamily% == &quot;SQL SERVER;WATCOM&quot;)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o180">
<a:ObjectID>53F3B6A4-F38F-4EE6-B99E-C739C94DA618</a:ObjectID>
<a:Name>stgDeleteTableCodeTrans</a:Name>
<a:TemplateTargetItem.Value>.vbscript
On Error Resume Next
&#39; Find the remote database
Dim article, subscription, connection, connection2, sTableTemplate
Set article = ActiveSelection.Item(0)
sTableTemplate = &quot;&quot;
For Each subscription in article.Process.Subscriptions
   &#39; Get the table name extended attribute
   sTableTemplate = subscription.DataConnection.DataStore.GetExtendedAttribute(&quot;DeleteStagingTableCode&quot;)
   If sTableTemplate = &quot;&quot; Then
      &#39; Find the target database via the replication process of type &quot;IQStaging&quot;
      For Each connection in subscription.DataConnection.DataStore.DataConnections
         If connection.Process.Type = &quot;IQStaging&quot; Then
            For Each connection2 in connection.Process.IncomingDataConnections
               sTableTemplate = connection2.DataStore.GetExtendedAttribute(&quot;DeleteStagingTableCode&quot;)
            Next
         End If
      Next
   Else
      Exit For
   End If
Next

&#39; Get the initial table name
Dim xem
Set xem = Nothing
For Each xem in ActiveSelection.Item(0).Model.ExtendedModelDefinitions
   If Left(xem.Code, 18) = &quot;Replication Server&quot; Then
      Exit For
   End If
Next
Dim sRemoteTable, sTableName
If Not xem Is Nothing Then
   sRemoteTable = article.EvaluateTemplate(&quot;replicatedTableNameNoQuote&quot;, xem)
Else
   sRemoteTable = article.RemoteTable
   If sRemoteTable = &quot;&quot; Then
      sRemoteTable = article.Code
   End If
   If UCase(Right(sRemoteTable, 8)) = &quot;_DELETED&quot; Then
      sRemoteTable = Left(sRemoteTable, Len(sRemoteTable)-8)
   End If
End If
&#39; Replace the table name
sTableName = Replace(sTableTemplate, &quot;&lt;Table&gt;&quot;, Left(sRemoteTable, 26))
sTableName = UCase(Left(sTableName, 30))
ScriptResult = sTableName
.endvbscript</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o181">
<a:ObjectID>F6E41EE1-4C98-4F80-B5A7-2DDBD08CEFD0</a:ObjectID>
<a:Name>stgInsertTableCodeTrans</a:Name>
<a:TemplateTargetItem.Value>.vbscript
On Error Resume Next
&#39; Find the remote database
Dim article, subscription, connection, connection2, sTableTemplate
Set article = ActiveSelection.Item(0)
sTableTemplate = &quot;&quot;
For Each subscription in article.Process.Subscriptions
   &#39; Get the table name extended attribute
   sTableTemplate = subscription.DataConnection.DataStore.GetExtendedAttribute(&quot;InsertStagingTableCode&quot;)
   If sTableTemplate = &quot;&quot; Then
      &#39; Find the target database via the replication process of type &quot;IQStaging&quot;
      For Each connection in subscription.DataConnection.DataStore.DataConnections
         If connection.Process.Type = &quot;IQStaging&quot; Then
            For Each connection2 in connection.Process.IncomingDataConnections
               sTableTemplate = connection2.DataStore.GetExtendedAttribute(&quot;InsertStagingTableCode&quot;)
            Next
         End If
      Next
   Else
      Exit For
   End If
Next

&#39; Get the initial table name
Dim xem
Set xem = Nothing
For Each xem in ActiveSelection.Item(0).Model.ExtendedModelDefinitions
   If Left(xem.Code, 18) = &quot;Replication Server&quot; Then
      Exit For
   End If
Next
Dim sRemoteTable, sTableName
If Not xem Is Nothing Then
   sRemoteTable = article.EvaluateTemplate(&quot;replicatedTableNameNoQuote&quot;, xem)
Else
   sRemoteTable = article.RemoteTable
   If sRemoteTable = &quot;&quot; Then
      sRemoteTable = article.Code
   End If
   If UCase(Right(sRemoteTable, 8)) = &quot;_DELETED&quot; Then
      sRemoteTable = Left(sRemoteTable, Len(sRemoteTable)-8)
   End If
End If
&#39; Replace the table name
sTableName = Replace(sTableTemplate, &quot;&lt;Table&gt;&quot;, Left(sRemoteTable, 26))
sTableName = UCase(Left(sTableName, 30))
ScriptResult = sTableName
.endvbscript</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o182">
<a:ObjectID>29D772EF-73BE-4AC8-A1C7-795844A67EB2</a:ObjectID>
<a:Name>stgUpdateTableCodeTrans</a:Name>
<a:TemplateTargetItem.Value>.vbscript
On Error Resume Next
&#39; Find the remote database
Dim article, subscription, connection, connection2, sTableTemplate
Set article = ActiveSelection.Item(0)
sTableTemplate = &quot;&quot;
For Each subscription in article.Process.Subscriptions
   &#39; Get the table name extended attribute
   sTableTemplate = subscription.DataConnection.DataStore.GetExtendedAttribute(&quot;UpdateStagingTableCode&quot;)
   If sTableTemplate = &quot;&quot; Then
      &#39; Find the target database via the replication process of type &quot;IQStaging&quot;
      For Each connection in subscription.DataConnection.DataStore.DataConnections
         If connection.Process.Type = &quot;IQStaging&quot; Then
            For Each connection2 in connection.Process.IncomingDataConnections
               sTableTemplate = connection2.DataStore.GetExtendedAttribute(&quot;UpdateStagingTableCode&quot;)
            Next
         End If
      Next
   Else
      Exit For
   End If
Next

&#39; Get the initial table name
Dim xem
Set xem = Nothing
For Each xem in ActiveSelection.Item(0).Model.ExtendedModelDefinitions
   If Left(xem.Code, 18) = &quot;Replication Server&quot; Then
      Exit For
   End If
Next
Dim sRemoteTable, sTableName
If Not xem Is Nothing Then
   sRemoteTable = article.EvaluateTemplate(&quot;replicatedTableNameNoQuote&quot;, xem)
Else
   sRemoteTable = article.RemoteTable
   If sRemoteTable = &quot;&quot; Then
      sRemoteTable = article.Code
   End If
   If UCase(Right(sRemoteTable, 8)) = &quot;_DELETED&quot; Then
      sRemoteTable = Left(sRemoteTable, Len(sRemoteTable)-8)
   End If
End If
&#39; Replace the table name
sTableName = Replace(sTableTemplate, &quot;&lt;Table&gt;&quot;, Left(sRemoteTable, 26))
sTableName = UCase(Left(sTableName, 30))
ScriptResult = sTableName
.endvbscript</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o183">
<a:ObjectID>F4BAE468-DD2A-493E-8C32-B7DD8663E1DB</a:ObjectID>
<a:Name>defaultFunctionStringClass</a:Name>
<a:TemplateTargetItem.Value>.// For IQ staging, always use rs_sqlserver_function_class
rs_sqlserver_function_class</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o184">
<a:ObjectID>A816A557-C878-41E7-BBAF-DF21F7CA9514</a:ObjectID>
<a:Name>replicationDefinitionName</a:Name>
<a:TemplateTargetItem.Value>.vbscript
On Error Resume Next
Dim sName
sName = ActiveSelection.Item(0).GetExtendedAttribute(&quot;ReplicationDefinitionName&quot;)
If sName = &quot;&quot; Then
   ScriptResult = ActiveSelection.Item(0).Code
Else
   ScriptResult = sName
End If
.endvbscript</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o185">
<a:ObjectID>95084F37-EDEE-4302-8065-FC48051F4AE2</a:ObjectID>
<a:Name>isStagingDatabase</a:Name>
<a:TemplateTargetItem.Value>.// Test if the remote database is a staging database
.vbscript
On Error Resume Next
Dim article, subscription
Set article = ActiveSelection.Item(0)
ScriptResult = &quot;false&quot;
For Each subscription in article.Process.Subscriptions
   If subscription.DataConnection.DataStore.Type = &quot;IQStaging&quot; Then
      ScriptResult = &quot;true&quot;   
      Exit For
   End If
Next
.endvbscript
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TypedCategoryTargetItem Id="o186">
<a:TypePublicName>CriterionTargetItem</a:TypePublicName>
<a:ObjectID>9D214395-5918-403A-82C6-9F853E3922FF</a:ObjectID>
<a:Name>Criteria</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:CriterionTargetItem Id="o187">
<a:ObjectID>9E62C29C-9E0E-4DCC-A69A-BAD72AB29921</a:ObjectID>
<a:Name>isIQ</a:Name>
<a:CriterionTargetItem.Value>%isIQ%</a:CriterionTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o188">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>33241AE5-5885-4CCA-891D-F6F98DD2E054</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o189">
<a:ObjectID>36F1BCB8-A5D8-4219-AF87-382D856A096D</a:ObjectID>
<a:Name>execute</a:Name>
<a:TemplateTargetItem.Value>call</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o190">
<a:ObjectID>1C829FE6-C9DA-48E0-ADEE-F6145428E4FC</a:ObjectID>
<a:Name>statementTerminator</a:Name>
<a:TemplateTargetItem.Value>;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o191">
<a:ObjectID>2908F0B1-5AE8-41A6-AC90-79B10DB1EC7F</a:ObjectID>
<a:Name>openParenthesis</a:Name>
<a:TemplateTargetItem.Value>(</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o192">
<a:ObjectID>4961F8F0-A850-4DB0-8431-5DA31019C21C</a:ObjectID>
<a:Name>closeParenthesis</a:Name>
<a:TemplateTargetItem.Value>)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o193">
<a:ObjectID>C5D6ABEA-5CE7-405E-A0B6-B7993FD9E9D3</a:ObjectID>
<a:Name>as</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TypedCategoryTargetItem Id="o194">
<a:ObjectID>B2A37AB9-B2BF-4615-A903-35B5606B7AAD</a:ObjectID>
<a:Name>Procedure</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o195">
<a:ObjectID>0A50FEC8-8707-46DE-A7D4-25A024C33328</a:ObjectID>
<a:Name>rsInsertProcBody</a:Name>
<a:TemplateTargetItem.Value>-- Check for existing row in the delete table and remove it if found
if exists (select 1 from %stgDeleteTableCode% where %procWherePkColumnsNew%)
begin
   delete %stgDeleteTableCode% 
   where  %procWherePkColumnsNew%
end
-- Insert into the insert table
insert into %stgInsertTableCode% (%insertColumns%)
values (%procInsertValues%)
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Obsolete</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o196">
<a:ObjectID>6FC0B27D-F9C5-4A2D-B356-C3B8C53962AB</a:ObjectID>
<a:Name>rsUpdateProcBody</a:Name>
<a:TemplateTargetItem.Value>-- Check for existing row in the insert table and overwrite it if found
if exists (select 1 from %stgInsertTableCode% where %procWherePkColumns%)
begin
   update %stgInsertTableCode%
    set   %procUpdateSetColumns%
   where  %procWherePkColumns%
end
else if not exists (select 1 from %stgDeleteTableCode% where %procWherePkColumns%)
begin
   -- Insert into the delete table
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%procPkValues%)

   -- Insert into the insert table
   insert into %stgInsertTableCode% (%insertColumns%)
   values (%procInsertValues%)
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Obsolete</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o197">
<a:ObjectID>76FF3D0D-2653-4FE2-AEDB-E4ADC9C4BA0B</a:ObjectID>
<a:Name>rsUpdateProcBodyUseUpdate</a:Name>
<a:TemplateTargetItem.Value>-- Check for existing row in the insert table and overwrite it if found
if exists (select 1 from %stgInsertTableCode% where %procWherePkColumns%)
begin
   update %stgInsertTableCode%
    set   %procUpdateSetColumns%
   where  %procWherePkColumns%
end
-- Check for existing row in the update table and overwrite it if found
else if exists (select 1 from %stgUpdateTableCode% where %procWherePkColumns%)
begin
   update %stgUpdateTableCode%
    set   %procUpdateSetColumns%
   where  %procWherePkColumns%
end
else if not exists (select 1 from %stgDeleteTableCode% where %procWherePkColumns%)
begin
   -- Insert into the delete table
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%procPkValues%)

   -- Insert into the insert table
   insert into %stgInsertTableCode% (%insertColumns%)
   values (%procInsertValues%)
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Obsolete</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o198">
<a:ObjectID>00F72A42-526D-4D59-A08D-3D623618A0C1</a:ObjectID>
<a:Name>rsDeleteProcBody</a:Name>
<a:TemplateTargetItem.Value>-- Check for existing row in the insert table and remove it if found
if exists (select 1 from %stgInsertTableCode% where %procWherePkColumns%)
begin
   delete %stgInsertTableCode%
   where  %procWherePkColumns%
end
-- Check for existing row in the delete table and insert it if not found
if not exists (select 1 from %stgDeleteTableCode% where %procWherePkColumns%)
begin
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%procPkValues%)
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Obsolete</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o199">
<a:ObjectID>D7E79FE3-DDD5-4C59-9B56-2F1597DE2690</a:ObjectID>
<a:Name>rsDeleteProcBodyUseUpdate</a:Name>
<a:TemplateTargetItem.Value>-- Check for existing row in the insert table and remove it if found
if exists (select 1 from %stgInsertTableCode% where %procWherePkColumns%)
begin
   delete %stgInsertTableCode%
   where  %procWherePkColumns%
end
-- Check for existing row in the update table and remove it if found
if exists (select 1 from %stgUpdateTableCode% where %procWherePkColumns%)
begin
   delete %stgUpdateTableCode%
   where  %procWherePkColumns%
end
-- Check for existing row in the delete table and insert it if not found
if not exists (select 1 from %stgDeleteTableCode% where %procWherePkColumns%)
begin
   insert into %stgDeleteTableCode% (%pkColumns%)
   values (%procPkValues%)
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Obsolete</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TemplateTargetItem Id="o200">
<a:ObjectID>90B8A3FA-FA87-49BA-B72C-F91F7B153D8C</a:ObjectID>
<a:Name>inOut</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o201">
<a:ObjectID>085A16A5-E0DB-43A6-A7B8-6D4F2D585CC8</a:ObjectID>
<a:Name>then</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o202">
<a:ObjectID>AA4319D5-328D-4FE4-9B0C-67913892B31A</a:ObjectID>
<a:Name>endif</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o203">
<a:ObjectID>F9E880BE-5B5E-4E13-B807-2028E5162480</a:ObjectID>
<a:Name>begin</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o204">
<a:ObjectID>A4243657-C978-45FC-99F4-556116948BCC</a:ObjectID>
<a:Name>end</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o205">
<a:ObjectID>8F0419BD-F6EB-43B9-8632-3F5C1685FD76</a:ObjectID>
<a:Name>elseif</a:Name>
<a:TemplateTargetItem.Value>else if</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o206">
<a:ObjectID>8D720BF5-99E2-4844-AEFE-3B104E0597E1</a:ObjectID>
<a:Name>deleteError</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o207">
<a:ObjectID>7BB00C62-EE08-4D1F-A334-C260D3844252</a:ObjectID>
<a:Name>updateError</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o208">
<a:ObjectID>8C9D305B-8F29-4EE7-9428-58623B0465E0</a:ObjectID>
<a:Name>insertError</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:CriterionTargetItem>
<o:CriterionTargetItem Id="o209">
<a:ObjectID>4948A729-E96B-4B4B-A625-4177D1939768</a:ObjectID>
<a:Name>isASE</a:Name>
<a:CriterionTargetItem.Value>%isASE%</a:CriterionTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o210">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>83977F41-D010-4D99-A072-B0AF049791BD</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o211">
<a:ObjectID>B5F320E8-17A8-4A92-B17E-BE640E5397E6</a:ObjectID>
<a:Name>as</a:Name>
<a:TemplateTargetItem.Value>as</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o212">
<a:ObjectID>D3D928B5-9140-459E-BE62-EE78F63E2512</a:ObjectID>
<a:Name>closeParenthesis</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o213">
<a:ObjectID>B78D01AD-45BD-465E-92C3-06F5CE5AA01C</a:ObjectID>
<a:Name>execute</a:Name>
<a:TemplateTargetItem.Value>exec</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o214">
<a:ObjectID>56972C17-AF12-4D42-8F09-DC7A1BCABB3F</a:ObjectID>
<a:Name>openParenthesis</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o215">
<a:ObjectID>C1009330-27B4-468F-957E-A59979246F2F</a:ObjectID>
<a:Name>statementTerminator</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o216">
<a:ObjectID>D1E35FE4-1DA5-4F11-A3A4-CE5AEB0C75F1</a:ObjectID>
<a:Name>inOut</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o217">
<a:ObjectID>D49C6B7A-B261-4F31-B076-E9753F2DA4DA</a:ObjectID>
<a:Name>then</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o218">
<a:ObjectID>721B6080-3DD9-4353-BC91-8503003A7B41</a:ObjectID>
<a:Name>endif</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o219">
<a:ObjectID>AB7D6B11-1B10-43EC-9D72-B90377733C6C</a:ObjectID>
<a:Name>begin</a:Name>
<a:TemplateTargetItem.Value>begin</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o220">
<a:ObjectID>2E8E45A3-4847-49AD-8489-AE979E5CF37F</a:ObjectID>
<a:Name>end</a:Name>
<a:TemplateTargetItem.Value>end</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o221">
<a:ObjectID>E2E75145-FEF0-440A-97AC-66B5E161ACDB</a:ObjectID>
<a:Name>elseif</a:Name>
<a:TemplateTargetItem.Value>else if</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o222">
<a:ObjectID>8414E3DC-A0C6-40FC-B34E-0D8F6563F8A3</a:ObjectID>
<a:Name>deleteError</a:Name>
<a:TemplateTargetItem.Value>if @@trancount = 0
begin
   raiserror 30000 &quot;%rsDeleteProcCode%: procedure must be called from within a transaction.&quot;
   return -1
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o223">
<a:ObjectID>4F06C3EE-2AF2-4173-A4C5-B49067686E1C</a:ObjectID>
<a:Name>updateError</a:Name>
<a:TemplateTargetItem.Value>if @@trancount = 0
begin
   raiserror 30000 &quot;%rsUpdateProcCode%: procedure must be called from within a transaction.&quot;
   return -1
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o224">
<a:ObjectID>BB460CA7-1181-4BF0-B571-C11B97B8B042</a:ObjectID>
<a:Name>insertError</a:Name>
<a:TemplateTargetItem.Value>if @@trancount = 0
begin
   raiserror 30000 &quot;%rsInsertProcCode%: procedure must be called from within a transaction.&quot;
   return -1
end
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:CriterionTargetItem>
<o:CriterionTargetItem Id="o225">
<a:ObjectID>B9B7FFB7-0A05-4B48-A6E9-3E11F07EE011</a:ObjectID>
<a:Name>isASA</a:Name>
<a:CriterionTargetItem.Value>%isASA%</a:CriterionTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o226">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>CD97DD9B-88CE-47C9-91BF-5601646D2FFB</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o227">
<a:ObjectID>1FE6ED2B-42CE-4D60-B4E8-E216FADB4D85</a:ObjectID>
<a:Name>as</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o228">
<a:ObjectID>53FCBB42-31A9-4249-8B32-491B83EA7905</a:ObjectID>
<a:Name>closeParenthesis</a:Name>
<a:TemplateTargetItem.Value>)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o229">
<a:ObjectID>1655EA92-4E6A-441B-99E6-BFB19B56C7A5</a:ObjectID>
<a:Name>execute</a:Name>
<a:TemplateTargetItem.Value>call</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o230">
<a:ObjectID>8CAD79A0-70DE-4CF3-8CC3-782F5FD318B6</a:ObjectID>
<a:Name>openParenthesis</a:Name>
<a:TemplateTargetItem.Value>(</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o231">
<a:ObjectID>9913C614-EDDE-4F63-B941-9FE1A3A2013A</a:ObjectID>
<a:Name>statementTerminator</a:Name>
<a:TemplateTargetItem.Value>;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o232">
<a:ObjectID>B159259D-14B5-45CB-8912-6E1B4A2FC1A1</a:ObjectID>
<a:Name>inOut</a:Name>
<a:TemplateTargetItem.Value>IN</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o233">
<a:ObjectID>D9C4259A-6879-484C-A3ED-AEDAE9CCDD40</a:ObjectID>
<a:Name>then</a:Name>
<a:TemplateTargetItem.Value>then</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o234">
<a:ObjectID>34B2AFAE-E3AC-49A8-9AE4-D263EFA58B9F</a:ObjectID>
<a:Name>endif</a:Name>
<a:TemplateTargetItem.Value>end if;</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o235">
<a:ObjectID>39EA2EF0-92FC-45BE-B718-00A90E507E7A</a:ObjectID>
<a:Name>begin</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o236">
<a:ObjectID>D267A589-18E4-40D7-97CF-CB38397D3182</a:ObjectID>
<a:Name>end</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o237">
<a:ObjectID>7350DF21-486B-478C-93BB-74F35558C419</a:ObjectID>
<a:Name>elseif</a:Name>
<a:TemplateTargetItem.Value>elseif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o238">
<a:ObjectID>D5AF8D22-0BEC-4F91-B5CA-32CDA6999F51</a:ObjectID>
<a:Name>deleteError</a:Name>
<a:TemplateTargetItem.Value>declare user_defined_exception exception for SQLSTATE &#39;30000&#39;;
if @@trancount = 0 then
   message &#39;%rsDeleteProcCode%: procedure must be called from within a transaction.&#39;;
   signal  user_defined_exception;
   return -1;  
end if;
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o239">
<a:ObjectID>2D96A673-A33E-40FB-8496-FA5161772A35</a:ObjectID>
<a:Name>updateError</a:Name>
<a:TemplateTargetItem.Value>declare user_defined_exception exception for SQLSTATE &#39;30000&#39;;
if @@trancount = 0 then
   message &#39;%rsUpdateProcCode%: procedure must be called from within a transaction.&#39;;
   signal  user_defined_exception;
   return -1;
end if;
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o240">
<a:ObjectID>64C529E9-7243-4740-A7D3-45592287F1E1</a:ObjectID>
<a:Name>insertError</a:Name>
<a:TemplateTargetItem.Value>declare user_defined_exception exception for SQLSTATE &#39;30000&#39;;
if @@trancount = 0 then
   message &#39;%rsInsertProcCode%: procedure must be called from within a transaction.&#39;;
   signal  user_defined_exception;
   return -1;
end if;
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:CriterionTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
<o:MetaClassTargetItem Id="o241">
<a:ObjectID>57530479-11E6-4D5E-A76F-0B28A32FBD23</a:ObjectID>
<a:Name>ArticleColumn</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TypedCategoryTargetItem Id="o242">
<a:TypePublicName>TemplateTargetItem</a:TypePublicName>
<a:ObjectID>FE0AC0C0-9BDD-44CE-9D6B-48C6723C692D</a:ObjectID>
<a:Name>Templates</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o243">
<a:ObjectID>BD30B0A2-B932-414A-BCF7-2B04BC5AA1F8</a:ObjectID>
<a:Name>columnNameNoQuote</a:Name>
<a:TemplateTargetItem.Value>.if (%SourceColumn%)
%SourceColumn.Code%
.else
%Code%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o244">
<a:ObjectID>D14E75AB-CD88-404B-8472-703E52943ABC</a:ObjectID>
<a:Name>isPrimary</a:Name>
<a:TemplateTargetItem.Value>.set_value(_primary, false, new)
.if (%SourceColumn%)
   .if (%SourceColumn.ObjectType% == &quot;Column&quot;)
      .set_value(_primary, %SourceColumn.Primary%)
   .endif
.endif
%_primary%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o245">
<a:ObjectID>576EF606-69D3-416E-BFB4-26942B175E09</a:ObjectID>
<a:Name>remoteColumnNameNoQuote</a:Name>
<a:TemplateTargetItem.Value>.if (%RemoteColumn%)
%RemoteColumn%
.else
%Code%
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o246">
<a:ObjectID>8CEFD9B0-ECB7-40AE-9D06-4FFFA4D41739</a:ObjectID>
<a:Name>dataType</a:Name>
<a:TemplateTargetItem.Value>.if (%DataType%)
%DataType%
.else
char(10)
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o247">
<a:ObjectID>36517188-8171-4A91-8001-17A799153BEC</a:ObjectID>
<a:Name>columnDataType</a:Name>
<a:TemplateTargetItem.Value>.set_value(_dataType, &quot;&quot;, new)
.set_value(_length, &quot;&quot;, new)
.set_value(_precision, &quot;&quot;, new)
.if (%SourceColumn%)
   .set_value(_dataType , %SourceColumn.DataType%)
   .set_value(_length   , %SourceColumn.Length%)
   .set_value(_precision, %SourceColumn.Precision%)
.else
   .set_value(_dataType , %dataType%)
   .set_value(_length   , %Length%)
   .set_value(_precision, %Precision%)
.endif
.if (%Parent.isASA% == true)
   .// change data type for ASA
   .if (%.6U:_dataType% == &quot;NUMBER&quot;)
      .set_value(_dataType, &quot;NUMERIC[(%_length%[,%_precision%])]&quot;)
   .elsif (%.3U:_dataType% == &quot;DEC&quot;)
      .set_value(_dataType, &quot;DECIMAL[(%_length%[,%_precision%])]&quot;)
   .elsif (%.U:_dataType% == &quot;INT&quot;)
         .set_value(_dataType, &quot;INTEGER&quot;)
   .elsif (%.U:_dataType% == &quot;BINARY_FLOAT&quot;)
         .set_value(_dataType, &quot;FLOAT&quot;)
   .elsif (%.U:_dataType% == &quot;BINARY_DOUBLE&quot;)
         .set_value(_dataType, &quot;DOUBLE&quot;)
   .elsif (%.8U:_dataType% == &quot;VARCHAR2&quot;)
      .set_value(_dataType, &quot;VARCHAR[(%_length%)]&quot;)
   .elsif (%.9U:_dataType% == &quot;NVARCHAR2&quot;)
      .set_value(_dataType, &quot;NVARCHAR[(%_length%)]&quot;)
   .elsif (%.13U:_dataType% == &quot;NCHAR VARYING&quot;) or (%.21U:_dataType% == &quot;NATIONAL CHAR VARYING&quot;) or (%.26U:_dataType% == &quot;NATIONAL CHARACTER VARYING&quot;)
      .set_value(_dataType, &quot;NCHAR[(%_length%)]&quot;)
   .elsif (%.U:_dataType% == &quot;LONG&quot;) or (%.U:_dataType% == &quot;LONG RAW&quot;) or (%.U:_dataType% == &quot;BLOB&quot;) or (%.U:_dataType% == &quot;BFILE&quot;)
         .set_value(_dataType, &quot;LONG BINARY&quot;)
   .elsif (%.3U:_dataType% == &quot;RAW&quot;)
      .set_value(_dataType, &quot;BINARY[(%_length%)]&quot;)
   .elsif (%.U:_dataType% == &quot;CLOB&quot;)
         .set_value(_dataType, &quot;LONG VARCHAR&quot;)
   .elsif (%.U:_dataType% == &quot;NCLOB&quot;)
         .set_value(_dataType, &quot;LONG NVARCHAR&quot;)
   .elsif (%.9U:_dataType% == &quot;TIMESTAMP&quot;)
         .set_value(_dataType, &quot;TIMESTAMP&quot;)
   .endif
.elsif (%Parent.isASE% == true)
   .// change data type for ASE
   .if (%Article.isOracleSource%)
      .if (%.U:_dataType% == &quot;NUMERIC&quot;) or (%.U:_dataType% == &quot;NUMBER&quot;)
         .// Use default Oracle scale to avoid losing precision
         .set_value(_dataType, NUMERIC(38))
      .endif
   .endif
   .if (%.U:_dataType% == &quot;BINARY_FLOAT&quot;)
         .set_value(_dataType, &quot;FLOAT&quot;)
   .elsif (%.6U:_dataType% == &quot;DOUBLE&quot;) or (%.U:_dataType% == &quot;BINARY_DOUBLE&quot;)
         .set_value(_dataType, &quot;DOUBLE PRECISION&quot;)
   .elsif (%.8U:_dataType% == &quot;VARCHAR2&quot;)
      .set_value(_dataType, &quot;VARCHAR[(%_length%)]&quot;)
   .elsif (%.9U:_dataType% == &quot;NVARCHAR2&quot;)
      .set_value(_dataType, &quot;NVARCHAR[(%_length%)]&quot;)
   .elsif (%.6U:_dataType% == &quot;NUMBER&quot;)
      .set_value(_dataType, &quot;NUMERIC[(%_length%[,%_precision%])]&quot;)
   .elsif (%.U:_dataType% == &quot;LONG&quot;) or (%.U:_dataType% == &quot;LONG RAW&quot;) or (%.U:_dataType% == &quot;BLOB&quot;) or (%.U:_dataType% == &quot;BFILE&quot;)
         .set_value(_dataType, &quot;LONG BINARY&quot;)
   .elsif (%.3U:_dataType% == &quot;RAW&quot;)
      .set_value(_dataType, &quot;BINARY[(%_length%)]&quot;)
   .elsif (%.U:_dataType% == &quot;CLOB&quot;)
         .set_value(_dataType, &quot;LONG VARCHAR&quot;)
   .elsif (%.U:_dataType% == &quot;NCLOB&quot;)
         .set_value(_dataType, &quot;LONG NVARCHAR&quot;)
   .elsif (%.9U:_dataType% == &quot;TIMESTAMP&quot;)
         .set_value(_dataType, &quot;TIMESTAMP&quot;)
   .endif
.endif
%_dataType%

</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o248">
<a:ObjectID>B228186C-2FD7-4FD3-87AC-85B855FAE9F5</a:ObjectID>
<a:Name>newParameterName</a:Name>
<a:TemplateTargetItem.Value>@%.25L:columnNameNoQuote%_new</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o249">
<a:ObjectID>BC498685-2B61-45DB-BF7A-5C1DC8824E07</a:ObjectID>
<a:Name>oldParameterName</a:Name>
<a:TemplateTargetItem.Value>@%.25L:columnNameNoQuote%_old</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o250">
<a:ObjectID>12E2DA51-27A9-4ABA-BAE9-1DB130A665FC</a:ObjectID>
<a:Name>isTextImage</a:Name>
<a:TemplateTargetItem.Value>.if (%.L:DataType% == text) or (%.L:DataType% == unitext) or (%.L:DataType% == image) or (%.L:DataType% == rawobject)
true
.else
false
.endif</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o251">
<a:ObjectID>10736F16-EFF4-4912-A9A7-F9E2A1B38BB3</a:ObjectID>
<a:Name>isValidNonPKColumn</a:Name>
<a:TemplateTargetItem.Value>.bool ((%isPrimary% == false) and (%isValidColumn%))</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o252">
<a:ObjectID>9B0B3BAA-F8D7-452A-8601-3113EB463683</a:ObjectID>
<a:Name>isValidColumn</a:Name>
<a:TemplateTargetItem.Value>.// It is a valid column for ASE stored procedure
.bool (%isTextImage% == false) and (%isReplicable%)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TypedCategoryTargetItem Id="o253">
<a:ObjectID>16E48EFA-8265-46D0-95B3-50D549A5156F</a:ObjectID>
<a:Name>FunctionString</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:Categories>
<o:TemplateTargetItem Id="o254">
<a:ObjectID>E3A3637C-655A-42EF-849B-2004CCB8039C</a:ObjectID>
<a:Name>textImageFunctionStrings</a:Name>
<a:TemplateTargetItem.Value>.if (%isTextImage%) and (%isReplicable%)
/* Function String: &quot;rs_get_textptr&quot; for text/image column &quot;%remoteColumnNameNoQuote%.%remoteColumnNameNoQuote%&quot; */ 
alter function string %.Q:Parent.replicationDefinitionName%.&quot;rs_get_textptr&quot;;%.Q:remoteColumnNameNoQuote%
    for %Parent.defaultFunctionStringClass%
    output language 
    &#39;select %remoteColumnNameNoQuote% 
      from  %Parent.stgInsertTableCodeTrans%
     where  %Parent.wherePkColumnsNew%&#39; 
go

/* Function String: &quot;rs_writetext&quot; for text/image column &quot;%remoteColumnNameNoQuote%.%remoteColumnNameNoQuote%&quot; */ 
alter function string %.Q:Parent.replicationDefinitionName%.&quot;rs_writetext&quot;;%.Q:remoteColumnNameNoQuote%
    for %Parent.defaultFunctionStringClass%
    output writetext 
    use primary log 
go

/* Function String: &quot;rs_textptr_init&quot; for text/image column &quot;%remoteColumnNameNoQuote%.%remoteColumnNameNoQuote%&quot; */ 
alter function string %.Q:Parent.replicationDefinitionName%.&quot;rs_textptr_init&quot;;%.Q:remoteColumnNameNoQuote%
    for %Parent.defaultFunctionStringClass% 
    output language
    &#39;update %Parent.stgInsertTableCodeTrans%
      set   %remoteColumnNameNoQuote% = NULL 
     where  %Parent.wherePkColumnsNew%&#39; 
go
.endif
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Function strings for text/image column</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
<o:TemplateTargetItem Id="o255">
<a:ObjectID>D8070AF1-AF6E-4FCF-9621-1B4CABE3048C</a:ObjectID>
<a:Name>isReplicable</a:Name>
<a:TemplateTargetItem.Value>.vbscript()
On Error Resume Next
Dim sReplicate
sReplicate = ActiveSelection.Item(0).GetExtendedAttribute(&quot;ColumnReplication&quot;)
If  sReplicate = &quot;do_not_replicate&quot; Then
   ScriptResult = &quot;false&quot;
Else
   ScriptResult = &quot;true&quot;
End If
.endvbscript
</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o256">
<a:ObjectID>D9554138-0C28-48AB-8CD6-34BA3FEE25AE</a:ObjectID>
<a:Name>isReplicableTextImage</a:Name>
<a:TemplateTargetItem.Value>.bool ((%isReplicable%) and (%isTextImage%))</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o257">
<a:ObjectID>D9AED31B-D27E-43D7-B8F2-7795B6FFC31D</a:ObjectID>
<a:Name>isMandatory</a:Name>
<a:TemplateTargetItem.Value>.set_value(_mandatory, false, new)
.if (%SourceColumn%)
   .if (%SourceColumn.ObjectType% == &quot;Column&quot;)
      .set_value(_mandatory, %SourceColumn.Mandatory%)
   .endif
.endif
%_mandatory%</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o258">
<a:ObjectID>6361D1BC-4A5C-403E-988B-D03A577126FE</a:ObjectID>
<a:Name>isInsertColumn</a:Name>
<a:TemplateTargetItem.Value>.// It is not a NULL text or image column
.bool ((%isTextImage% == false) or %isMandatory%) and (%isReplicable%)</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
<o:TemplateTargetItem Id="o259">
<a:ObjectID>5B6A6ACF-ED49-4EFF-9502-31BA92B33453</a:ObjectID>
<a:Name>isUpdateColumn</a:Name>
<a:TemplateTargetItem.Value>.bool ((%isPrimary% == false) and (%isInsertColumn%))</a:TemplateTargetItem.Value>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
</o:TemplateTargetItem>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:MetaClassTargetItem>
</c:Categories>
</o:ProfileTargetItem>
<o:TargetCategory Id="o260">
<a:ObjectID>CFCC542B-7679-4BC9-9DE4-5B25A8131956</a:ObjectID>
<a:Name>Settings</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<c:Categories>
<o:TargetCategory Id="o261">
<a:ObjectID>4E224E03-9DCB-4337-8A6C-B5BC18E1E832</a:ObjectID>
<a:Name>ReplicationProcess</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Settings for a replication process</a:Comment>
<c:Categories>
<o:ListTargetItem Id="o262">
<a:ObjectID>40C23113-3B7A-46DE-A22E-EB26C735540C</a:ObjectID>
<a:Name>TypeList</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>List of available types</a:Comment>
</o:ListTargetItem>
<o:TargetCategory Id="o263">
<a:ObjectID>2CE8FD38-E3F3-4468-9BB5-4804C1339EE9</a:ObjectID>
<a:Name>Publication</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<c:Categories>
<o:ListTargetItem Id="o264">
<a:ObjectID>F0168501-15E6-4AA0-9757-24889FE85CFE</a:ObjectID>
<a:Name>TypeList</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>List of available types</a:Comment>
</o:ListTargetItem>
<o:TargetCategory Id="o265">
<a:ObjectID>294A093A-BDC2-4215-9A5A-50283351B7CC</a:ObjectID>
<a:Name>Article</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<c:Categories>
<o:BooleanTargetItem Id="o266">
<a:ObjectID>F58B8EB4-6CD7-4B15-A284-041D5C80A6B8</a:ObjectID>
<a:Name>WhereClauseExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
</o:BooleanTargetItem>
<o:BooleanTargetItem Id="o267">
<a:ObjectID>833400E9-43A7-4A93-A5CC-BFE1A4BA763D</a:ObjectID>
<a:Name>ColumnsExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude columns</a:Comment>
</o:BooleanTargetItem>
<o:BooleanTargetItem Id="o268">
<a:ObjectID>4BEB89ED-145F-43D1-8BB0-955A68CAF234</a:ObjectID>
<a:Name>ProceduresExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude procedures</a:Comment>
</o:BooleanTargetItem>
<o:BooleanTargetItem Id="o269">
<a:ObjectID>F9760E82-F733-446D-89CD-860B41DDB7A1</a:ObjectID>
<a:Name>EventScriptsExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude event handlers</a:Comment>
</o:BooleanTargetItem>
</c:Categories>
</o:TargetCategory>
<o:TargetCategory Id="o270">
<a:ObjectID>97699087-4A73-40AE-9B87-C29A6D1B18CB</a:ObjectID>
<a:Name>Procedure</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
</o:TargetCategory>
<o:BooleanTargetItem Id="o271">
<a:ObjectID>F75C115E-F775-42B2-903D-B302133CEDFE</a:ObjectID>
<a:Name>ArticlesExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude articles</a:Comment>
</o:BooleanTargetItem>
<o:BooleanTargetItem Id="o272">
<a:ObjectID>970EBC9E-AE19-42D9-BBBA-4F0BAFAE6860</a:ObjectID>
<a:Name>ProceduresExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude procedures</a:Comment>
</o:BooleanTargetItem>
<o:BooleanTargetItem Id="o273">
<a:ObjectID>68621899-CE10-4C55-80C5-65DC6EB52A90</a:ObjectID>
<a:Name>TypeExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude type</a:Comment>
</o:BooleanTargetItem>
</c:Categories>
</o:TargetCategory>
<o:TargetCategory Id="o274">
<a:ObjectID>BF754F63-A264-4FE2-B0A7-BE51FF5DD0C9</a:ObjectID>
<a:Name>EventScript</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<c:Categories>
<o:ListTargetItem Id="o275">
<a:ObjectID>239D60FA-5581-43A3-B82F-C2152B6E19E7</a:ObjectID>
<a:Name>EventList</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>List of available events</a:Comment>
</o:ListTargetItem>
<o:TextTargetItem Id="o276">
<a:ObjectID>77826BD9-82E5-42A0-804C-97EA8323B3F7</a:ObjectID>
<a:Name>ScriptDefaultValue</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Default value for the script attribute</a:Comment>
</o:TextTargetItem>
</c:Categories>
</o:TargetCategory>
<o:TargetCategory Id="o277">
<a:ObjectID>E1E67405-45C7-491C-846B-695B59108426</a:ObjectID>
<a:Name>EventScript (event)</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Settings for an event handler of a given even.</a:Comment>
</o:TargetCategory>
<o:TargetCategory Id="o278">
<a:ObjectID>53D7C945-CFA9-4471-87FB-776D7929D6E9</a:ObjectID>
<a:Name>Publication (Type)</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Settings for a publication of given type</a:Comment>
</o:TargetCategory>
<o:BooleanTargetItem Id="o279">
<a:ObjectID>E91E3672-8111-454D-9865-D42F11BB0C66</a:ObjectID>
<a:Name>PublicationsExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude publications</a:Comment>
</o:BooleanTargetItem>
<o:BooleanTargetItem Id="o280">
<a:ObjectID>860134F5-E8E5-4742-8AD6-6CCB508530B6</a:ObjectID>
<a:Name>SubscriptionsExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude subscriptions</a:Comment>
</o:BooleanTargetItem>
<o:BooleanTargetItem Id="o281">
<a:ObjectID>591D1416-C9BE-47E3-9DB2-6B723FE61210</a:ObjectID>
<a:Name>DataConnectionGroupsExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude data connection groups</a:Comment>
</o:BooleanTargetItem>
<o:BooleanTargetItem Id="o282">
<a:ObjectID>70EB320D-3704-4E6E-8207-EB64C443A908</a:ObjectID>
<a:Name>UsersExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude Users</a:Comment>
</o:BooleanTargetItem>
<o:MapTargetItem Id="o283">
<a:ObjectID>11820D45-A4FB-46BA-A6AE-7303AA656D7B</a:ObjectID>
<a:Name>PhysDataType</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Data types translation table from target database data types to internal data types.</a:Comment>
<a:MapTargetItem.Layout>Physical Model
Internal</a:MapTargetItem.Layout>
</o:MapTargetItem>
<o:MapTargetItem Id="o284">
<a:ObjectID>9A90994F-7F15-4529-831C-65EDEB2DFA05</a:ObjectID>
<a:Name>AmcdDataType</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Data types translation table from internal data types to target database data types.
        %n is the length of the data type
        %s is the size of the data type
        %p is the precision of the data type</a:Comment>
<a:MapTargetItem.Layout>Internal
Physical Model</a:MapTargetItem.Layout>
</o:MapTargetItem>
</c:Categories>
</o:TargetCategory>
<o:TargetCategory Id="o285">
<a:ObjectID>2358912B-7C60-4D9F-850A-3322F1AA5754</a:ObjectID>
<a:Name>TransformationProcess</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Settings for a transformation process</a:Comment>
<c:Categories>
<o:ListTargetItem Id="o286">
<a:ObjectID>9EFE37A3-EC48-49FB-BB16-D5A4334D529F</a:ObjectID>
<a:Name>TypeList</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>List of available types</a:Comment>
<a:ListTargetItem.ListOfValues>IQStaging</a:ListTargetItem.ListOfValues>
</o:ListTargetItem>
</c:Categories>
</o:TargetCategory>
<o:TargetCategory Id="o287">
<a:ObjectID>368BC13C-570B-4089-B91F-5E35B87BDEAC</a:ObjectID>
<a:Name>Database</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Settings for a database</a:Comment>
<c:Categories>
<o:ListTargetItem Id="o288">
<a:ObjectID>E173BF36-A43E-459A-9834-C9DC590991CF</a:ObjectID>
<a:Name>TypeList</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>List of available types</a:Comment>
<a:ListTargetItem.ListOfValues>IQStaging</a:ListTargetItem.ListOfValues>
</o:ListTargetItem>
<o:BooleanTargetItem Id="o289">
<a:ObjectID>9AD53227-D673-4104-85C5-384E8CFA58C8</a:ObjectID>
<a:Name>ServerExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude the server attribute</a:Comment>
</o:BooleanTargetItem>
<o:BooleanTargetItem Id="o290">
<a:ObjectID>2C7D01D8-8055-4E77-AEB8-DD9EE13778CB</a:ObjectID>
<a:Name>DataSourceNameExcluded</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Exclude the ODBC data source name</a:Comment>
</o:BooleanTargetItem>
</c:Categories>
</o:TargetCategory>
<o:TargetCategory Id="o291">
<a:ObjectID>5B06D272-0000-4B1D-B9DD-B0CFEB9B3BFC</a:ObjectID>
<a:Name>XMLDocument</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<c:Categories>
<o:ListTargetItem Id="o292">
<a:ObjectID>BF4640D3-6FA5-48A7-841D-0EECDEF37094</a:ObjectID>
<a:Name>TypeList</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>List of available types</a:Comment>
</o:ListTargetItem>
</c:Categories>
</o:TargetCategory>
<o:TargetCategory Id="o293">
<a:ObjectID>948B4704-95EE-4496-BE88-A1FF0AA16A0B</a:ObjectID>
<a:Name>Database (Type)</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Settings for a database of a given type</a:Comment>
</o:TargetCategory>
<o:TargetCategory Id="o294">
<a:ObjectID>E271FFE1-7250-47F8-9C91-2829FEB2FA57</a:ObjectID>
<a:Name>ReplicationProcess (Type)</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Settings for a replication process of a given type</a:Comment>
</o:TargetCategory>
<o:TargetCategory Id="o295">
<a:ObjectID>CF4F494E-C26B-48B1-8A64-9833F9697BF8</a:ObjectID>
<a:Name>TransformationProcess (Type)</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Settings for a transformation process of a give type</a:Comment>
</o:TargetCategory>
<o:TargetCategory Id="o296">
<a:ObjectID>E22C4E7E-12FF-45E8-8167-5AE4B082DCD3</a:ObjectID>
<a:Name>XMLDocument (Type)</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Settings for an XML document of given type</a:Comment>
</o:TargetCategory>
</c:Categories>
</o:TargetCategory>
<o:TypedCategoryTargetItem Id="o297">
<a:TypePublicName>TransformationTargetItemProfile</a:TypePublicName>
<a:ObjectID>D8A695D5-62B9-477F-BDEA-418949288D01</a:ObjectID>
<a:Name>Transformation Profiles</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<c:Categories>
<o:TransformationTargetItemProfile Id="o298">
<a:ObjectID>DD388AA5-7F6C-4390-B4D3-D121A8153F61</a:ObjectID>
<a:Name>IQ Staging Database</a:Name>
<a:CreationDate>0</a:CreationDate>
<a:Creator/>
<a:ModificationDate>0</a:ModificationDate>
<a:Modifier/>
<a:Comment>Create a staging database for IQ</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<c:TransformationListToModel>
<o:TransformationTargetItem Ref="o61"/>
<o:TransformationTargetItem Ref="o62"/>
</c:TransformationListToModel>
</o:TransformationTargetItemProfile>
</c:Categories>
</o:TypedCategoryTargetItem>
</c:Categories>
</o:ExtendedModelDefinition>

</EXASET>